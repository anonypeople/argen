<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.sdml.info/srcML/src" language="Java"
      filename="C:\Users\dnader\git\biorimp\BIO-RIMP\test_data\code\xerces\src\org\apache\xml\serialize\DOMSerializerImpl.java">
    <comment type="block">/*
        * Copyright 1999-2005 The Apache Software Foundation.
        *
        * Licensed under the Apache License, Version 2.0 (the "License");
        * you may not use this file except in compliance with the License.
        * You may obtain a copy of the License at
        *
        * http://www.apache.org/licenses/LICENSE-2.0
        *
        * Unless required by applicable law or agreed to in writing, software
        * distributed under the License is distributed on an "AS IS" BASIS,
        * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
        * See the License for the specific language governing permissions and
        * limitations under the License.
        */
    </comment>

    <package>package
        <name><name>org</name>.<name>apache</name>.<name>xml</name>.
            <name>serialize</name>
        </name>
        ;
    </package>

    <import>import
        <name><name>java</name>.<name>io</name>.
            <name>FileOutputStream</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>java</name>.<name>io</name>.
            <name>IOException</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>java</name>.<name>io</name>.
            <name>OutputStream</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>java</name>.<name>io</name>.
            <name>StringWriter</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>java</name>.<name>io</name>.
            <name>UnsupportedEncodingException</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>java</name>.<name>io</name>.
            <name>Writer</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>java</name>.<name>lang</name>.<name>reflect</name>.
            <name>Method</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>java</name>.<name>net</name>.
            <name>HttpURLConnection</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>java</name>.<name>net</name>.
            <name>URL</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>java</name>.<name>net</name>.
            <name>URLConnection</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>java</name>.<name>util</name>.
            <name>StringTokenizer</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>java</name>.<name>util</name>.
            <name>Vector</name>
        </name>
        ;
    </import>

    <import>import
        <name><name>org</name>.<name>apache</name>.<name>xerces</name>.<name>dom</name>.
            <name>CoreDocumentImpl</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>org</name>.<name>apache</name>.<name>xerces</name>.<name>dom</name>.
            <name>DOMErrorImpl</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>org</name>.<name>apache</name>.<name>xerces</name>.<name>dom</name>.
            <name>DOMLocatorImpl</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>org</name>.<name>apache</name>.<name>xerces</name>.<name>dom</name>.
            <name>DOMMessageFormatter</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>org</name>.<name>apache</name>.<name>xerces</name>.<name>dom</name>.
            <name>DOMNormalizer</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>org</name>.<name>apache</name>.<name>xerces</name>.<name>dom</name>.
            <name>DOMStringListImpl</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>org</name>.<name>w3c</name>.<name>dom</name>.
            <name>DOMConfiguration</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>org</name>.<name>w3c</name>.<name>dom</name>.
            <name>DOMError</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>org</name>.<name>w3c</name>.<name>dom</name>.
            <name>DOMErrorHandler</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>org</name>.<name>w3c</name>.<name>dom</name>.
            <name>DOMStringList</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>org</name>.<name>apache</name>.<name>xerces</name>.<name>impl</name>.
            <name>Constants</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>org</name>.<name>apache</name>.<name>xerces</name>.<name>impl</name>.
            <name>XMLEntityManager</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>org</name>.<name>apache</name>.<name>xerces</name>.<name>util</name>.
            <name>NamespaceSupport</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>org</name>.<name>apache</name>.<name>xerces</name>.<name>util</name>.
            <name>SymbolTable</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>org</name>.<name>apache</name>.<name>xerces</name>.<name>util</name>.
            <name>XML11Char</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>org</name>.<name>apache</name>.<name>xerces</name>.<name>util</name>.
            <name>XMLChar</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>org</name>.<name>w3c</name>.<name>dom</name>.
            <name>Attr</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>org</name>.<name>w3c</name>.<name>dom</name>.
            <name>Comment</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>org</name>.<name>w3c</name>.<name>dom</name>.
            <name>DOMException</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>org</name>.<name>w3c</name>.<name>dom</name>.
            <name>Document</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>org</name>.<name>w3c</name>.<name>dom</name>.
            <name>DocumentFragment</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>org</name>.<name>w3c</name>.<name>dom</name>.
            <name>Element</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>org</name>.<name>w3c</name>.<name>dom</name>.
            <name>NamedNodeMap</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>org</name>.<name>w3c</name>.<name>dom</name>.
            <name>Node</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>org</name>.<name>w3c</name>.<name>dom</name>.
            <name>ProcessingInstruction</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>org</name>.<name>w3c</name>.<name>dom</name>.<name>ls</name>.
            <name>LSException</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>org</name>.<name>w3c</name>.<name>dom</name>.<name>ls</name>.
            <name>LSOutput</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>org</name>.<name>w3c</name>.<name>dom</name>.<name>ls</name>.
            <name>LSSerializer</name>
        </name>
        ;
    </import>
    <import>import
        <name><name>org</name>.<name>w3c</name>.<name>dom</name>.<name>ls</name>.
            <name>LSSerializerFilter</name>
        </name>
        ;
    </import>


    <comment type="javadoc">/**
        * EXPERIMENTAL: Implemenatation of DOM Level 3 org.w3c.ls.LSSerializer by delegating serialization
        * calls to &lt;CODE&gt;XMLSerializer&lt;/CODE&gt;.
        * LSSerializer provides an API for serializing (writing) a DOM document out in an
        * XML document. The XML data is written to an output stream.
        * During serialization of XML data, namespace fixup is done when possible as
        * defined in DOM Level 3 Core, Appendix B.
        *
        * @author Elena Litani, IBM
        * @author Gopal Sharma, Sun Microsystems
        * @author Arun Yadav, Sun Microsystems
        * @version $Id: DOMSerializerImpl.java,v 1.36 2005/06/13 22:26:42 nddelima Exp $
        */
    </comment>
    <class>
        <specifier>public</specifier>
        class <name>DOMSerializerImpl</name>
        <super>
            <implements>implements <name>LSSerializer</name>,
                <name>DOMConfiguration</name>
            </implements>
        </super>
        <block>{

            <comment type="line">// TODO: When DOM Level 3 goes to REC replace method calls using</comment>
            <comment type="line">// reflection for: getXmlEncoding, getInputEncoding and getXmlEncoding</comment>
            <comment type="line">// with regular static calls on the Document object.</comment>

            <comment type="line">// data</comment>
            <comment type="line">// serializer</comment>
            <decl_stmt>
                <decl>
                    <type>
                        <specifier>private</specifier>
                        <name>XMLSerializer</name>
                    </type>
                    <name>serializer</name>
                </decl>
                ;
            </decl_stmt>

            <comment type="line">// XML 1.1 serializer</comment>
            <decl_stmt>
                <decl>
                    <type>
                        <specifier>private</specifier>
                        <name>XML11Serializer</name>
                    </type>
                    <name>xml11Serializer</name>
                </decl>
                ;
            </decl_stmt>

            <comment type="line">//Recognized parameters</comment>
            <decl_stmt>
                <decl>
                    <type>
                        <specifier>private</specifier>
                        <name>DOMStringList</name>
                    </type>
                    <name>fRecognizedParameters</name>
                </decl>
                ;
            </decl_stmt>

            <comment type="javadoc">/** REVISIT: Currently we handle 3 different configurations, would be nice just have
                one configuration
                * that has different recognized parameters depending if it is used in Core/LS.
                */
            </comment>
            <decl_stmt>
                <decl>
                    <type>
                        <specifier>protected</specifier>
                        <name>short</name>
                    </type>
                    <name>features</name> =
                    <init>
                        <expr>0</expr>
                    </init>
                </decl>
                ;
            </decl_stmt>

            <decl_stmt>
                <decl>
                    <type>
                        <specifier>protected</specifier>
                        <specifier>final</specifier>
                        <specifier>static</specifier>
                        <name>short</name>
                    </type>
                    <name>NAMESPACES</name>          =
                    <init>
                        <expr>0x1&lt;&lt;0</expr>
                    </init>
                </decl>
                ;
            </decl_stmt>
            <decl_stmt>
                <decl>
                    <type>
                        <specifier>protected</specifier>
                        <specifier>final</specifier>
                        <specifier>static</specifier>
                        <name>short</name>
                    </type>
                    <name>WELLFORMED</name>          =
                    <init>
                        <expr>0x1&lt;&lt;1</expr>
                    </init>
                </decl>
                ;
            </decl_stmt>
            <decl_stmt>
                <decl>
                    <type>
                        <specifier>protected</specifier>
                        <specifier>final</specifier>
                        <specifier>static</specifier>
                        <name>short</name>
                    </type>
                    <name>ENTITIES</name>            =
                    <init>
                        <expr>0x1&lt;&lt;2</expr>
                    </init>
                </decl>
                ;
            </decl_stmt>
            <decl_stmt>
                <decl>
                    <type>
                        <specifier>protected</specifier>
                        <specifier>final</specifier>
                        <specifier>static</specifier>
                        <name>short</name>
                    </type>
                    <name>CDATA</name>               =
                    <init>
                        <expr>0x1&lt;&lt;3</expr>
                    </init>
                </decl>
                ;
            </decl_stmt>
            <decl_stmt>
                <decl>
                    <type>
                        <specifier>protected</specifier>
                        <specifier>final</specifier>
                        <specifier>static</specifier>
                        <name>short</name>
                    </type>
                    <name>SPLITCDATA</name>          =
                    <init>
                        <expr>0x1&lt;&lt;4</expr>
                    </init>
                </decl>
                ;
            </decl_stmt>
            <decl_stmt>
                <decl>
                    <type>
                        <specifier>protected</specifier>
                        <specifier>final</specifier>
                        <specifier>static</specifier>
                        <name>short</name>
                    </type>
                    <name>COMMENTS</name>            =
                    <init>
                        <expr>0x1&lt;&lt;5</expr>
                    </init>
                </decl>
                ;
            </decl_stmt>
            <decl_stmt>
                <decl>
                    <type>
                        <specifier>protected</specifier>
                        <specifier>final</specifier>
                        <specifier>static</specifier>
                        <name>short</name>
                    </type>
                    <name>DISCARDDEFAULT</name>      =
                    <init>
                        <expr>0x1&lt;&lt;6</expr>
                    </init>
                </decl>
                ;
            </decl_stmt>
            <decl_stmt>
                <decl>
                    <type>
                        <specifier>protected</specifier>
                        <specifier>final</specifier>
                        <specifier>static</specifier>
                        <name>short</name>
                    </type>
                    <name>INFOSET</name>             =
                    <init>
                        <expr>0x1&lt;&lt;7</expr>
                    </init>
                </decl>
                ;
            </decl_stmt>
            <decl_stmt>
                <decl>
                    <type>
                        <specifier>protected</specifier>
                        <specifier>final</specifier>
                        <specifier>static</specifier>
                        <name>short</name>
                    </type>
                    <name>XMLDECL</name>             =
                    <init>
                        <expr>0x1&lt;&lt;8</expr>
                    </init>
                </decl>
                ;
            </decl_stmt>
            <decl_stmt>
                <decl>
                    <type>
                        <specifier>protected</specifier>
                        <specifier>final</specifier>
                        <specifier>static</specifier>
                        <name>short</name>
                    </type>
                    <name>NSDECL</name>              =
                    <init>
                        <expr>0x1&lt;&lt;9</expr>
                    </init>
                </decl>
                ;
            </decl_stmt>
            <decl_stmt>
                <decl>
                    <type>
                        <specifier>protected</specifier>
                        <specifier>final</specifier>
                        <specifier>static</specifier>
                        <name>short</name>
                    </type>
                    <name>DOM_ELEMENT_CONTENT_WHITESPACE</name> =
                    <init>
                        <expr>0x1&lt;&lt;10</expr>
                    </init>
                </decl>
                ;
            </decl_stmt>

            <comment type="line">// well-formness checking</comment>
            <decl_stmt>
                <decl>
                    <type>
                        <specifier>private</specifier>
                        <name>DOMErrorHandler</name>
                    </type>
                    <name>fErrorHandler</name> =
                    <init>
                        <expr>
                            <name>null</name>
                        </expr>
                    </init>
                </decl>
                ;
            </decl_stmt>
            <decl_stmt>
                <decl>
                    <type>
                        <specifier>private</specifier>
                        <specifier>final</specifier>
                        <name>DOMErrorImpl</name>
                    </type>
                    <name>fError</name> =
                    <init>
                        <expr>new
                            <call>
                                <name>DOMErrorImpl</name>
                                <argument_list>()</argument_list>
                            </call>
                        </expr>
                    </init>
                </decl>
                ;
            </decl_stmt>
            <decl_stmt>
                <decl>
                    <type>
                        <specifier>private</specifier>
                        <specifier>final</specifier>
                        <name>DOMLocatorImpl</name>
                    </type>
                    <name>fLocator</name> =
                    <init>
                        <expr>new
                            <call>
                                <name>DOMLocatorImpl</name>
                                <argument_list>()</argument_list>
                            </call>
                        </expr>
                    </init>
                </decl>
                ;
            </decl_stmt>
            <decl_stmt>
                <decl>
                    <type>
                        <specifier>private</specifier>
                        <specifier>static</specifier>
                        <specifier>final</specifier>
                        <name>RuntimeException</name>
                    </type>
                    <name>abort</name> =
                    <init>
                        <expr>new
                            <call>
                                <name>RuntimeException</name>
                                <argument_list>()</argument_list>
                            </call>
                        </expr>
                    </init>
                </decl>
                ;
            </decl_stmt>

            <comment type="javadoc">/**
                * Constructs a new LSSerializer.
                * The constructor turns on the namespace support in &lt;code&gt;XMLSerializer&lt;/code&gt; and
                * initializes the following fields: fNSBinder, fLocalNSBinder, fSymbolTable,
                * fEmptySymbol, fXmlSymbol, fXmlnsSymbol, fNamespaceCounter, fFeatures.
                */
            </comment>
            <constructor>
                <specifier>public</specifier>
                <name>DOMSerializerImpl</name>
                <parameter_list>()</parameter_list>
                <block>{
                    <comment type="line">// set default features</comment>
                    <expr_stmt>
                        <expr>
                            <name>features</name>
                            |=
                            <name>NAMESPACES</name>
                        </expr>
                        ;
                    </expr_stmt>
                    <expr_stmt>
                        <expr>
                            <name>features</name>
                            |=
                            <name>ENTITIES</name>
                        </expr>
                        ;
                    </expr_stmt>
                    <expr_stmt>
                        <expr>
                            <name>features</name>
                            |=
                            <name>COMMENTS</name>
                        </expr>
                        ;
                    </expr_stmt>
                    <expr_stmt>
                        <expr>
                            <name>features</name>
                            |=
                            <name>CDATA</name>
                        </expr>
                        ;
                    </expr_stmt>
                    <expr_stmt>
                        <expr>
                            <name>features</name>
                            |=
                            <name>SPLITCDATA</name>
                        </expr>
                        ;
                    </expr_stmt>
                    <expr_stmt>
                        <expr>
                            <name>features</name>
                            |=
                            <name>WELLFORMED</name>
                        </expr>
                        ;
                    </expr_stmt>
                    <expr_stmt>
                        <expr>
                            <name>features</name>
                            |=
                            <name>NSDECL</name>
                        </expr>
                        ;
                    </expr_stmt>
                    <expr_stmt>
                        <expr>
                            <name>features</name>
                            |=
                            <name>DOM_ELEMENT_CONTENT_WHITESPACE</name>
                        </expr>
                        ;
                    </expr_stmt>
                    <expr_stmt>
                        <expr>
                            <name>features</name>
                            |=
                            <name>DISCARDDEFAULT</name>
                        </expr>
                        ;
                    </expr_stmt>
                    <expr_stmt>
                        <expr>
                            <name>features</name>
                            |=
                            <name>XMLDECL</name>
                        </expr>
                        ;
                    </expr_stmt>

                    <expr_stmt>
                        <expr>
                            <name>serializer</name>
                            = new
                            <call>
                                <name>XMLSerializer</name>
                                <argument_list>()</argument_list>
                            </call>
                        </expr>
                        ;
                    </expr_stmt>
                    <expr_stmt>
                        <expr>
                            <call>
                                <name>initSerializer</name>
                                <argument_list>(
                                    <argument>
                                        <expr>
                                            <name>serializer</name>
                                        </expr>
                                    </argument>
                                    )
                                </argument_list>
                            </call>
                        </expr>
                        ;
                    </expr_stmt>
                    }
                </block>
            </constructor>


            <comment type="line">//</comment>
            <comment type="line">// LSSerializer methods</comment>
            <comment type="line">//</comment>

            <function>
                <type>
                    <specifier>public</specifier>
                    <name>DOMConfiguration</name>
                </type>
                <name>getDomConfig</name>
                <parameter_list>()</parameter_list>
                <block>{
                    <return>return
                        <expr>
                            <name>this</name>
                        </expr>
                        ;
                    </return>
                    }
                </block>
            </function>

            <comment type="javadoc">/** DOM L3-EXPERIMENTAL:
                * Setter for boolean and object parameters
                */
            </comment>
            <function>
                <type>
                    <specifier>public</specifier>
                    <name>void</name>
                </type>
                <name>setParameter</name>
                <parameter_list>(
                    <param>
                        <decl>
                            <type>
                                <name>String</name>
                            </type>
                            <name>name</name>
                        </decl>
                    </param>
                    ,
                    <param>
                        <decl>
                            <type>
                                <name>Object</name>
                            </type>
                            <name>value</name>
                        </decl>
                    </param>
                    )
                </parameter_list>
                <throws>throws
                    <argument>
                        <expr>
                            <name>DOMException</name>
                        </expr>
                    </argument>
                </throws>
                <block>{
                    <if>if
                        <condition>(
                            <expr>
                                <name>value</name>
                                <name>instanceof</name>
                                <name>Boolean</name>
                            </expr>
                            )
                        </condition>
                        <then>
                            <block>{
                                <decl_stmt>
                                    <decl>
                                        <type>
                                            <name>boolean</name>
                                        </type>
                                        <name>state</name> =
                                        <init>
                                            <expr>((<name>Boolean</name>) <name>value</name>).
                                                <call>
                                                    <name>booleanValue</name>
                                                    <argument_list>()</argument_list>
                                                </call>
                                            </expr>
                                        </init>
                                    </decl>
                                    ;
                                </decl_stmt>
                                <if>if
                                    <condition>(
                                        <expr>
                                            <call>
                                                <name><name>name</name>.
                                                    <name>equalsIgnoreCase</name>
                                                </name>
                                                <argument_list>(
                                                    <argument>
                                                        <expr>
                                                            <name><name>Constants</name>.
                                                                <name>DOM_INFOSET</name>
                                                            </name>
                                                        </expr>
                                                    </argument>
                                                    )
                                                </argument_list>
                                            </call>
                                        </expr>
                                        )
                                    </condition>
                                    <then>
                                        <block>{
                                            <if>if
                                                <condition>(
                                                    <expr>
                                                        <name>state</name>
                                                    </expr>
                                                    )
                                                </condition>
                                                <then>
                                                    <block>{
                                                        <expr_stmt>
                                                            <expr>
                                                                <name>features</name>
                                                                &amp;= ~
                                                                <name>ENTITIES</name>
                                                            </expr>
                                                            ;
                                                        </expr_stmt>
                                                        <expr_stmt>
                                                            <expr>
                                                                <name>features</name>
                                                                &amp;= ~
                                                                <name>CDATA</name>
                                                            </expr>
                                                            ;
                                                        </expr_stmt>
                                                        <expr_stmt>
                                                            <expr>
                                                                <name>features</name>
                                                                |=
                                                                <name>NAMESPACES</name>
                                                            </expr>
                                                            ;
                                                        </expr_stmt>
                                                        <expr_stmt>
                                                            <expr>
                                                                <name>features</name>
                                                                |=
                                                                <name>NSDECL</name>
                                                            </expr>
                                                            ;
                                                        </expr_stmt>
                                                        <expr_stmt>
                                                            <expr>
                                                                <name>features</name>
                                                                |=
                                                                <name>WELLFORMED</name>
                                                            </expr>
                                                            ;
                                                        </expr_stmt>
                                                        <expr_stmt>
                                                            <expr>
                                                                <name>features</name>
                                                                |=
                                                                <name>COMMENTS</name>
                                                            </expr>
                                                            ;
                                                        </expr_stmt>
                                                        }
                                                    </block>
                                                </then>
                                            </if>
                                            <comment type="line">// false does not have any effect</comment>
                                            }
                                        </block>
                                    </then>
                                    <else>else
                                        <if>if
                                            <condition>(
                                                <expr>
                                                    <call>
                                                        <name><name>name</name>.
                                                            <name>equalsIgnoreCase</name>
                                                        </name>
                                                        <argument_list>(
                                                            <argument>
                                                                <expr>
                                                                    <name><name>Constants</name>.
                                                                        <name>DOM_XMLDECL</name>
                                                                    </name>
                                                                </expr>
                                                            </argument>
                                                            )
                                                        </argument_list>
                                                    </call>
                                                </expr>
                                                )
                                            </condition>
                                            <then>
                                                <block>{
                                                    <expr_stmt>
                                                        <expr>
                                                            <name>features</name>
                                                            =
                                                            <call>(<name>short</name>)
                                                                <argument_list>(
                                                                    <argument>
                                                                        <expr>
                                                                            <name>state</name>
                                                                            ? <name>features</name> | <name>XMLDECL
                                                                        </name> : <name>features</name> &amp; ~
                                                                            <name>XMLDECL</name>
                                                                        </expr>
                                                                    </argument>
                                                                    )
                                                                </argument_list>
                                                            </call>
                                                        </expr>
                                                        ;
                                                    </expr_stmt>
                                                    }
                                                </block>
                                            </then>
                                            <else>else
                                                <if>if
                                                    <condition>(
                                                        <expr>
                                                            <call>
                                                                <name><name>name</name>.
                                                                    <name>equalsIgnoreCase</name>
                                                                </name>
                                                                <argument_list>(
                                                                    <argument>
                                                                        <expr>
                                                                            <name><name>Constants</name>.
                                                                                <name>DOM_NAMESPACES</name>
                                                                            </name>
                                                                        </expr>
                                                                    </argument>
                                                                    )
                                                                </argument_list>
                                                            </call>
                                                        </expr>
                                                        )
                                                    </condition>
                                                    <then>
                                                        <block>{
                                                            <expr_stmt>
                                                                <expr>
                                                                    <name>features</name>
                                                                    =
                                                                    <call>(<name>short</name>)
                                                                        <argument_list>(
                                                                            <argument>
                                                                                <expr>
                                                                                    <name>state</name>
                                                                                    ? <name>features</name> |
                                                                                    <name>NAMESPACES</name>
                                                                                    : <name>features</name> &amp; ~
                                                                                    <name>NAMESPACES</name>
                                                                                </expr>
                                                                            </argument>
                                                                            )
                                                                        </argument_list>
                                                                    </call>
                                                                </expr>
                                                                ;
                                                            </expr_stmt>
                                                            <expr_stmt>
                                                                <expr>
                                                                    <name><name>serializer</name>.
                                                                        <name>fNamespaces</name>
                                                                    </name>
                                                                    =
                                                                    <name>state</name>
                                                                </expr>
                                                                ;
                                                            </expr_stmt>
                                                            }
                                                        </block>
                                                    </then>
                                                    <else>else
                                                        <if>if
                                                            <condition>(
                                                                <expr>
                                                                    <call>
                                                                        <name><name>name</name>.
                                                                            <name>equalsIgnoreCase</name>
                                                                        </name>
                                                                        <argument_list>(
                                                                            <argument>
                                                                                <expr>
                                                                                    <name><name>Constants</name>.
                                                                                        <name>DOM_SPLIT_CDATA</name>
                                                                                    </name>
                                                                                </expr>
                                                                            </argument>
                                                                            )
                                                                        </argument_list>
                                                                    </call>
                                                                </expr>
                                                                )
                                                            </condition>
                                                            <then>
                                                                <block>{
                                                                    <expr_stmt>
                                                                        <expr>
                                                                            <name>features</name>
                                                                            =
                                                                            <call>(<name>short</name>)
                                                                                <argument_list>(
                                                                                    <argument>
                                                                                        <expr>
                                                                                            <name>state</name>
                                                                                            ? <name>features</name> |
                                                                                            <name>SPLITCDATA</name>
                                                                                            : <name>features</name> &amp;
                                                                                            ~
                                                                                            <name>SPLITCDATA</name>
                                                                                        </expr>
                                                                                    </argument>
                                                                                    )
                                                                                </argument_list>
                                                                            </call>
                                                                        </expr>
                                                                        ;
                                                                    </expr_stmt>
                                                                    }
                                                                </block>
                                                            </then>
                                                            <else>else
                                                                <if>if
                                                                    <condition>(
                                                                        <expr>
                                                                            <call>
                                                                                <name><name>name</name>.
                                                                                    <name>equalsIgnoreCase</name>
                                                                                </name>
                                                                                <argument_list>(
                                                                                    <argument>
                                                                                        <expr>
                                                                                            <name><name>Constants</name>
                                                                                                .
                                                                                                <name>
                                                                                                    DOM_DISCARD_DEFAULT_CONTENT
                                                                                                </name>
                                                                                            </name>
                                                                                        </expr>
                                                                                    </argument>
                                                                                    )
                                                                                </argument_list>
                                                                            </call>
                                                                        </expr>
                                                                        )
                                                                    </condition>
                                                                    <then>
                                                                        <block>{
                                                                            <expr_stmt>
                                                                                <expr>
                                                                                    <name>features</name>
                                                                                    =
                                                                                    <call>(<name>short</name>)
                                                                                        <argument_list>(
                                                                                            <argument>
                                                                                                <expr>
                                                                                                    <name>state</name>
                                                                                                    ? <name>features
                                                                                                </name> |
                                                                                                    <name>
                                                                                                        DISCARDDEFAULT
                                                                                                    </name>
                                                                                                    : <name>features
                                                                                                </name> &amp; ~
                                                                                                    <name>
                                                                                                        DISCARDDEFAULT
                                                                                                    </name>
                                                                                                </expr>
                                                                                            </argument>
                                                                                            )
                                                                                        </argument_list>
                                                                                    </call>
                                                                                </expr>
                                                                                ;
                                                                            </expr_stmt>
                                                                            }
                                                                        </block>
                                                                    </then>
                                                                    <else>else
                                                                        <if>if
                                                                            <condition>(
                                                                                <expr>
                                                                                    <call>
                                                                                        <name><name>name</name>.
                                                                                            <name>equalsIgnoreCase
                                                                                            </name>
                                                                                        </name>
                                                                                        <argument_list>(
                                                                                            <argument>
                                                                                                <expr>
                                                                                                    <name><name>
                                                                                                        Constants</name>
                                                                                                        .
                                                                                                        <name>
                                                                                                            DOM_WELLFORMED
                                                                                                        </name>
                                                                                                    </name>
                                                                                                </expr>
                                                                                            </argument>
                                                                                            )
                                                                                        </argument_list>
                                                                                    </call>
                                                                                </expr>
                                                                                )
                                                                            </condition>
                                                                            <then>
                                                                                <block>{
                                                                                    <expr_stmt>
                                                                                        <expr>
                                                                                            <name>features</name>
                                                                                            =
                                                                                            <call>(<name>short</name>)
                                                                                                <argument_list>(
                                                                                                    <argument>
                                                                                                        <expr>
                                                                                                            <name>
                                                                                                                state
                                                                                                            </name>
                                                                                                            ? <name>
                                                                                                            features
                                                                                                        </name> |
                                                                                                            <name>
                                                                                                                WELLFORMED
                                                                                                            </name>
                                                                                                            : <name>
                                                                                                            features
                                                                                                        </name> &amp; ~
                                                                                                            <name>
                                                                                                                WELLFORMED
                                                                                                            </name>
                                                                                                        </expr>
                                                                                                    </argument>
                                                                                                    )
                                                                                                </argument_list>
                                                                                            </call>
                                                                                        </expr>
                                                                                        ;
                                                                                    </expr_stmt>
                                                                                    }
                                                                                </block>
                                                                            </then>
                                                                            <else>else
                                                                                <if>if
                                                                                    <condition>(
                                                                                        <expr>
                                                                                            <call>
                                                                                                <name><name>name</name>.
                                                                                                    <name>
                                                                                                        equalsIgnoreCase
                                                                                                    </name>
                                                                                                </name>
                                                                                                <argument_list>(
                                                                                                    <argument>
                                                                                                        <expr>
                                                                                                            <name><name>
                                                                                                                Constants</name>
                                                                                                                .
                                                                                                                <name>
                                                                                                                    DOM_ENTITIES
                                                                                                                </name>
                                                                                                            </name>
                                                                                                        </expr>
                                                                                                    </argument>
                                                                                                    )
                                                                                                </argument_list>
                                                                                            </call>
                                                                                        </expr>
                                                                                        )
                                                                                    </condition>
                                                                                    <then>
                                                                                        <block>{
                                                                                            <expr_stmt>
                                                                                                <expr>
                                                                                                    <name>features
                                                                                                    </name>
                                                                                                    =
                                                                                                    <call>(<name>
                                                                                                        short</name>)
                                                                                                        <argument_list>(
                                                                                                            <argument>
                                                                                                                <expr>
                                                                                                                    <name>
                                                                                                                        state
                                                                                                                    </name>
                                                                                                                    ? <name>
                                                                                                                    features
                                                                                                                </name> |
                                                                                                                    <name>
                                                                                                                        ENTITIES
                                                                                                                    </name>
                                                                                                                    : <name>
                                                                                                                    features
                                                                                                                </name> &amp;
                                                                                                                    ~
                                                                                                                    <name>
                                                                                                                        ENTITIES
                                                                                                                    </name>
                                                                                                                </expr>
                                                                                                            </argument>
                                                                                                            )
                                                                                                        </argument_list>
                                                                                                    </call>
                                                                                                </expr>
                                                                                                ;
                                                                                            </expr_stmt>
                                                                                            }
                                                                                        </block>
                                                                                    </then>
                                                                                    <else>else
                                                                                        <if>if
                                                                                            <condition>(
                                                                                                <expr>
                                                                                                    <call>
                                                                                                        <name><name>
                                                                                                            name</name>.
                                                                                                            <name>
                                                                                                                equalsIgnoreCase
                                                                                                            </name>
                                                                                                        </name>
                                                                                                        <argument_list>(
                                                                                                            <argument>
                                                                                                                <expr>
                                                                                                                    <name>
                                                                                                                        <name>
                                                                                                                            Constants</name>
                                                                                                                        .
                                                                                                                        <name>
                                                                                                                            DOM_CDATA_SECTIONS
                                                                                                                        </name>
                                                                                                                    </name>
                                                                                                                </expr>
                                                                                                            </argument>
                                                                                                            )
                                                                                                        </argument_list>
                                                                                                    </call>
                                                                                                </expr>
                                                                                                )
                                                                                            </condition>
                                                                                            <then>
                                                                                                <block>{
                                                                                                    <expr_stmt>
                                                                                                        <expr>
                                                                                                            <name>
                                                                                                                features
                                                                                                            </name>
                                                                                                            =
                                                                                                            <call>
                                                                                                                (<name>
                                                                                                                short</name>)
                                                                                                                <argument_list>
                                                                                                                    (
                                                                                                                    <argument>
                                                                                                                        <expr>
                                                                                                                            <name>
                                                                                                                                state
                                                                                                                            </name>
                                                                                                                            ? <name>
                                                                                                                            features
                                                                                                                        </name> |
                                                                                                                            <name>
                                                                                                                                CDATA
                                                                                                                            </name>
                                                                                                                            : <name>
                                                                                                                            features
                                                                                                                        </name> &amp;
                                                                                                                            ~
                                                                                                                            <name>
                                                                                                                                CDATA
                                                                                                                            </name>
                                                                                                                        </expr>
                                                                                                                    </argument>
                                                                                                                    )
                                                                                                                </argument_list>
                                                                                                            </call>
                                                                                                        </expr>
                                                                                                        ;
                                                                                                    </expr_stmt>
                                                                                                    }
                                                                                                </block>
                                                                                            </then>
                                                                                            <else>else
                                                                                                <if>if
                                                                                                    <condition>(
                                                                                                        <expr>
                                                                                                            <call>
                                                                                                                <name>
                                                                                                                    <name>
                                                                                                                        name</name>
                                                                                                                    .
                                                                                                                    <name>
                                                                                                                        equalsIgnoreCase
                                                                                                                    </name>
                                                                                                                </name>
                                                                                                                <argument_list>
                                                                                                                    (
                                                                                                                    <argument>
                                                                                                                        <expr>
                                                                                                                            <name>
                                                                                                                                <name>
                                                                                                                                    Constants</name>
                                                                                                                                .
                                                                                                                                <name>
                                                                                                                                    DOM_COMMENTS
                                                                                                                                </name>
                                                                                                                            </name>
                                                                                                                        </expr>
                                                                                                                    </argument>
                                                                                                                    )
                                                                                                                </argument_list>
                                                                                                            </call>
                                                                                                        </expr>
                                                                                                        )
                                                                                                    </condition>
                                                                                                    <then>
                                                                                                        <block>{
                                                                                                            <expr_stmt>
                                                                                                                <expr>
                                                                                                                    <name>
                                                                                                                        features
                                                                                                                    </name>
                                                                                                                    =
                                                                                                                    <call>
                                                                                                                        (<name>
                                                                                                                        short</name>)
                                                                                                                        <argument_list>
                                                                                                                            (
                                                                                                                            <argument>
                                                                                                                                <expr>
                                                                                                                                    <name>
                                                                                                                                        state
                                                                                                                                    </name>
                                                                                                                                    ? <name>
                                                                                                                                    features
                                                                                                                                </name> |
                                                                                                                                    <name>
                                                                                                                                        COMMENTS
                                                                                                                                    </name>
                                                                                                                                    : <name>
                                                                                                                                    features
                                                                                                                                </name> &amp;
                                                                                                                                    ~
                                                                                                                                    <name>
                                                                                                                                        COMMENTS
                                                                                                                                    </name>
                                                                                                                                </expr>
                                                                                                                            </argument>
                                                                                                                            )
                                                                                                                        </argument_list>
                                                                                                                    </call>
                                                                                                                </expr>
                                                                                                                ;
                                                                                                            </expr_stmt>
                                                                                                            }
                                                                                                        </block>
                                                                                                    </then>
                                                                                                    <else>else
                                                                                                        <if>if
                                                                                                            <condition>(
                                                                                                                <expr>
                                                                                                                    <call>
                                                                                                                        <name>
                                                                                                                            <name>
                                                                                                                                name</name>
                                                                                                                            .
                                                                                                                            <name>
                                                                                                                                equalsIgnoreCase
                                                                                                                            </name>
                                                                                                                        </name>
                                                                                                                        <argument_list>
                                                                                                                            (
                                                                                                                            <argument>
                                                                                                                                <expr>
                                                                                                                                    <name>
                                                                                                                                        <name>
                                                                                                                                            Constants</name>
                                                                                                                                        .
                                                                                                                                        <name>
                                                                                                                                            DOM_CANONICAL_FORM
                                                                                                                                        </name>
                                                                                                                                    </name>
                                                                                                                                </expr>
                                                                                                                            </argument>
                                                                                                                            )
                                                                                                                        </argument_list>
                                                                                                                    </call>
                                                                                                                    ||
                                                                                                                    <call>
                                                                                                                        <name>
                                                                                                                            <name>
                                                                                                                                name</name>
                                                                                                                            .
                                                                                                                            <name>
                                                                                                                                equalsIgnoreCase
                                                                                                                            </name>
                                                                                                                        </name>
                                                                                                                        <argument_list>
                                                                                                                            (
                                                                                                                            <argument>
                                                                                                                                <expr>
                                                                                                                                    <name>
                                                                                                                                        <name>
                                                                                                                                            Constants</name>
                                                                                                                                        .
                                                                                                                                        <name>
                                                                                                                                            DOM_VALIDATE_IF_SCHEMA
                                                                                                                                        </name>
                                                                                                                                    </name>
                                                                                                                                </expr>
                                                                                                                            </argument>
                                                                                                                            )
                                                                                                                        </argument_list>
                                                                                                                    </call>
                                                                                                                    ||
                                                                                                                    <call>
                                                                                                                        <name>
                                                                                                                            <name>
                                                                                                                                name</name>
                                                                                                                            .
                                                                                                                            <name>
                                                                                                                                equalsIgnoreCase
                                                                                                                            </name>
                                                                                                                        </name>
                                                                                                                        <argument_list>
                                                                                                                            (
                                                                                                                            <argument>
                                                                                                                                <expr>
                                                                                                                                    <name>
                                                                                                                                        <name>
                                                                                                                                            Constants</name>
                                                                                                                                        .
                                                                                                                                        <name>
                                                                                                                                            DOM_VALIDATE
                                                                                                                                        </name>
                                                                                                                                    </name>
                                                                                                                                </expr>
                                                                                                                            </argument>
                                                                                                                            )
                                                                                                                        </argument_list>
                                                                                                                    </call>
                                                                                                                    ||
                                                                                                                    <call>
                                                                                                                        <name>
                                                                                                                            <name>
                                                                                                                                name</name>
                                                                                                                            .
                                                                                                                            <name>
                                                                                                                                equalsIgnoreCase
                                                                                                                            </name>
                                                                                                                        </name>
                                                                                                                        <argument_list>
                                                                                                                            (
                                                                                                                            <argument>
                                                                                                                                <expr>
                                                                                                                                    <name>
                                                                                                                                        <name>
                                                                                                                                            Constants</name>
                                                                                                                                        .
                                                                                                                                        <name>
                                                                                                                                            DOM_CHECK_CHAR_NORMALIZATION
                                                                                                                                        </name>
                                                                                                                                    </name>
                                                                                                                                </expr>
                                                                                                                            </argument>
                                                                                                                            )
                                                                                                                        </argument_list>
                                                                                                                    </call>
                                                                                                                    ||
                                                                                                                    <call>
                                                                                                                        <name>
                                                                                                                            <name>
                                                                                                                                name</name>
                                                                                                                            .
                                                                                                                            <name>
                                                                                                                                equalsIgnoreCase
                                                                                                                            </name>
                                                                                                                        </name>
                                                                                                                        <argument_list>
                                                                                                                            (
                                                                                                                            <argument>
                                                                                                                                <expr>
                                                                                                                                    <name>
                                                                                                                                        <name>
                                                                                                                                            Constants</name>
                                                                                                                                        .
                                                                                                                                        <name>
                                                                                                                                            DOM_DATATYPE_NORMALIZATION
                                                                                                                                        </name>
                                                                                                                                    </name>
                                                                                                                                </expr>
                                                                                                                            </argument>
                                                                                                                            )
                                                                                                                        </argument_list>
                                                                                                                    </call>
                                                                                                                    ||
                                                                                                                    <call>
                                                                                                                        <name>
                                                                                                                            <name>
                                                                                                                                name</name>
                                                                                                                            .
                                                                                                                            <name>
                                                                                                                                equalsIgnoreCase
                                                                                                                            </name>
                                                                                                                        </name>
                                                                                                                        <argument_list>
                                                                                                                            (
                                                                                                                            <argument>
                                                                                                                                <expr>
                                                                                                                                    <name>
                                                                                                                                        <name>
                                                                                                                                            Constants</name>
                                                                                                                                        .
                                                                                                                                        <name>
                                                                                                                                            DOM_FORMAT_PRETTY_PRINT
                                                                                                                                        </name>
                                                                                                                                    </name>
                                                                                                                                </expr>
                                                                                                                            </argument>
                                                                                                                            )
                                                                                                                        </argument_list>
                                                                                                                    </call>
                                                                                                                    ||
                                                                                                                    <call>
                                                                                                                        <name>
                                                                                                                            <name>
                                                                                                                                name</name>
                                                                                                                            .
                                                                                                                            <name>
                                                                                                                                equalsIgnoreCase
                                                                                                                            </name>
                                                                                                                        </name>
                                                                                                                        <argument_list>
                                                                                                                            (
                                                                                                                            <argument>
                                                                                                                                <expr>
                                                                                                                                    <name>
                                                                                                                                        <name>
                                                                                                                                            Constants</name>
                                                                                                                                        .
                                                                                                                                        <name>
                                                                                                                                            DOM_NORMALIZE_CHARACTERS
                                                                                                                                        </name>
                                                                                                                                    </name>
                                                                                                                                </expr>
                                                                                                                            </argument>
                                                                                                                            )
                                                                                                                        </argument_list>
                                                                                                                    </call>
                                                                                                                </expr>
                                                                                                                )
                                                                                                            </condition>
                                                                                                            <then>
                                                                                                                <block>{
                                                                                                                    <comment
                                                                                                                            type="line">
                                                                                                                        //
                                                                                                                        true
                                                                                                                        is
                                                                                                                        not
                                                                                                                        supported
                                                                                                                    </comment>
                                                                                                                    <if>
                                                                                                                        if
                                                                                                                        <condition>
                                                                                                                            (
                                                                                                                            <expr>
                                                                                                                                <name>
                                                                                                                                    state
                                                                                                                                </name>
                                                                                                                            </expr>
                                                                                                                            )
                                                                                                                        </condition>
                                                                                                                        <then>
                                                                                                                            <block>
                                                                                                                                {
                                                                                                                                <decl_stmt>
                                                                                                                                    <decl>
                                                                                                                                        <type>
                                                                                                                                            <name>
                                                                                                                                                String
                                                                                                                                            </name>
                                                                                                                                        </type>
                                                                                                                                        <name>
                                                                                                                                            msg
                                                                                                                                        </name> =
                                                                                                                                        <init>
                                                                                                                                            <expr>
                                                                                                                                                <call>
                                                                                                                                                    <name>
                                                                                                                                                        <name>
                                                                                                                                                            DOMMessageFormatter</name>
                                                                                                                                                        .
                                                                                                                                                        <name>
                                                                                                                                                            formatMessage
                                                                                                                                                        </name>
                                                                                                                                                    </name>
                                                                                                                                                    <argument_list>
                                                                                                                                                        (
                                                                                                                                                        <argument>
                                                                                                                                                            <expr>
                                                                                                                                                                <name>
                                                                                                                                                                    <name>
                                                                                                                                                                        DOMMessageFormatter</name>
                                                                                                                                                                    .
                                                                                                                                                                    <name>
                                                                                                                                                                        DOM_DOMAIN
                                                                                                                                                                    </name>
                                                                                                                                                                </name>
                                                                                                                                                            </expr>
                                                                                                                                                        </argument>
                                                                                                                                                        ,
                                                                                                                                                        <argument>
                                                                                                                                                            <expr>
                                                                                                                                                                "FEATURE_NOT_SUPPORTED"
                                                                                                                                                            </expr>
                                                                                                                                                        </argument>
                                                                                                                                                        ,
                                                                                                                                                        <argument>
                                                                                                                                                            <expr>
                                                                                                                                                                new
                                                                                                                                                                <name>
                                                                                                                                                                    <name>
                                                                                                                                                                        Object
                                                                                                                                                                    </name>
                                                                                                                                                                    <index>
                                                                                                                                                                        []
                                                                                                                                                                    </index>
                                                                                                                                                                </name>
                                                                                                                                                                <block>
                                                                                                                                                                    {
                                                                                                                                                                    <expr>
                                                                                                                                                                        <name>
                                                                                                                                                                            name
                                                                                                                                                                        </name>
                                                                                                                                                                    </expr>
                                                                                                                                                                    }
                                                                                                                                                                </block>
                                                                                                                                                            </expr>
                                                                                                                                                        </argument>
                                                                                                                                                        )
                                                                                                                                                    </argument_list>
                                                                                                                                                </call>
                                                                                                                                            </expr>
                                                                                                                                        </init>
                                                                                                                                    </decl>
                                                                                                                                    ;
                                                                                                                                </decl_stmt>
                                                                                                                                <throw>
                                                                                                                                    throw
                                                                                                                                    <expr>
                                                                                                                                        new
                                                                                                                                        <call>
                                                                                                                                            <name>
                                                                                                                                                DOMException
                                                                                                                                            </name>
                                                                                                                                            <argument_list>
                                                                                                                                                (
                                                                                                                                                <argument>
                                                                                                                                                    <expr>
                                                                                                                                                        <name>
                                                                                                                                                            <name>
                                                                                                                                                                DOMException</name>
                                                                                                                                                            .
                                                                                                                                                            <name>
                                                                                                                                                                NOT_SUPPORTED_ERR
                                                                                                                                                            </name>
                                                                                                                                                        </name>
                                                                                                                                                    </expr>
                                                                                                                                                </argument>
                                                                                                                                                ,
                                                                                                                                                <argument>
                                                                                                                                                    <expr>
                                                                                                                                                        <name>
                                                                                                                                                            msg
                                                                                                                                                        </name>
                                                                                                                                                    </expr>
                                                                                                                                                </argument>
                                                                                                                                                )
                                                                                                                                            </argument_list>
                                                                                                                                        </call>
                                                                                                                                    </expr>
                                                                                                                                    ;
                                                                                                                                </throw>
                                                                                                                                }
                                                                                                                            </block>
                                                                                                                        </then>
                                                                                                                    </if>
                                                                                                                    }
                                                                                                                </block>
                                                                                                            </then>
                                                                                                            <else>else
                                                                                                                <if>if
                                                                                                                    <condition>
                                                                                                                        (
                                                                                                                        <expr>
                                                                                                                            <call>
                                                                                                                                <name>
                                                                                                                                    <name>
                                                                                                                                        name</name>
                                                                                                                                    .
                                                                                                                                    <name>
                                                                                                                                        equalsIgnoreCase
                                                                                                                                    </name>
                                                                                                                                </name>
                                                                                                                                <argument_list>
                                                                                                                                    (
                                                                                                                                    <argument>
                                                                                                                                        <expr>
                                                                                                                                            <name>
                                                                                                                                                <name>
                                                                                                                                                    Constants</name>
                                                                                                                                                .
                                                                                                                                                <name>
                                                                                                                                                    DOM_NAMESPACE_DECLARATIONS
                                                                                                                                                </name>
                                                                                                                                            </name>
                                                                                                                                        </expr>
                                                                                                                                    </argument>
                                                                                                                                    )
                                                                                                                                </argument_list>
                                                                                                                            </call>
                                                                                                                        </expr>
                                                                                                                        )
                                                                                                                    </condition>
                                                                                                                    <then>
                                                                                                                        <block>
                                                                                                                            {
                                                                                                                            <comment
                                                                                                                                    type="line">
                                                                                                                                //namespace-declaration
                                                                                                                                has
                                                                                                                                effect
                                                                                                                                only
                                                                                                                                if
                                                                                                                                namespaces
                                                                                                                                is
                                                                                                                                true
                                                                                                                            </comment>
                                                                                                                            <expr_stmt>
                                                                                                                                <expr>
                                                                                                                                    <name>
                                                                                                                                        features
                                                                                                                                    </name>
                                                                                                                                    =
                                                                                                                                    <call>
                                                                                                                                        (<name>
                                                                                                                                        short</name>)
                                                                                                                                        <argument_list>
                                                                                                                                            (
                                                                                                                                            <argument>
                                                                                                                                                <expr>
                                                                                                                                                    <name>
                                                                                                                                                        state
                                                                                                                                                    </name>
                                                                                                                                                    ? <name>
                                                                                                                                                    features
                                                                                                                                                </name> |
                                                                                                                                                    <name>
                                                                                                                                                        NSDECL
                                                                                                                                                    </name>
                                                                                                                                                    : <name>
                                                                                                                                                    features
                                                                                                                                                </name> &amp;
                                                                                                                                                    ~
                                                                                                                                                    <name>
                                                                                                                                                        NSDECL
                                                                                                                                                    </name>
                                                                                                                                                </expr>
                                                                                                                                            </argument>
                                                                                                                                            )
                                                                                                                                        </argument_list>
                                                                                                                                    </call>
                                                                                                                                </expr>
                                                                                                                                ;
                                                                                                                            </expr_stmt>
                                                                                                                            <expr_stmt>
                                                                                                                                <expr>
                                                                                                                                    <name>
                                                                                                                                        <name>
                                                                                                                                            serializer</name>
                                                                                                                                        .
                                                                                                                                        <name>
                                                                                                                                            fNamespacePrefixes
                                                                                                                                        </name>
                                                                                                                                    </name>
                                                                                                                                    =
                                                                                                                                    <name>
                                                                                                                                        state
                                                                                                                                    </name>
                                                                                                                                </expr>
                                                                                                                                ;
                                                                                                                            </expr_stmt>
                                                                                                                            }
                                                                                                                        </block>
                                                                                                                    </then>
                                                                                                                    <else>
                                                                                                                        else
                                                                                                                        <if>
                                                                                                                            if
                                                                                                                            <condition>
                                                                                                                                (
                                                                                                                                <expr>
                                                                                                                                    <call>
                                                                                                                                        <name>
                                                                                                                                            <name>
                                                                                                                                                name</name>
                                                                                                                                            .
                                                                                                                                            <name>
                                                                                                                                                equalsIgnoreCase
                                                                                                                                            </name>
                                                                                                                                        </name>
                                                                                                                                        <argument_list>
                                                                                                                                            (
                                                                                                                                            <argument>
                                                                                                                                                <expr>
                                                                                                                                                    <name>
                                                                                                                                                        <name>
                                                                                                                                                            Constants</name>
                                                                                                                                                        .
                                                                                                                                                        <name>
                                                                                                                                                            DOM_ELEMENT_CONTENT_WHITESPACE
                                                                                                                                                        </name>
                                                                                                                                                    </name>
                                                                                                                                                </expr>
                                                                                                                                            </argument>
                                                                                                                                            )
                                                                                                                                        </argument_list>
                                                                                                                                    </call>
                                                                                                                                    ||
                                                                                                                                    <call>
                                                                                                                                        <name>
                                                                                                                                            <name>
                                                                                                                                                name</name>
                                                                                                                                            .
                                                                                                                                            <name>
                                                                                                                                                equalsIgnoreCase
                                                                                                                                            </name>
                                                                                                                                        </name>
                                                                                                                                        <argument_list>
                                                                                                                                            (
                                                                                                                                            <argument>
                                                                                                                                                <expr>
                                                                                                                                                    <name>
                                                                                                                                                        <name>
                                                                                                                                                            Constants</name>
                                                                                                                                                        .
                                                                                                                                                        <name>
                                                                                                                                                            DOM_IGNORE_UNKNOWN_CHARACTER_DENORMALIZATIONS
                                                                                                                                                        </name>
                                                                                                                                                    </name>
                                                                                                                                                </expr>
                                                                                                                                            </argument>
                                                                                                                                            )
                                                                                                                                        </argument_list>
                                                                                                                                    </call>
                                                                                                                                </expr>
                                                                                                                                )
                                                                                                                            </condition>
                                                                                                                            <then>
                                                                                                                                <block>
                                                                                                                                    {
                                                                                                                                    <comment
                                                                                                                                            type="line">
                                                                                                                                        //
                                                                                                                                        false
                                                                                                                                        is
                                                                                                                                        not
                                                                                                                                        supported
                                                                                                                                    </comment>
                                                                                                                                    <if>
                                                                                                                                        if
                                                                                                                                        <condition>
                                                                                                                                            (
                                                                                                                                            <expr>
                                                                                                                                                !
                                                                                                                                                <name>
                                                                                                                                                    state
                                                                                                                                                </name>
                                                                                                                                            </expr>
                                                                                                                                            )
                                                                                                                                        </condition>
                                                                                                                                        <then>
                                                                                                                                            <block>
                                                                                                                                                {
                                                                                                                                                <decl_stmt>
                                                                                                                                                    <decl>
                                                                                                                                                        <type>
                                                                                                                                                            <name>
                                                                                                                                                                String
                                                                                                                                                            </name>
                                                                                                                                                        </type>
                                                                                                                                                        <name>
                                                                                                                                                            msg
                                                                                                                                                        </name> =
                                                                                                                                                        <init>
                                                                                                                                                            <expr>
                                                                                                                                                                <call>
                                                                                                                                                                    <name>
                                                                                                                                                                        <name>
                                                                                                                                                                            DOMMessageFormatter</name>
                                                                                                                                                                        .
                                                                                                                                                                        <name>
                                                                                                                                                                            formatMessage
                                                                                                                                                                        </name>
                                                                                                                                                                    </name>
                                                                                                                                                                    <argument_list>
                                                                                                                                                                        (
                                                                                                                                                                        <argument>
                                                                                                                                                                            <expr>
                                                                                                                                                                                <name>
                                                                                                                                                                                    <name>
                                                                                                                                                                                        DOMMessageFormatter</name>
                                                                                                                                                                                    .
                                                                                                                                                                                    <name>
                                                                                                                                                                                        DOM_DOMAIN
                                                                                                                                                                                    </name>
                                                                                                                                                                                </name>
                                                                                                                                                                            </expr>
                                                                                                                                                                        </argument>
                                                                                                                                                                        ,
                                                                                                                                                                        <argument>
                                                                                                                                                                            <expr>
                                                                                                                                                                                "FEATURE_NOT_SUPPORTED"
                                                                                                                                                                            </expr>
                                                                                                                                                                        </argument>
                                                                                                                                                                        ,
                                                                                                                                                                        <argument>
                                                                                                                                                                            <expr>
                                                                                                                                                                                new
                                                                                                                                                                                <name>
                                                                                                                                                                                    <name>
                                                                                                                                                                                        Object
                                                                                                                                                                                    </name>
                                                                                                                                                                                    <index>
                                                                                                                                                                                        []
                                                                                                                                                                                    </index>
                                                                                                                                                                                </name>
                                                                                                                                                                                <block>
                                                                                                                                                                                    {
                                                                                                                                                                                    <expr>
                                                                                                                                                                                        <name>
                                                                                                                                                                                            name
                                                                                                                                                                                        </name>
                                                                                                                                                                                    </expr>
                                                                                                                                                                                    }
                                                                                                                                                                                </block>
                                                                                                                                                                            </expr>
                                                                                                                                                                        </argument>
                                                                                                                                                                        )
                                                                                                                                                                    </argument_list>
                                                                                                                                                                </call>
                                                                                                                                                            </expr>
                                                                                                                                                        </init>
                                                                                                                                                    </decl>
                                                                                                                                                    ;
                                                                                                                                                </decl_stmt>
                                                                                                                                                <throw>
                                                                                                                                                    throw
                                                                                                                                                    <expr>
                                                                                                                                                        new
                                                                                                                                                        <call>
                                                                                                                                                            <name>
                                                                                                                                                                DOMException
                                                                                                                                                            </name>
                                                                                                                                                            <argument_list>
                                                                                                                                                                (
                                                                                                                                                                <argument>
                                                                                                                                                                    <expr>
                                                                                                                                                                        <name>
                                                                                                                                                                            <name>
                                                                                                                                                                                DOMException</name>
                                                                                                                                                                            .
                                                                                                                                                                            <name>
                                                                                                                                                                                NOT_SUPPORTED_ERR
                                                                                                                                                                            </name>
                                                                                                                                                                        </name>
                                                                                                                                                                    </expr>
                                                                                                                                                                </argument>
                                                                                                                                                                ,
                                                                                                                                                                <argument>
                                                                                                                                                                    <expr>
                                                                                                                                                                        <name>
                                                                                                                                                                            msg
                                                                                                                                                                        </name>
                                                                                                                                                                    </expr>
                                                                                                                                                                </argument>
                                                                                                                                                                )
                                                                                                                                                            </argument_list>
                                                                                                                                                        </call>
                                                                                                                                                    </expr>
                                                                                                                                                    ;
                                                                                                                                                </throw>
                                                                                                                                                }
                                                                                                                                            </block>
                                                                                                                                        </then>
                                                                                                                                    </if>
                                                                                                                                    }
                                                                                                                                </block>
                                                                                                                            </then>
                                                                                                                            <else>
                                                                                                                                else
                                                                                                                                <block>
                                                                                                                                    {
                                                                                                                                    <decl_stmt>
                                                                                                                                        <decl>
                                                                                                                                            <type>
                                                                                                                                                <name>
                                                                                                                                                    String
                                                                                                                                                </name>
                                                                                                                                            </type>
                                                                                                                                            <name>
                                                                                                                                                msg
                                                                                                                                            </name> =
                                                                                                                                            <init>
                                                                                                                                                <expr>
                                                                                                                                                    <call>
                                                                                                                                                        <name>
                                                                                                                                                            <name>
                                                                                                                                                                DOMMessageFormatter</name>
                                                                                                                                                            .
                                                                                                                                                            <name>
                                                                                                                                                                formatMessage
                                                                                                                                                            </name>
                                                                                                                                                        </name>
                                                                                                                                                        <argument_list>
                                                                                                                                                            (
                                                                                                                                                            <argument>
                                                                                                                                                                <expr>
                                                                                                                                                                    <name>
                                                                                                                                                                        <name>
                                                                                                                                                                            DOMMessageFormatter</name>
                                                                                                                                                                        .
                                                                                                                                                                        <name>
                                                                                                                                                                            DOM_DOMAIN
                                                                                                                                                                        </name>
                                                                                                                                                                    </name>
                                                                                                                                                                </expr>
                                                                                                                                                            </argument>
                                                                                                                                                            ,
                                                                                                                                                            <argument>
                                                                                                                                                                <expr>
                                                                                                                                                                    "FEATURE_NOT_FOUND"
                                                                                                                                                                </expr>
                                                                                                                                                            </argument>
                                                                                                                                                            ,
                                                                                                                                                            <argument>
                                                                                                                                                                <expr>
                                                                                                                                                                    new
                                                                                                                                                                    <name>
                                                                                                                                                                        <name>
                                                                                                                                                                            Object
                                                                                                                                                                        </name>
                                                                                                                                                                        <index>
                                                                                                                                                                            []
                                                                                                                                                                        </index>
                                                                                                                                                                    </name>
                                                                                                                                                                    <block>
                                                                                                                                                                        {
                                                                                                                                                                        <expr>
                                                                                                                                                                            <name>
                                                                                                                                                                                name
                                                                                                                                                                            </name>
                                                                                                                                                                        </expr>
                                                                                                                                                                        }
                                                                                                                                                                    </block>
                                                                                                                                                                </expr>
                                                                                                                                                            </argument>
                                                                                                                                                            )
                                                                                                                                                        </argument_list>
                                                                                                                                                    </call>
                                                                                                                                                </expr>
                                                                                                                                            </init>
                                                                                                                                        </decl>
                                                                                                                                        ;
                                                                                                                                    </decl_stmt>
                                                                                                                                    <throw>
                                                                                                                                        throw
                                                                                                                                        <expr>
                                                                                                                                            new
                                                                                                                                            <call>
                                                                                                                                                <name>
                                                                                                                                                    DOMException
                                                                                                                                                </name>
                                                                                                                                                <argument_list>
                                                                                                                                                    (
                                                                                                                                                    <argument>
                                                                                                                                                        <expr>
                                                                                                                                                            <name>
                                                                                                                                                                <name>
                                                                                                                                                                    DOMException</name>
                                                                                                                                                                .
                                                                                                                                                                <name>
                                                                                                                                                                    NOT_SUPPORTED_ERR
                                                                                                                                                                </name>
                                                                                                                                                            </name>
                                                                                                                                                        </expr>
                                                                                                                                                    </argument>
                                                                                                                                                    ,
                                                                                                                                                    <argument>
                                                                                                                                                        <expr>
                                                                                                                                                            <name>
                                                                                                                                                                msg
                                                                                                                                                            </name>
                                                                                                                                                        </expr>
                                                                                                                                                    </argument>
                                                                                                                                                    )
                                                                                                                                                </argument_list>
                                                                                                                                            </call>
                                                                                                                                        </expr>
                                                                                                                                        ;
                                                                                                                                    </throw>
                                                                                                                                    }
                                                                                                                                </block>
                                                                                                                            </else>
                                                                                                                        </if>
                                                                                                                    </else>
                                                                                                                </if>
                                                                                                            </else>
                                                                                                        </if>
                                                                                                    </else>
                                                                                                </if>
                                                                                            </else>
                                                                                        </if>
                                                                                    </else>
                                                                                </if>
                                                                            </else>
                                                                        </if>
                                                                    </else>
                                                                </if>
                                                            </else>
                                                        </if>
                                                    </else>
                                                </if>
                                            </else>
                                        </if>
                                    </else>
                                </if>
                                }
                            </block>
                        </then>
                        <else>else
                            <if>if
                                <condition>(
                                    <expr>
                                        <call>
                                            <name><name>name</name>.
                                                <name>equalsIgnoreCase</name>
                                            </name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>Constants</name>.
                                                            <name>DOM_ERROR_HANDLER</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    )
                                </condition>
                                <then>
                                    <block>{
                                        <if>if
                                            <condition>(
                                                <expr>
                                                    <name>value</name>
                                                    == <name>null</name> || <name>value</name>
                                                    <name>instanceof</name>
                                                    <name>DOMErrorHandler</name>
                                                </expr>
                                                )
                                            </condition>
                                            <then>
                                                <block>{
                                                    <expr_stmt>
                                                        <expr>
                                                            <name>fErrorHandler</name>
                                                            = (<name>DOMErrorHandler</name>)
                                                            <name>value</name>
                                                        </expr>
                                                        ;
                                                    </expr_stmt>
                                                    }
                                                </block>
                                            </then>
                                            <else>else
                                                <block>{
                                                    <decl_stmt>
                                                        <decl>
                                                            <type>
                                                                <name>String</name>
                                                            </type>
                                                            <name>msg</name> =
                                                            <init>
                                                                <expr>
                                                                    <call>
                                                                        <name><name>DOMMessageFormatter</name>.
                                                                            <name>formatMessage</name>
                                                                        </name>
                                                                        <argument_list>(
                                                                            <argument>
                                                                                <expr>
                                                                                    <name><name>
                                                                                        DOMMessageFormatter</name>.
                                                                                        <name>DOM_DOMAIN</name>
                                                                                    </name>
                                                                                </expr>
                                                                            </argument>
                                                                            ,
                                                                            <argument>
                                                                                <expr>"TYPE_MISMATCH_ERR"</expr>
                                                                            </argument>
                                                                            ,
                                                                            <argument>
                                                                                <expr>new
                                                                                    <name>
                                                                                        <name>Object</name>
                                                                                        <index>[]</index>
                                                                                    </name>
                                                                                    <block>{
                                                                                        <expr>
                                                                                            <name>name</name>
                                                                                        </expr>
                                                                                        }
                                                                                    </block>
                                                                                </expr>
                                                                            </argument>
                                                                            )
                                                                        </argument_list>
                                                                    </call>
                                                                </expr>
                                                            </init>
                                                        </decl>
                                                        ;
                                                    </decl_stmt>
                                                    <throw>throw
                                                        <expr>new
                                                            <call>
                                                                <name>DOMException</name>
                                                                <argument_list>(
                                                                    <argument>
                                                                        <expr>
                                                                            <name><name>DOMException</name>.
                                                                                <name>TYPE_MISMATCH_ERR</name>
                                                                            </name>
                                                                        </expr>
                                                                    </argument>
                                                                    ,
                                                                    <argument>
                                                                        <expr>
                                                                            <name>msg</name>
                                                                        </expr>
                                                                    </argument>
                                                                    )
                                                                </argument_list>
                                                            </call>
                                                        </expr>
                                                        ;
                                                    </throw>
                                                    }
                                                </block>
                                            </else>
                                        </if>
                                        }
                                    </block>
                                </then>
                                <else>else
                                    <if>if
                                        <condition>(
                                            <expr>
                                                <call>
                                                    <name><name>name</name>.
                                                        <name>equalsIgnoreCase</name>
                                                    </name>
                                                    <argument_list>(
                                                        <argument>
                                                            <expr>
                                                                <name><name>Constants</name>.
                                                                    <name>DOM_RESOURCE_RESOLVER</name>
                                                                </name>
                                                            </expr>
                                                        </argument>
                                                        )
                                                    </argument_list>
                                                </call>
                                                ||
                                                <call>
                                                    <name><name>name</name>.
                                                        <name>equalsIgnoreCase</name>
                                                    </name>
                                                    <argument_list>(
                                                        <argument>
                                                            <expr>
                                                                <name><name>Constants</name>.
                                                                    <name>DOM_SCHEMA_LOCATION</name>
                                                                </name>
                                                            </expr>
                                                        </argument>
                                                        )
                                                    </argument_list>
                                                </call>
                                                ||
                                                <call>
                                                    <name><name>name</name>.
                                                        <name>equalsIgnoreCase</name>
                                                    </name>
                                                    <argument_list>(
                                                        <argument>
                                                            <expr>
                                                                <name><name>Constants</name>.
                                                                    <name>DOM_SCHEMA_TYPE</name>
                                                                </name>
                                                            </expr>
                                                        </argument>
                                                        )
                                                    </argument_list>
                                                </call>
                                                &amp;&amp; <name>value</name> !=
                                                <name>null</name>
                                            </expr>
                                            )
                                        </condition>
                                        <then>
                                            <block>{
                                                <decl_stmt>
                                                    <decl>
                                                        <type>
                                                            <name>String</name>
                                                        </type>
                                                        <name>msg</name> =
                                                        <init>
                                                            <expr>
                                                                <call>
                                                                    <name><name>DOMMessageFormatter</name>.
                                                                        <name>formatMessage</name>
                                                                    </name>
                                                                    <argument_list>(
                                                                        <argument>
                                                                            <expr>
                                                                                <name><name>DOMMessageFormatter</name>.
                                                                                    <name>DOM_DOMAIN</name>
                                                                                </name>
                                                                            </expr>
                                                                        </argument>
                                                                        ,
                                                                        <argument>
                                                                            <expr>"FEATURE_NOT_SUPPORTED"</expr>
                                                                        </argument>
                                                                        ,
                                                                        <argument>
                                                                            <expr>new
                                                                                <name>
                                                                                    <name>Object</name>
                                                                                    <index>[]</index>
                                                                                </name>
                                                                                <block>{
                                                                                    <expr>
                                                                                        <name>name</name>
                                                                                    </expr>
                                                                                    }
                                                                                </block>
                                                                            </expr>
                                                                        </argument>
                                                                        )
                                                                    </argument_list>
                                                                </call>
                                                            </expr>
                                                        </init>
                                                    </decl>
                                                    ;
                                                </decl_stmt>
                                                <throw>throw
                                                    <expr>new
                                                        <call>
                                                            <name>DOMException</name>
                                                            <argument_list>(
                                                                <argument>
                                                                    <expr>
                                                                        <name><name>DOMException</name>.
                                                                            <name>NOT_SUPPORTED_ERR</name>
                                                                        </name>
                                                                    </expr>
                                                                </argument>
                                                                ,
                                                                <argument>
                                                                    <expr>
                                                                        <name>msg</name>
                                                                    </expr>
                                                                </argument>
                                                                )
                                                            </argument_list>
                                                        </call>
                                                    </expr>
                                                    ;
                                                </throw>
                                                }
                                            </block>
                                        </then>
                                        <else>else
                                            <block>{
                                                <decl_stmt>
                                                    <decl>
                                                        <type>
                                                            <name>String</name>
                                                        </type>
                                                        <name>msg</name> =
                                                        <init>
                                                            <expr>
                                                                <call>
                                                                    <name><name>DOMMessageFormatter</name>.
                                                                        <name>formatMessage</name>
                                                                    </name>
                                                                    <argument_list>(
                                                                        <argument>
                                                                            <expr>
                                                                                <name><name>DOMMessageFormatter</name>.
                                                                                    <name>DOM_DOMAIN</name>
                                                                                </name>
                                                                            </expr>
                                                                        </argument>
                                                                        ,
                                                                        <argument>
                                                                            <expr>"FEATURE_NOT_FOUND"</expr>
                                                                        </argument>
                                                                        ,
                                                                        <argument>
                                                                            <expr>new
                                                                                <name>
                                                                                    <name>Object</name>
                                                                                    <index>[]</index>
                                                                                </name>
                                                                                <block>{
                                                                                    <expr>
                                                                                        <name>name</name>
                                                                                    </expr>
                                                                                    }
                                                                                </block>
                                                                            </expr>
                                                                        </argument>
                                                                        )
                                                                    </argument_list>
                                                                </call>
                                                            </expr>
                                                        </init>
                                                    </decl>
                                                    ;
                                                </decl_stmt>
                                                <throw>throw
                                                    <expr>new
                                                        <call>
                                                            <name>DOMException</name>
                                                            <argument_list>(
                                                                <argument>
                                                                    <expr>
                                                                        <name><name>DOMException</name>.
                                                                            <name>NOT_FOUND_ERR</name>
                                                                        </name>
                                                                    </expr>
                                                                </argument>
                                                                ,
                                                                <argument>
                                                                    <expr>
                                                                        <name>msg</name>
                                                                    </expr>
                                                                </argument>
                                                                )
                                                            </argument_list>
                                                        </call>
                                                    </expr>
                                                    ;
                                                </throw>
                                                }
                                            </block>
                                        </else>
                                    </if>
                                </else>
                            </if>
                        </else>
                    </if>
                    }
                </block>
            </function>

            <comment type="javadoc">/** DOM L3-EXPERIMENTAL:
                * Check if parameter can be set
                */
            </comment>
            <function>
                <type>
                    <specifier>public</specifier>
                    <name>boolean</name>
                </type>
                <name>canSetParameter</name>
                <parameter_list>(
                    <param>
                        <decl>
                            <type>
                                <name>String</name>
                            </type>
                            <name>name</name>
                        </decl>
                    </param>
                    ,
                    <param>
                        <decl>
                            <type>
                                <name>Object</name>
                            </type>
                            <name>state</name>
                        </decl>
                    </param>
                    )
                </parameter_list>
                <block>{
                    <if>if
                        <condition>(
                            <expr>
                                <name>state</name>
                                ==
                                <name>null</name>
                            </expr>
                            )
                        </condition>
                        <then>
                            <block>{
                                <return>return <expr>true</expr>;
                                </return>
                                }
                            </block>
                        </then>
                    </if>

                    <if>if
                        <condition>(
                            <expr>
                                <name>state</name>
                                <name>instanceof</name>
                                <name>Boolean</name>
                            </expr>
                            )
                        </condition>
                        <then>
                            <block>{
                                <decl_stmt>
                                    <decl>
                                        <type>
                                            <name>boolean</name>
                                        </type>
                                        <name>value</name> =
                                        <init>
                                            <expr>((<name>Boolean</name>)<name>state</name>).
                                                <call>
                                                    <name>booleanValue</name>
                                                    <argument_list>()</argument_list>
                                                </call>
                                            </expr>
                                        </init>
                                    </decl>
                                    ;
                                </decl_stmt>
                                <if>if
                                    <condition>(
                                        <expr>
                                            <call>
                                                <name><name>name</name>.
                                                    <name>equalsIgnoreCase</name>
                                                </name>
                                                <argument_list>(
                                                    <argument>
                                                        <expr>
                                                            <name><name>Constants</name>.
                                                                <name>DOM_NAMESPACES</name>
                                                            </name>
                                                        </expr>
                                                    </argument>
                                                    )
                                                </argument_list>
                                            </call>
                                            ||
                                            <call>
                                                <name><name>name</name>.
                                                    <name>equalsIgnoreCase</name>
                                                </name>
                                                <argument_list>(
                                                    <argument>
                                                        <expr>
                                                            <name><name>Constants</name>.
                                                                <name>DOM_SPLIT_CDATA</name>
                                                            </name>
                                                        </expr>
                                                    </argument>
                                                    )
                                                </argument_list>
                                            </call>
                                            ||
                                            <call>
                                                <name><name>name</name>.
                                                    <name>equalsIgnoreCase</name>
                                                </name>
                                                <argument_list>(
                                                    <argument>
                                                        <expr>
                                                            <name><name>Constants</name>.
                                                                <name>DOM_DISCARD_DEFAULT_CONTENT</name>
                                                            </name>
                                                        </expr>
                                                    </argument>
                                                    )
                                                </argument_list>
                                            </call>
                                            ||
                                            <call>
                                                <name><name>name</name>.
                                                    <name>equalsIgnoreCase</name>
                                                </name>
                                                <argument_list>(
                                                    <argument>
                                                        <expr>
                                                            <name><name>Constants</name>.
                                                                <name>DOM_XMLDECL</name>
                                                            </name>
                                                        </expr>
                                                    </argument>
                                                    )
                                                </argument_list>
                                            </call>
                                            ||
                                            <call>
                                                <name><name>name</name>.
                                                    <name>equalsIgnoreCase</name>
                                                </name>
                                                <argument_list>(
                                                    <argument>
                                                        <expr>
                                                            <name><name>Constants</name>.
                                                                <name>DOM_WELLFORMED</name>
                                                            </name>
                                                        </expr>
                                                    </argument>
                                                    )
                                                </argument_list>
                                            </call>
                                            ||
                                            <call>
                                                <name><name>name</name>.
                                                    <name>equalsIgnoreCase</name>
                                                </name>
                                                <argument_list>(
                                                    <argument>
                                                        <expr>
                                                            <name><name>Constants</name>.
                                                                <name>DOM_INFOSET</name>
                                                            </name>
                                                        </expr>
                                                    </argument>
                                                    )
                                                </argument_list>
                                            </call>
                                            ||
                                            <call>
                                                <name><name>name</name>.
                                                    <name>equalsIgnoreCase</name>
                                                </name>
                                                <argument_list>(
                                                    <argument>
                                                        <expr>
                                                            <name><name>Constants</name>.
                                                                <name>DOM_ENTITIES</name>
                                                            </name>
                                                        </expr>
                                                    </argument>
                                                    )
                                                </argument_list>
                                            </call>
                                            ||
                                            <call>
                                                <name><name>name</name>.
                                                    <name>equalsIgnoreCase</name>
                                                </name>
                                                <argument_list>(
                                                    <argument>
                                                        <expr>
                                                            <name><name>Constants</name>.
                                                                <name>DOM_CDATA_SECTIONS</name>
                                                            </name>
                                                        </expr>
                                                    </argument>
                                                    )
                                                </argument_list>
                                            </call>
                                            ||
                                            <call>
                                                <name><name>name</name>.
                                                    <name>equalsIgnoreCase</name>
                                                </name>
                                                <argument_list>(
                                                    <argument>
                                                        <expr>
                                                            <name><name>Constants</name>.
                                                                <name>DOM_COMMENTS</name>
                                                            </name>
                                                        </expr>
                                                    </argument>
                                                    )
                                                </argument_list>
                                            </call>
                                            ||
                                            <call>
                                                <name><name>name</name>.
                                                    <name>equalsIgnoreCase</name>
                                                </name>
                                                <argument_list>(
                                                    <argument>
                                                        <expr>
                                                            <name><name>Constants</name>.
                                                                <name>DOM_NAMESPACE_DECLARATIONS</name>
                                                            </name>
                                                        </expr>
                                                    </argument>
                                                    )
                                                </argument_list>
                                            </call>
                                        </expr>
                                        )
                                    </condition>
                                    <then>
                                        <block>{
                                            <comment type="line">// both values supported</comment>
                                            <return>return <expr>true</expr>;
                                            </return>
                                            }
                                        </block>
                                    </then>
                                    <else>else
                                        <if>if
                                            <condition>(
                                                <expr>
                                                    <call>
                                                        <name><name>name</name>.
                                                            <name>equalsIgnoreCase</name>
                                                        </name>
                                                        <argument_list>(
                                                            <argument>
                                                                <expr>
                                                                    <name><name>Constants</name>.
                                                                        <name>DOM_CANONICAL_FORM</name>
                                                                    </name>
                                                                </expr>
                                                            </argument>
                                                            )
                                                        </argument_list>
                                                    </call>
                                                    ||
                                                    <call>
                                                        <name><name>name</name>.
                                                            <name>equalsIgnoreCase</name>
                                                        </name>
                                                        <argument_list>(
                                                            <argument>
                                                                <expr>
                                                                    <name><name>Constants</name>.
                                                                        <name>DOM_VALIDATE_IF_SCHEMA</name>
                                                                    </name>
                                                                </expr>
                                                            </argument>
                                                            )
                                                        </argument_list>
                                                    </call>
                                                    ||
                                                    <call>
                                                        <name><name>name</name>.
                                                            <name>equalsIgnoreCase</name>
                                                        </name>
                                                        <argument_list>(
                                                            <argument>
                                                                <expr>
                                                                    <name><name>Constants</name>.
                                                                        <name>DOM_VALIDATE</name>
                                                                    </name>
                                                                </expr>
                                                            </argument>
                                                            )
                                                        </argument_list>
                                                    </call>
                                                    ||
                                                    <call>
                                                        <name><name>name</name>.
                                                            <name>equalsIgnoreCase</name>
                                                        </name>
                                                        <argument_list>(
                                                            <argument>
                                                                <expr>
                                                                    <name><name>Constants</name>.
                                                                        <name>DOM_CHECK_CHAR_NORMALIZATION</name>
                                                                    </name>
                                                                </expr>
                                                            </argument>
                                                            )
                                                        </argument_list>
                                                    </call>
                                                    ||
                                                    <call>
                                                        <name><name>name</name>.
                                                            <name>equalsIgnoreCase</name>
                                                        </name>
                                                        <argument_list>(
                                                            <argument>
                                                                <expr>
                                                                    <name><name>Constants</name>.
                                                                        <name>DOM_DATATYPE_NORMALIZATION</name>
                                                                    </name>
                                                                </expr>
                                                            </argument>
                                                            )
                                                        </argument_list>
                                                    </call>
                                                    ||
                                                    <call>
                                                        <name><name>name</name>.
                                                            <name>equalsIgnoreCase</name>
                                                        </name>
                                                        <argument_list>(
                                                            <argument>
                                                                <expr>
                                                                    <name><name>Constants</name>.
                                                                        <name>DOM_FORMAT_PRETTY_PRINT</name>
                                                                    </name>
                                                                </expr>
                                                            </argument>
                                                            )
                                                        </argument_list>
                                                    </call>
                                                    ||
                                                    <call>
                                                        <name><name>name</name>.
                                                            <name>equalsIgnoreCase</name>
                                                        </name>
                                                        <argument_list>(
                                                            <argument>
                                                                <expr>
                                                                    <name><name>Constants</name>.
                                                                        <name>DOM_NORMALIZE_CHARACTERS</name>
                                                                    </name>
                                                                </expr>
                                                            </argument>
                                                            )
                                                        </argument_list>
                                                    </call>
                                                </expr>
                                                )
                                            </condition>
                                            <then>
                                                <block>{
                                                    <comment type="line">// true is not supported</comment>
                                                    <return>return
                                                        <expr>!
                                                            <name>value</name>
                                                        </expr>
                                                        ;
                                                    </return>
                                                    }
                                                </block>
                                            </then>
                                            <else>else
                                                <if>if
                                                    <condition>(
                                                        <expr>
                                                            <call>
                                                                <name><name>name</name>.
                                                                    <name>equalsIgnoreCase</name>
                                                                </name>
                                                                <argument_list>(
                                                                    <argument>
                                                                        <expr>
                                                                            <name><name>Constants</name>.
                                                                                <name>DOM_ELEMENT_CONTENT_WHITESPACE
                                                                                </name>
                                                                            </name>
                                                                        </expr>
                                                                    </argument>
                                                                    )
                                                                </argument_list>
                                                            </call>
                                                            ||
                                                            <call>
                                                                <name><name>name</name>.
                                                                    <name>equalsIgnoreCase</name>
                                                                </name>
                                                                <argument_list>(
                                                                    <argument>
                                                                        <expr>
                                                                            <name><name>Constants</name>.
                                                                                <name>
                                                                                    DOM_IGNORE_UNKNOWN_CHARACTER_DENORMALIZATIONS
                                                                                </name>
                                                                            </name>
                                                                        </expr>
                                                                    </argument>
                                                                    )
                                                                </argument_list>
                                                            </call>
                                                        </expr>
                                                        )
                                                    </condition>
                                                    <then>
                                                        <block>{
                                                            <comment type="line">// false is not supported</comment>
                                                            <return>return
                                                                <expr>
                                                                    <name>value</name>
                                                                </expr>
                                                                ;
                                                            </return>
                                                            }
                                                        </block>
                                                    </then>
                                                </if>
                                            </else>
                                        </if>
                                    </else>
                                </if>
                                }
                            </block>
                        </then>
                        <else>else
                            <if>if
                                <condition>(
                                    <expr>
                                        <call>
                                            <name><name>name</name>.
                                                <name>equalsIgnoreCase</name>
                                            </name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>Constants</name>.
                                                            <name>DOM_ERROR_HANDLER</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                        &amp;&amp;
                                        <name>state</name>
                                        == <name>null</name> || <name>state</name>
                                        <name>instanceof</name>
                                        <name>DOMErrorHandler</name>
                                    </expr>
                                    )
                                </condition>
                                <then>
                                    <block>{
                                        <return>return <expr>true</expr>;
                                        </return>
                                        }
                                    </block>
                                </then>
                            </if>
                        </else>
                    </if>
                    <return>return <expr>false</expr>;
                    </return>
                    }
                </block>
            </function>

            <comment type="javadoc">/**
                * DOM Level 3 Core CR - Experimental.
                *
                * The list of the parameters supported by this
                * &lt;code&gt;DOMConfiguration&lt;/code&gt; object and for which at least one value
                * can be set by the application. Note that this list can also contain
                * parameter names defined outside this specification.
                */
            </comment>
            <function>
                <type>
                    <specifier>public</specifier>
                    <name>DOMStringList</name>
                </type>
                <name>getParameterNames</name>
                <parameter_list>()</parameter_list>
                <block>{

                    <if>if
                        <condition>(
                            <expr>
                                <name>fRecognizedParameters</name>
                                ==
                                <name>null</name>
                            </expr>
                            )
                        </condition>
                        <then>
                            <block>{
                                <decl_stmt>
                                    <decl>
                                        <type>
                                            <name>Vector</name>
                                        </type>
                                        <name>parameters</name> =
                                        <init>
                                            <expr>new
                                                <call>
                                                    <name>Vector</name>
                                                    <argument_list>()</argument_list>
                                                </call>
                                            </expr>
                                        </init>
                                    </decl>
                                    ;
                                </decl_stmt>

                                <comment type="line">//Add DOM recognized parameters</comment>
                                <comment type="line">//REVISIT: Would have been nice to have a list of</comment>
                                <comment type="line">//recognized parameters.</comment>
                                <expr_stmt>
                                    <expr>
                                        <call>
                                            <name><name>parameters</name>.
                                                <name>add</name>
                                            </name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>Constants</name>.
                                                            <name>DOM_NAMESPACES</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </expr_stmt>
                                <expr_stmt>
                                    <expr>
                                        <call>
                                            <name><name>parameters</name>.
                                                <name>add</name>
                                            </name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>Constants</name>.
                                                            <name>DOM_SPLIT_CDATA</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </expr_stmt>
                                <expr_stmt>
                                    <expr>
                                        <call>
                                            <name><name>parameters</name>.
                                                <name>add</name>
                                            </name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>Constants</name>.
                                                            <name>DOM_DISCARD_DEFAULT_CONTENT</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </expr_stmt>
                                <expr_stmt>
                                    <expr>
                                        <call>
                                            <name><name>parameters</name>.
                                                <name>add</name>
                                            </name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>Constants</name>.
                                                            <name>DOM_XMLDECL</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </expr_stmt>
                                <expr_stmt>
                                    <expr>
                                        <call>
                                            <name><name>parameters</name>.
                                                <name>add</name>
                                            </name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>Constants</name>.
                                                            <name>DOM_CANONICAL_FORM</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </expr_stmt>
                                <expr_stmt>
                                    <expr>
                                        <call>
                                            <name><name>parameters</name>.
                                                <name>add</name>
                                            </name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>Constants</name>.
                                                            <name>DOM_VALIDATE_IF_SCHEMA</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </expr_stmt>
                                <expr_stmt>
                                    <expr>
                                        <call>
                                            <name><name>parameters</name>.
                                                <name>add</name>
                                            </name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>Constants</name>.
                                                            <name>DOM_VALIDATE</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </expr_stmt>
                                <expr_stmt>
                                    <expr>
                                        <call>
                                            <name><name>parameters</name>.
                                                <name>add</name>
                                            </name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>Constants</name>.
                                                            <name>DOM_CHECK_CHAR_NORMALIZATION</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </expr_stmt>
                                <expr_stmt>
                                    <expr>
                                        <call>
                                            <name><name>parameters</name>.
                                                <name>add</name>
                                            </name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>Constants</name>.
                                                            <name>DOM_DATATYPE_NORMALIZATION</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </expr_stmt>
                                <expr_stmt>
                                    <expr>
                                        <call>
                                            <name><name>parameters</name>.
                                                <name>add</name>
                                            </name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>Constants</name>.
                                                            <name>DOM_FORMAT_PRETTY_PRINT</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </expr_stmt>
                                <expr_stmt>
                                    <expr>
                                        <call>
                                            <name><name>parameters</name>.
                                                <name>add</name>
                                            </name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>Constants</name>.
                                                            <name>DOM_NORMALIZE_CHARACTERS</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </expr_stmt>
                                <expr_stmt>
                                    <expr>
                                        <call>
                                            <name><name>parameters</name>.
                                                <name>add</name>
                                            </name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>Constants</name>.
                                                            <name>DOM_WELLFORMED</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </expr_stmt>
                                <expr_stmt>
                                    <expr>
                                        <call>
                                            <name><name>parameters</name>.
                                                <name>add</name>
                                            </name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>Constants</name>.
                                                            <name>DOM_INFOSET</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </expr_stmt>
                                <expr_stmt>
                                    <expr>
                                        <call>
                                            <name><name>parameters</name>.
                                                <name>add</name>
                                            </name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>Constants</name>.
                                                            <name>DOM_NAMESPACE_DECLARATIONS</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </expr_stmt>
                                <expr_stmt>
                                    <expr>
                                        <call>
                                            <name><name>parameters</name>.
                                                <name>add</name>
                                            </name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>Constants</name>.
                                                            <name>DOM_ELEMENT_CONTENT_WHITESPACE</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </expr_stmt>
                                <expr_stmt>
                                    <expr>
                                        <call>
                                            <name><name>parameters</name>.
                                                <name>add</name>
                                            </name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>Constants</name>.
                                                            <name>DOM_ENTITIES</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </expr_stmt>
                                <expr_stmt>
                                    <expr>
                                        <call>
                                            <name><name>parameters</name>.
                                                <name>add</name>
                                            </name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>Constants</name>.
                                                            <name>DOM_CDATA_SECTIONS</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </expr_stmt>
                                <expr_stmt>
                                    <expr>
                                        <call>
                                            <name><name>parameters</name>.
                                                <name>add</name>
                                            </name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>Constants</name>.
                                                            <name>DOM_COMMENTS</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </expr_stmt>
                                <expr_stmt>
                                    <expr>
                                        <call>
                                            <name><name>parameters</name>.
                                                <name>add</name>
                                            </name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>Constants</name>.
                                                            <name>DOM_IGNORE_UNKNOWN_CHARACTER_DENORMALIZATIONS</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </expr_stmt>
                                <expr_stmt>
                                    <expr>
                                        <call>
                                            <name><name>parameters</name>.
                                                <name>add</name>
                                            </name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>Constants</name>.
                                                            <name>DOM_ERROR_HANDLER</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </expr_stmt>
                                <comment type="line">//parameters.add(Constants.DOM_SCHEMA_LOCATION);</comment>
                                <comment type="line">//parameters.add(Constants.DOM_SCHEMA_TYPE);</comment>

                                <comment type="line">//Add recognized xerces features and properties</comment>

                                <expr_stmt>
                                    <expr>
                                        <name>fRecognizedParameters</name>
                                        = new
                                        <call>
                                            <name>DOMStringListImpl</name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name>parameters</name>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </expr_stmt>

                                }
                            </block>
                        </then>
                    </if>

                    <return>return
                        <expr>
                            <name>fRecognizedParameters</name>
                        </expr>
                        ;
                    </return>
                    }
                </block>
            </function>

            <comment type="javadoc">/** DOM L3-EXPERIMENTAL:
                * Getter for boolean and object parameters
                */
            </comment>
            <function>
                <type>
                    <specifier>public</specifier>
                    <name>Object</name>
                </type>
                <name>getParameter</name>
                <parameter_list>(
                    <param>
                        <decl>
                            <type>
                                <name>String</name>
                            </type>
                            <name>name</name>
                        </decl>
                    </param>
                    )
                </parameter_list>
                <throws>throws
                    <argument>
                        <expr>
                            <name>DOMException</name>
                        </expr>
                    </argument>
                </throws>
                <block>{
                    <if>if
                        <condition>(
                            <expr>
                                <call>
                                    <name><name>name</name>.
                                        <name>equalsIgnoreCase</name>
                                    </name>
                                    <argument_list>(
                                        <argument>
                                            <expr>
                                                <name><name>Constants</name>.
                                                    <name>DOM_COMMENTS</name>
                                                </name>
                                            </expr>
                                        </argument>
                                        )
                                    </argument_list>
                                </call>
                            </expr>
                            )
                        </condition>
                        <then>
                            <block>{
                                <return>return
                                    <expr>((<name>features</name> &amp; <name>COMMENTS</name>) != 0) ?
                                        <name><name>Boolean</name>.
                                            <name>TRUE</name>
                                        </name>
                                        :
                                        <name><name>Boolean</name>.
                                            <name>FALSE</name>
                                        </name>
                                    </expr>
                                    ;
                                </return>
                                }
                            </block>
                        </then>
                        <else>else
                            <if>if
                                <condition>(
                                    <expr>
                                        <call>
                                            <name><name>name</name>.
                                                <name>equalsIgnoreCase</name>
                                            </name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>Constants</name>.
                                                            <name>DOM_NAMESPACES</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    )
                                </condition>
                                <then>
                                    <block>{
                                        <return>return
                                            <expr>(<name>features</name> &amp; <name>NAMESPACES</name>) != 0 ?
                                                <name><name>Boolean</name>.
                                                    <name>TRUE</name>
                                                </name>
                                                :
                                                <name><name>Boolean</name>.
                                                    <name>FALSE</name>
                                                </name>
                                            </expr>
                                            ;
                                        </return>
                                        }
                                    </block>
                                </then>
                                <else>else
                                    <if>if
                                        <condition>(
                                            <expr>
                                                <call>
                                                    <name><name>name</name>.
                                                        <name>equalsIgnoreCase</name>
                                                    </name>
                                                    <argument_list>(
                                                        <argument>
                                                            <expr>
                                                                <name><name>Constants</name>.
                                                                    <name>DOM_XMLDECL</name>
                                                                </name>
                                                            </expr>
                                                        </argument>
                                                        )
                                                    </argument_list>
                                                </call>
                                            </expr>
                                            )
                                        </condition>
                                        <then>
                                            <block>{
                                                <return>return
                                                    <expr>(<name>features</name> &amp; <name>XMLDECL</name>) != 0 ?
                                                        <name><name>Boolean</name>.
                                                            <name>TRUE</name>
                                                        </name>
                                                        :
                                                        <name><name>Boolean</name>.
                                                            <name>FALSE</name>
                                                        </name>
                                                    </expr>
                                                    ;
                                                </return>
                                                }
                                            </block>
                                        </then>
                                        <else>else
                                            <if>if
                                                <condition>(
                                                    <expr>
                                                        <call>
                                                            <name><name>name</name>.
                                                                <name>equalsIgnoreCase</name>
                                                            </name>
                                                            <argument_list>(
                                                                <argument>
                                                                    <expr>
                                                                        <name><name>Constants</name>.
                                                                            <name>DOM_CDATA_SECTIONS</name>
                                                                        </name>
                                                                    </expr>
                                                                </argument>
                                                                )
                                                            </argument_list>
                                                        </call>
                                                    </expr>
                                                    )
                                                </condition>
                                                <then>
                                                    <block>{
                                                        <return>return
                                                            <expr>(<name>features</name> &amp; <name>CDATA</name>) != 0
                                                                ?
                                                                <name><name>Boolean</name>.
                                                                    <name>TRUE</name>
                                                                </name>
                                                                :
                                                                <name><name>Boolean</name>.
                                                                    <name>FALSE</name>
                                                                </name>
                                                            </expr>
                                                            ;
                                                        </return>
                                                        }
                                                    </block>
                                                </then>
                                                <else>else
                                                    <if>if
                                                        <condition>(
                                                            <expr>
                                                                <call>
                                                                    <name><name>name</name>.
                                                                        <name>equalsIgnoreCase</name>
                                                                    </name>
                                                                    <argument_list>(
                                                                        <argument>
                                                                            <expr>
                                                                                <name><name>Constants</name>.
                                                                                    <name>DOM_ENTITIES</name>
                                                                                </name>
                                                                            </expr>
                                                                        </argument>
                                                                        )
                                                                    </argument_list>
                                                                </call>
                                                            </expr>
                                                            )
                                                        </condition>
                                                        <then>
                                                            <block>{
                                                                <return>return
                                                                    <expr>(<name>features</name> &amp; <name>
                                                                        ENTITIES</name>) != 0 ?
                                                                        <name><name>Boolean</name>.
                                                                            <name>TRUE</name>
                                                                        </name>
                                                                        :
                                                                        <name><name>Boolean</name>.
                                                                            <name>FALSE</name>
                                                                        </name>
                                                                    </expr>
                                                                    ;
                                                                </return>
                                                                }
                                                            </block>
                                                        </then>
                                                        <else>else
                                                            <if>if
                                                                <condition>(
                                                                    <expr>
                                                                        <call>
                                                                            <name><name>name</name>.
                                                                                <name>equalsIgnoreCase</name>
                                                                            </name>
                                                                            <argument_list>(
                                                                                <argument>
                                                                                    <expr>
                                                                                        <name><name>Constants</name>.
                                                                                            <name>DOM_SPLIT_CDATA</name>
                                                                                        </name>
                                                                                    </expr>
                                                                                </argument>
                                                                                )
                                                                            </argument_list>
                                                                        </call>
                                                                    </expr>
                                                                    )
                                                                </condition>
                                                                <then>
                                                                    <block>{
                                                                        <return>return
                                                                            <expr>(<name>features</name> &amp; <name>
                                                                                SPLITCDATA</name>) != 0 ?
                                                                                <name><name>Boolean</name>.
                                                                                    <name>TRUE</name>
                                                                                </name>
                                                                                :
                                                                                <name><name>Boolean</name>.
                                                                                    <name>FALSE</name>
                                                                                </name>
                                                                            </expr>
                                                                            ;
                                                                        </return>
                                                                        }
                                                                    </block>
                                                                </then>
                                                                <else>else
                                                                    <if>if
                                                                        <condition>(
                                                                            <expr>
                                                                                <call>
                                                                                    <name><name>name</name>.
                                                                                        <name>equalsIgnoreCase</name>
                                                                                    </name>
                                                                                    <argument_list>(
                                                                                        <argument>
                                                                                            <expr>
                                                                                                <name><name>
                                                                                                    Constants</name>.
                                                                                                    <name>
                                                                                                        DOM_WELLFORMED
                                                                                                    </name>
                                                                                                </name>
                                                                                            </expr>
                                                                                        </argument>
                                                                                        )
                                                                                    </argument_list>
                                                                                </call>
                                                                            </expr>
                                                                            )
                                                                        </condition>
                                                                        <then>
                                                                            <block>{
                                                                                <return>return
                                                                                    <expr>(<name>features
                                                                                    </name> &amp; <name>
                                                                                        WELLFORMED</name>) != 0 ?
                                                                                        <name><name>Boolean</name>.
                                                                                            <name>TRUE</name>
                                                                                        </name>
                                                                                        :
                                                                                        <name><name>Boolean</name>.
                                                                                            <name>FALSE</name>
                                                                                        </name>
                                                                                    </expr>
                                                                                    ;
                                                                                </return>
                                                                                }
                                                                            </block>
                                                                        </then>
                                                                        <else>else
                                                                            <if>if
                                                                                <condition>(
                                                                                    <expr>
                                                                                        <call>
                                                                                            <name><name>name</name>.
                                                                                                <name>equalsIgnoreCase
                                                                                                </name>
                                                                                            </name>
                                                                                            <argument_list>(
                                                                                                <argument>
                                                                                                    <expr>
                                                                                                        <name><name>
                                                                                                            Constants</name>
                                                                                                            .
                                                                                                            <name>
                                                                                                                DOM_NAMESPACE_DECLARATIONS
                                                                                                            </name>
                                                                                                        </name>
                                                                                                    </expr>
                                                                                                </argument>
                                                                                                )
                                                                                            </argument_list>
                                                                                        </call>
                                                                                    </expr>
                                                                                    )
                                                                                </condition>
                                                                                <then>
                                                                                    <block>{
                                                                                        <return>return
                                                                                            <expr>(<name>features</name> &amp; <name>
                                                                                                NSDECL</name>) != 0 ?
                                                                                                <name><name>
                                                                                                    Boolean</name>.
                                                                                                    <name>TRUE</name>
                                                                                                </name>
                                                                                                :
                                                                                                <name><name>
                                                                                                    Boolean</name>.
                                                                                                    <name>FALSE</name>
                                                                                                </name>
                                                                                            </expr>
                                                                                            ;
                                                                                        </return>
                                                                                        }
                                                                                    </block>
                                                                                </then>
                                                                                <else>else
                                                                                    <if>if
                                                                                        <condition>(
                                                                                            <expr>
                                                                                                <call>
                                                                                                    <name><name>
                                                                                                        name</name>.
                                                                                                        <name>
                                                                                                            equalsIgnoreCase
                                                                                                        </name>
                                                                                                    </name>
                                                                                                    <argument_list>(
                                                                                                        <argument>
                                                                                                            <expr>
                                                                                                                <name>
                                                                                                                    <name>
                                                                                                                        Constants</name>
                                                                                                                    .
                                                                                                                    <name>
                                                                                                                        DOM_ELEMENT_CONTENT_WHITESPACE
                                                                                                                    </name>
                                                                                                                </name>
                                                                                                            </expr>
                                                                                                        </argument>
                                                                                                        )
                                                                                                    </argument_list>
                                                                                                </call>
                                                                                                ||
                                                                                                <call>
                                                                                                    <name><name>
                                                                                                        name</name>.
                                                                                                        <name>
                                                                                                            equalsIgnoreCase
                                                                                                        </name>
                                                                                                    </name>
                                                                                                    <argument_list>(
                                                                                                        <argument>
                                                                                                            <expr>
                                                                                                                <name>
                                                                                                                    <name>
                                                                                                                        Constants</name>
                                                                                                                    .
                                                                                                                    <name>
                                                                                                                        DOM_IGNORE_UNKNOWN_CHARACTER_DENORMALIZATIONS
                                                                                                                    </name>
                                                                                                                </name>
                                                                                                            </expr>
                                                                                                        </argument>
                                                                                                        )
                                                                                                    </argument_list>
                                                                                                </call>
                                                                                            </expr>
                                                                                            )
                                                                                        </condition>
                                                                                        <then>
                                                                                            <block>{
                                                                                                <return>return
                                                                                                    <expr>
                                                                                                        <name><name>
                                                                                                            Boolean</name>
                                                                                                            .
                                                                                                            <name>TRUE
                                                                                                            </name>
                                                                                                        </name>
                                                                                                    </expr>
                                                                                                    ;
                                                                                                </return>
                                                                                                }
                                                                                            </block>
                                                                                        </then>
                                                                                        <else>else
                                                                                            <if>if
                                                                                                <condition>(
                                                                                                    <expr>
                                                                                                        <call>
                                                                                                            <name><name>
                                                                                                                name</name>
                                                                                                                .
                                                                                                                <name>
                                                                                                                    equalsIgnoreCase
                                                                                                                </name>
                                                                                                            </name>
                                                                                                            <argument_list>
                                                                                                                (
                                                                                                                <argument>
                                                                                                                    <expr>
                                                                                                                        <name>
                                                                                                                            <name>
                                                                                                                                Constants</name>
                                                                                                                            .
                                                                                                                            <name>
                                                                                                                                DOM_DISCARD_DEFAULT_CONTENT
                                                                                                                            </name>
                                                                                                                        </name>
                                                                                                                    </expr>
                                                                                                                </argument>
                                                                                                                )
                                                                                                            </argument_list>
                                                                                                        </call>
                                                                                                    </expr>
                                                                                                    )
                                                                                                </condition>
                                                                                                <then>
                                                                                                    <block>{
                                                                                                        <return>return
                                                                                                            <expr>((<name>
                                                                                                                features
                                                                                                            </name> &amp; <name>
                                                                                                                DISCARDDEFAULT</name>)!=0)?
                                                                                                                <name>
                                                                                                                    <name>
                                                                                                                        Boolean</name>
                                                                                                                    .
                                                                                                                    <name>
                                                                                                                        TRUE
                                                                                                                    </name>
                                                                                                                </name>
                                                                                                                :
                                                                                                                <name>
                                                                                                                    <name>
                                                                                                                        Boolean</name>
                                                                                                                    .
                                                                                                                    <name>
                                                                                                                        FALSE
                                                                                                                    </name>
                                                                                                                </name>
                                                                                                            </expr>
                                                                                                            ;
                                                                                                        </return>
                                                                                                        }
                                                                                                    </block>
                                                                                                </then>
                                                                                                <else>else
                                                                                                    <if>if
                                                                                                        <condition>(
                                                                                                            <expr>
                                                                                                                <call>
                                                                                                                    <name>
                                                                                                                        <name>
                                                                                                                            name</name>
                                                                                                                        .
                                                                                                                        <name>
                                                                                                                            equalsIgnoreCase
                                                                                                                        </name>
                                                                                                                    </name>
                                                                                                                    <argument_list>
                                                                                                                        (
                                                                                                                        <argument>
                                                                                                                            <expr>
                                                                                                                                <name>
                                                                                                                                    <name>
                                                                                                                                        Constants</name>
                                                                                                                                    .
                                                                                                                                    <name>
                                                                                                                                        DOM_INFOSET
                                                                                                                                    </name>
                                                                                                                                </name>
                                                                                                                            </expr>
                                                                                                                        </argument>
                                                                                                                        )
                                                                                                                    </argument_list>
                                                                                                                </call>
                                                                                                            </expr>
                                                                                                            )
                                                                                                        </condition>
                                                                                                        <then>
                                                                                                            <block>{
                                                                                                                <if>if
                                                                                                                    <condition>
                                                                                                                        (
                                                                                                                        <expr>
                                                                                                                            (<name>
                                                                                                                            features
                                                                                                                        </name> &amp; <name>
                                                                                                                            ENTITIES</name>)
                                                                                                                            ==
                                                                                                                            0
                                                                                                                            &amp;&amp;
                                                                                                                            (<name>
                                                                                                                            features
                                                                                                                        </name> &amp; <name>
                                                                                                                            CDATA</name>)
                                                                                                                            ==
                                                                                                                            0
                                                                                                                            &amp;&amp;
                                                                                                                            (<name>
                                                                                                                            features
                                                                                                                        </name> &amp; <name>
                                                                                                                            NAMESPACES</name>)
                                                                                                                            !=
                                                                                                                            0
                                                                                                                            &amp;&amp;
                                                                                                                            (<name>
                                                                                                                            features
                                                                                                                        </name> &amp; <name>
                                                                                                                            NSDECL</name>)
                                                                                                                            !=
                                                                                                                            0
                                                                                                                            &amp;&amp;
                                                                                                                            (<name>
                                                                                                                            features
                                                                                                                        </name> &amp; <name>
                                                                                                                            WELLFORMED</name>)
                                                                                                                            !=
                                                                                                                            0
                                                                                                                            &amp;&amp;
                                                                                                                            (<name>
                                                                                                                            features
                                                                                                                        </name> &amp; <name>
                                                                                                                            COMMENTS</name>)
                                                                                                                            !=
                                                                                                                            0
                                                                                                                        </expr>
                                                                                                                        )
                                                                                                                    </condition>
                                                                                                                    <then>
                                                                                                                        <block>
                                                                                                                            {
                                                                                                                            <return>
                                                                                                                                return
                                                                                                                                <expr>
                                                                                                                                    <name>
                                                                                                                                        <name>
                                                                                                                                            Boolean</name>
                                                                                                                                        .
                                                                                                                                        <name>
                                                                                                                                            TRUE
                                                                                                                                        </name>
                                                                                                                                    </name>
                                                                                                                                </expr>
                                                                                                                                ;
                                                                                                                            </return>
                                                                                                                            }
                                                                                                                        </block>
                                                                                                                    </then>
                                                                                                                </if>
                                                                                                                <return>
                                                                                                                    return
                                                                                                                    <expr>
                                                                                                                        <name>
                                                                                                                            <name>
                                                                                                                                Boolean</name>
                                                                                                                            .
                                                                                                                            <name>
                                                                                                                                FALSE
                                                                                                                            </name>
                                                                                                                        </name>
                                                                                                                    </expr>
                                                                                                                    ;
                                                                                                                </return>
                                                                                                                }
                                                                                                            </block>
                                                                                                        </then>
                                                                                                        <else>else
                                                                                                            <if>if
                                                                                                                <condition>
                                                                                                                    (
                                                                                                                    <expr>
                                                                                                                        <call>
                                                                                                                            <name>
                                                                                                                                <name>
                                                                                                                                    name</name>
                                                                                                                                .
                                                                                                                                <name>
                                                                                                                                    equalsIgnoreCase
                                                                                                                                </name>
                                                                                                                            </name>
                                                                                                                            <argument_list>
                                                                                                                                (
                                                                                                                                <argument>
                                                                                                                                    <expr>
                                                                                                                                        <name>
                                                                                                                                            <name>
                                                                                                                                                Constants</name>
                                                                                                                                            .
                                                                                                                                            <name>
                                                                                                                                                DOM_FORMAT_PRETTY_PRINT
                                                                                                                                            </name>
                                                                                                                                        </name>
                                                                                                                                    </expr>
                                                                                                                                </argument>
                                                                                                                                )
                                                                                                                            </argument_list>
                                                                                                                        </call>
                                                                                                                        ||
                                                                                                                        <call>
                                                                                                                            <name>
                                                                                                                                <name>
                                                                                                                                    name</name>
                                                                                                                                .
                                                                                                                                <name>
                                                                                                                                    equalsIgnoreCase
                                                                                                                                </name>
                                                                                                                            </name>
                                                                                                                            <argument_list>
                                                                                                                                (
                                                                                                                                <argument>
                                                                                                                                    <expr>
                                                                                                                                        <name>
                                                                                                                                            <name>
                                                                                                                                                Constants</name>
                                                                                                                                            .
                                                                                                                                            <name>
                                                                                                                                                DOM_NORMALIZE_CHARACTERS
                                                                                                                                            </name>
                                                                                                                                        </name>
                                                                                                                                    </expr>
                                                                                                                                </argument>
                                                                                                                                )
                                                                                                                            </argument_list>
                                                                                                                        </call>
                                                                                                                        ||
                                                                                                                        <call>
                                                                                                                            <name>
                                                                                                                                <name>
                                                                                                                                    name</name>
                                                                                                                                .
                                                                                                                                <name>
                                                                                                                                    equalsIgnoreCase
                                                                                                                                </name>
                                                                                                                            </name>
                                                                                                                            <argument_list>
                                                                                                                                (
                                                                                                                                <argument>
                                                                                                                                    <expr>
                                                                                                                                        <name>
                                                                                                                                            <name>
                                                                                                                                                Constants</name>
                                                                                                                                            .
                                                                                                                                            <name>
                                                                                                                                                DOM_CANONICAL_FORM
                                                                                                                                            </name>
                                                                                                                                        </name>
                                                                                                                                    </expr>
                                                                                                                                </argument>
                                                                                                                                )
                                                                                                                            </argument_list>
                                                                                                                        </call>
                                                                                                                        ||
                                                                                                                        <call>
                                                                                                                            <name>
                                                                                                                                <name>
                                                                                                                                    name</name>
                                                                                                                                .
                                                                                                                                <name>
                                                                                                                                    equalsIgnoreCase
                                                                                                                                </name>
                                                                                                                            </name>
                                                                                                                            <argument_list>
                                                                                                                                (
                                                                                                                                <argument>
                                                                                                                                    <expr>
                                                                                                                                        <name>
                                                                                                                                            <name>
                                                                                                                                                Constants</name>
                                                                                                                                            .
                                                                                                                                            <name>
                                                                                                                                                DOM_VALIDATE_IF_SCHEMA
                                                                                                                                            </name>
                                                                                                                                        </name>
                                                                                                                                    </expr>
                                                                                                                                </argument>
                                                                                                                                )
                                                                                                                            </argument_list>
                                                                                                                        </call>
                                                                                                                        ||
                                                                                                                        <call>
                                                                                                                            <name>
                                                                                                                                <name>
                                                                                                                                    name</name>
                                                                                                                                .
                                                                                                                                <name>
                                                                                                                                    equalsIgnoreCase
                                                                                                                                </name>
                                                                                                                            </name>
                                                                                                                            <argument_list>
                                                                                                                                (
                                                                                                                                <argument>
                                                                                                                                    <expr>
                                                                                                                                        <name>
                                                                                                                                            <name>
                                                                                                                                                Constants</name>
                                                                                                                                            .
                                                                                                                                            <name>
                                                                                                                                                DOM_CHECK_CHAR_NORMALIZATION
                                                                                                                                            </name>
                                                                                                                                        </name>
                                                                                                                                    </expr>
                                                                                                                                </argument>
                                                                                                                                )
                                                                                                                            </argument_list>
                                                                                                                        </call>
                                                                                                                        ||
                                                                                                                        <call>
                                                                                                                            <name>
                                                                                                                                <name>
                                                                                                                                    name</name>
                                                                                                                                .
                                                                                                                                <name>
                                                                                                                                    equalsIgnoreCase
                                                                                                                                </name>
                                                                                                                            </name>
                                                                                                                            <argument_list>
                                                                                                                                (
                                                                                                                                <argument>
                                                                                                                                    <expr>
                                                                                                                                        <name>
                                                                                                                                            <name>
                                                                                                                                                Constants</name>
                                                                                                                                            .
                                                                                                                                            <name>
                                                                                                                                                DOM_VALIDATE
                                                                                                                                            </name>
                                                                                                                                        </name>
                                                                                                                                    </expr>
                                                                                                                                </argument>
                                                                                                                                )
                                                                                                                            </argument_list>
                                                                                                                        </call>
                                                                                                                        ||
                                                                                                                        <call>
                                                                                                                            <name>
                                                                                                                                <name>
                                                                                                                                    name</name>
                                                                                                                                .
                                                                                                                                <name>
                                                                                                                                    equalsIgnoreCase
                                                                                                                                </name>
                                                                                                                            </name>
                                                                                                                            <argument_list>
                                                                                                                                (
                                                                                                                                <argument>
                                                                                                                                    <expr>
                                                                                                                                        <name>
                                                                                                                                            <name>
                                                                                                                                                Constants</name>
                                                                                                                                            .
                                                                                                                                            <name>
                                                                                                                                                DOM_VALIDATE_IF_SCHEMA
                                                                                                                                            </name>
                                                                                                                                        </name>
                                                                                                                                    </expr>
                                                                                                                                </argument>
                                                                                                                                )
                                                                                                                            </argument_list>
                                                                                                                        </call>
                                                                                                                        ||
                                                                                                                        <call>
                                                                                                                            <name>
                                                                                                                                <name>
                                                                                                                                    name</name>
                                                                                                                                .
                                                                                                                                <name>
                                                                                                                                    equalsIgnoreCase
                                                                                                                                </name>
                                                                                                                            </name>
                                                                                                                            <argument_list>
                                                                                                                                (
                                                                                                                                <argument>
                                                                                                                                    <expr>
                                                                                                                                        <name>
                                                                                                                                            <name>
                                                                                                                                                Constants</name>
                                                                                                                                            .
                                                                                                                                            <name>
                                                                                                                                                DOM_DATATYPE_NORMALIZATION
                                                                                                                                            </name>
                                                                                                                                        </name>
                                                                                                                                    </expr>
                                                                                                                                </argument>
                                                                                                                                )
                                                                                                                            </argument_list>
                                                                                                                        </call>
                                                                                                                    </expr>
                                                                                                                    )
                                                                                                                </condition>
                                                                                                                <then>
                                                                                                                    <block>
                                                                                                                        {
                                                                                                                        <return>
                                                                                                                            return
                                                                                                                            <expr>
                                                                                                                                <name>
                                                                                                                                    <name>
                                                                                                                                        Boolean</name>
                                                                                                                                    .
                                                                                                                                    <name>
                                                                                                                                        FALSE
                                                                                                                                    </name>
                                                                                                                                </name>
                                                                                                                            </expr>
                                                                                                                            ;
                                                                                                                        </return>
                                                                                                                        }
                                                                                                                    </block>
                                                                                                                </then>
                                                                                                                <else>
                                                                                                                    else
                                                                                                                    <if>
                                                                                                                        if
                                                                                                                        <condition>
                                                                                                                            (
                                                                                                                            <expr>
                                                                                                                                <call>
                                                                                                                                    <name>
                                                                                                                                        <name>
                                                                                                                                            name</name>
                                                                                                                                        .
                                                                                                                                        <name>
                                                                                                                                            equalsIgnoreCase
                                                                                                                                        </name>
                                                                                                                                    </name>
                                                                                                                                    <argument_list>
                                                                                                                                        (
                                                                                                                                        <argument>
                                                                                                                                            <expr>
                                                                                                                                                <name>
                                                                                                                                                    <name>
                                                                                                                                                        Constants</name>
                                                                                                                                                    .
                                                                                                                                                    <name>
                                                                                                                                                        DOM_ERROR_HANDLER
                                                                                                                                                    </name>
                                                                                                                                                </name>
                                                                                                                                            </expr>
                                                                                                                                        </argument>
                                                                                                                                        )
                                                                                                                                    </argument_list>
                                                                                                                                </call>
                                                                                                                            </expr>
                                                                                                                            )
                                                                                                                        </condition>
                                                                                                                        <then>
                                                                                                                            <block>
                                                                                                                                {
                                                                                                                                <return>
                                                                                                                                    return
                                                                                                                                    <expr>
                                                                                                                                        <name>
                                                                                                                                            fErrorHandler
                                                                                                                                        </name>
                                                                                                                                    </expr>
                                                                                                                                    ;
                                                                                                                                </return>
                                                                                                                                }
                                                                                                                            </block>
                                                                                                                        </then>
                                                                                                                        <else>
                                                                                                                            else
                                                                                                                            <if>
                                                                                                                                if
                                                                                                                                <condition>
                                                                                                                                    (
                                                                                                                                    <expr>
                                                                                                                                        <call>
                                                                                                                                            <name>
                                                                                                                                                <name>
                                                                                                                                                    name</name>
                                                                                                                                                .
                                                                                                                                                <name>
                                                                                                                                                    equalsIgnoreCase
                                                                                                                                                </name>
                                                                                                                                            </name>
                                                                                                                                            <argument_list>
                                                                                                                                                (
                                                                                                                                                <argument>
                                                                                                                                                    <expr>
                                                                                                                                                        <name>
                                                                                                                                                            <name>
                                                                                                                                                                Constants</name>
                                                                                                                                                            .
                                                                                                                                                            <name>
                                                                                                                                                                DOM_RESOURCE_RESOLVER
                                                                                                                                                            </name>
                                                                                                                                                        </name>
                                                                                                                                                    </expr>
                                                                                                                                                </argument>
                                                                                                                                                )
                                                                                                                                            </argument_list>
                                                                                                                                        </call>
                                                                                                                                        ||
                                                                                                                                        <call>
                                                                                                                                            <name>
                                                                                                                                                <name>
                                                                                                                                                    name</name>
                                                                                                                                                .
                                                                                                                                                <name>
                                                                                                                                                    equalsIgnoreCase
                                                                                                                                                </name>
                                                                                                                                            </name>
                                                                                                                                            <argument_list>
                                                                                                                                                (
                                                                                                                                                <argument>
                                                                                                                                                    <expr>
                                                                                                                                                        <name>
                                                                                                                                                            <name>
                                                                                                                                                                Constants</name>
                                                                                                                                                            .
                                                                                                                                                            <name>
                                                                                                                                                                DOM_SCHEMA_LOCATION
                                                                                                                                                            </name>
                                                                                                                                                        </name>
                                                                                                                                                    </expr>
                                                                                                                                                </argument>
                                                                                                                                                )
                                                                                                                                            </argument_list>
                                                                                                                                        </call>
                                                                                                                                        ||
                                                                                                                                        <call>
                                                                                                                                            <name>
                                                                                                                                                <name>
                                                                                                                                                    name</name>
                                                                                                                                                .
                                                                                                                                                <name>
                                                                                                                                                    equalsIgnoreCase
                                                                                                                                                </name>
                                                                                                                                            </name>
                                                                                                                                            <argument_list>
                                                                                                                                                (
                                                                                                                                                <argument>
                                                                                                                                                    <expr>
                                                                                                                                                        <name>
                                                                                                                                                            <name>
                                                                                                                                                                Constants</name>
                                                                                                                                                            .
                                                                                                                                                            <name>
                                                                                                                                                                DOM_SCHEMA_TYPE
                                                                                                                                                            </name>
                                                                                                                                                        </name>
                                                                                                                                                    </expr>
                                                                                                                                                </argument>
                                                                                                                                                )
                                                                                                                                            </argument_list>
                                                                                                                                        </call>
                                                                                                                                    </expr>
                                                                                                                                    )
                                                                                                                                </condition>
                                                                                                                                <then>
                                                                                                                                    <block>
                                                                                                                                        {
                                                                                                                                        <decl_stmt>
                                                                                                                                            <decl>
                                                                                                                                                <type>
                                                                                                                                                    <name>
                                                                                                                                                        String
                                                                                                                                                    </name>
                                                                                                                                                </type>
                                                                                                                                                <name>
                                                                                                                                                    msg
                                                                                                                                                </name> =
                                                                                                                                                <init>
                                                                                                                                                    <expr>
                                                                                                                                                        <call>
                                                                                                                                                            <name>
                                                                                                                                                                <name>
                                                                                                                                                                    DOMMessageFormatter</name>
                                                                                                                                                                .
                                                                                                                                                                <name>
                                                                                                                                                                    formatMessage
                                                                                                                                                                </name>
                                                                                                                                                            </name>
                                                                                                                                                            <argument_list>
                                                                                                                                                                (
                                                                                                                                                                <argument>
                                                                                                                                                                    <expr>
                                                                                                                                                                        <name>
                                                                                                                                                                            <name>
                                                                                                                                                                                DOMMessageFormatter</name>
                                                                                                                                                                            .
                                                                                                                                                                            <name>
                                                                                                                                                                                DOM_DOMAIN
                                                                                                                                                                            </name>
                                                                                                                                                                        </name>
                                                                                                                                                                    </expr>
                                                                                                                                                                </argument>
                                                                                                                                                                ,
                                                                                                                                                                <argument>
                                                                                                                                                                    <expr>
                                                                                                                                                                        "FEATURE_NOT_SUPPORTED"
                                                                                                                                                                    </expr>
                                                                                                                                                                </argument>
                                                                                                                                                                ,
                                                                                                                                                                <argument>
                                                                                                                                                                    <expr>
                                                                                                                                                                        new
                                                                                                                                                                        <name>
                                                                                                                                                                            <name>
                                                                                                                                                                                Object
                                                                                                                                                                            </name>
                                                                                                                                                                            <index>
                                                                                                                                                                                []
                                                                                                                                                                            </index>
                                                                                                                                                                        </name>
                                                                                                                                                                        <block>
                                                                                                                                                                            {
                                                                                                                                                                            <expr>
                                                                                                                                                                                <name>
                                                                                                                                                                                    name
                                                                                                                                                                                </name>
                                                                                                                                                                            </expr>
                                                                                                                                                                            }
                                                                                                                                                                        </block>
                                                                                                                                                                    </expr>
                                                                                                                                                                </argument>
                                                                                                                                                                )
                                                                                                                                                            </argument_list>
                                                                                                                                                        </call>
                                                                                                                                                    </expr>
                                                                                                                                                </init>
                                                                                                                                            </decl>
                                                                                                                                            ;
                                                                                                                                        </decl_stmt>
                                                                                                                                        <throw>
                                                                                                                                            throw
                                                                                                                                            <expr>
                                                                                                                                                new
                                                                                                                                                <call>
                                                                                                                                                    <name>
                                                                                                                                                        DOMException
                                                                                                                                                    </name>
                                                                                                                                                    <argument_list>
                                                                                                                                                        (
                                                                                                                                                        <argument>
                                                                                                                                                            <expr>
                                                                                                                                                                <name>
                                                                                                                                                                    <name>
                                                                                                                                                                        DOMException</name>
                                                                                                                                                                    .
                                                                                                                                                                    <name>
                                                                                                                                                                        NOT_SUPPORTED_ERR
                                                                                                                                                                    </name>
                                                                                                                                                                </name>
                                                                                                                                                            </expr>
                                                                                                                                                        </argument>
                                                                                                                                                        ,
                                                                                                                                                        <argument>
                                                                                                                                                            <expr>
                                                                                                                                                                <name>
                                                                                                                                                                    msg
                                                                                                                                                                </name>
                                                                                                                                                            </expr>
                                                                                                                                                        </argument>
                                                                                                                                                        )
                                                                                                                                                    </argument_list>
                                                                                                                                                </call>
                                                                                                                                            </expr>
                                                                                                                                            ;
                                                                                                                                        </throw>
                                                                                                                                        }
                                                                                                                                    </block>
                                                                                                                                </then>
                                                                                                                                <else>
                                                                                                                                    else
                                                                                                                                    <block>
                                                                                                                                        {
                                                                                                                                        <decl_stmt>
                                                                                                                                            <decl>
                                                                                                                                                <type>
                                                                                                                                                    <name>
                                                                                                                                                        String
                                                                                                                                                    </name>
                                                                                                                                                </type>
                                                                                                                                                <name>
                                                                                                                                                    msg
                                                                                                                                                </name> =
                                                                                                                                                <init>
                                                                                                                                                    <expr>
                                                                                                                                                        <call>
                                                                                                                                                            <name>
                                                                                                                                                                <name>
                                                                                                                                                                    DOMMessageFormatter</name>
                                                                                                                                                                .
                                                                                                                                                                <name>
                                                                                                                                                                    formatMessage
                                                                                                                                                                </name>
                                                                                                                                                            </name>
                                                                                                                                                            <argument_list>
                                                                                                                                                                (
                                                                                                                                                                <argument>
                                                                                                                                                                    <expr>
                                                                                                                                                                        <name>
                                                                                                                                                                            <name>
                                                                                                                                                                                DOMMessageFormatter</name>
                                                                                                                                                                            .
                                                                                                                                                                            <name>
                                                                                                                                                                                DOM_DOMAIN
                                                                                                                                                                            </name>
                                                                                                                                                                        </name>
                                                                                                                                                                    </expr>
                                                                                                                                                                </argument>
                                                                                                                                                                ,
                                                                                                                                                                <argument>
                                                                                                                                                                    <expr>
                                                                                                                                                                        "FEATURE_NOT_FOUND"
                                                                                                                                                                    </expr>
                                                                                                                                                                </argument>
                                                                                                                                                                ,
                                                                                                                                                                <argument>
                                                                                                                                                                    <expr>
                                                                                                                                                                        new
                                                                                                                                                                        <name>
                                                                                                                                                                            <name>
                                                                                                                                                                                Object
                                                                                                                                                                            </name>
                                                                                                                                                                            <index>
                                                                                                                                                                                []
                                                                                                                                                                            </index>
                                                                                                                                                                        </name>
                                                                                                                                                                        <block>
                                                                                                                                                                            {
                                                                                                                                                                            <expr>
                                                                                                                                                                                <name>
                                                                                                                                                                                    name
                                                                                                                                                                                </name>
                                                                                                                                                                            </expr>
                                                                                                                                                                            }
                                                                                                                                                                        </block>
                                                                                                                                                                    </expr>
                                                                                                                                                                </argument>
                                                                                                                                                                )
                                                                                                                                                            </argument_list>
                                                                                                                                                        </call>
                                                                                                                                                    </expr>
                                                                                                                                                </init>
                                                                                                                                            </decl>
                                                                                                                                            ;
                                                                                                                                        </decl_stmt>
                                                                                                                                        <throw>
                                                                                                                                            throw
                                                                                                                                            <expr>
                                                                                                                                                new
                                                                                                                                                <call>
                                                                                                                                                    <name>
                                                                                                                                                        DOMException
                                                                                                                                                    </name>
                                                                                                                                                    <argument_list>
                                                                                                                                                        (
                                                                                                                                                        <argument>
                                                                                                                                                            <expr>
                                                                                                                                                                <name>
                                                                                                                                                                    <name>
                                                                                                                                                                        DOMException</name>
                                                                                                                                                                    .
                                                                                                                                                                    <name>
                                                                                                                                                                        NOT_FOUND_ERR
                                                                                                                                                                    </name>
                                                                                                                                                                </name>
                                                                                                                                                            </expr>
                                                                                                                                                        </argument>
                                                                                                                                                        ,
                                                                                                                                                        <argument>
                                                                                                                                                            <expr>
                                                                                                                                                                <name>
                                                                                                                                                                    msg
                                                                                                                                                                </name>
                                                                                                                                                            </expr>
                                                                                                                                                        </argument>
                                                                                                                                                        )
                                                                                                                                                    </argument_list>
                                                                                                                                                </call>
                                                                                                                                            </expr>
                                                                                                                                            ;
                                                                                                                                        </throw>
                                                                                                                                        }
                                                                                                                                    </block>
                                                                                                                                </else>
                                                                                                                            </if>
                                                                                                                        </else>
                                                                                                                    </if>
                                                                                                                </else>
                                                                                                            </if>
                                                                                                        </else>
                                                                                                    </if>
                                                                                                </else>
                                                                                            </if>
                                                                                        </else>
                                                                                    </if>
                                                                                </else>
                                                                            </if>
                                                                        </else>
                                                                    </if>
                                                                </else>
                                                            </if>
                                                        </else>
                                                    </if>
                                                </else>
                                            </if>
                                        </else>
                                    </if>
                                </else>
                            </if>
                        </else>
                    </if>
                    }
                </block>
            </function>


            <comment type="javadoc">/**
                * DOM L3 EXPERIMENTAL:
                * Serialize the specified node as described above in the description of
                * &lt;code&gt;LSSerializer&lt;/code&gt;. The result of serializing the node is
                * returned as a string. Writing a Document or Entity node produces a
                * serialized form that is well formed XML. Writing other node types
                * produces a fragment of text in a form that is not fully defined by
                * this document, but that should be useful to a human for debugging or
                * diagnostic purposes.
                * @param wnode The node to be written.
                * @return Returns the serialized data
                * @exception DOMException
                * DOMSTRING_SIZE_ERR: The resulting string is too long to fit in a
                * &lt;code&gt;DOMString&lt;/code&gt;.
                * @exception LSException
                * SERIALIZE_ERR: Unable to serialize the node. DOM applications should
                * attach a &lt;code&gt;DOMErrorHandler&lt;/code&gt; using the parameter
                * &amp;quot;&lt;i&gt;error-handler&lt;/i&gt;&amp;quot; to get details on error.
                */
            </comment>
            <function>
                <type>
                    <specifier>public</specifier>
                    <name>String</name>
                </type>
                <name>writeToString</name>
                <parameter_list>(
                    <param>
                        <decl>
                            <type>
                                <name>Node</name>
                            </type>
                            <name>wnode</name>
                        </decl>
                    </param>
                    )
                </parameter_list>
                <throws>throws
                    <argument>
                        <expr>
                            <name>DOMException</name>
                        </expr>
                    </argument>
                    ,
                    <argument>
                        <expr>
                            <name>LSException</name>
                        </expr>
                    </argument>
                </throws>
                <block>{
                    <comment type="line">// determine which serializer to use:</comment>
                    <decl_stmt>
                        <decl>
                            <type>
                                <name>Document</name>
                            </type>
                            <name>doc</name> =
                            <init>
                                <expr>(
                                    <call>
                                        <name><name>wnode</name>.
                                            <name>getNodeType</name>
                                        </name>
                                        <argument_list>()</argument_list>
                                    </call>
                                    ==
                                    <name><name>Node</name>.
                                        <name>DOCUMENT_NODE</name>
                                    </name>
                                    )?(<name>Document</name>)<name>wnode</name>:
                                    <call>
                                        <name><name>wnode</name>.
                                            <name>getOwnerDocument</name>
                                        </name>
                                        <argument_list>()</argument_list>
                                    </call>
                                </expr>
                            </init>
                        </decl>
                        ;
                    </decl_stmt>
                    <decl_stmt>
                        <decl>
                            <type>
                                <name>Method</name>
                            </type>
                            <name>getVersion</name> =
                            <init>
                                <expr>
                                    <name>null</name>
                                </expr>
                            </init>
                        </decl>
                        ;
                    </decl_stmt>
                    <decl_stmt>
                        <decl>
                            <type>
                                <name>XMLSerializer</name>
                            </type>
                            <name>ser</name> =
                            <init>
                                <expr>
                                    <name>null</name>
                                </expr>
                            </init>
                        </decl>
                        ;
                    </decl_stmt>
                    <decl_stmt>
                        <decl>
                            <type>
                                <name>String</name>
                            </type>
                            <name>ver</name> =
                            <init>
                                <expr>
                                    <name>null</name>
                                </expr>
                            </init>
                        </decl>
                        ;
                    </decl_stmt>
                    <comment type="line">// this should run under JDK 1.1.8...</comment>
                    <try>try
                        <block>{
                            <expr_stmt>
                                <expr>
                                    <name>getVersion</name>
                                    =
                                    <call>
                                        <name><name>doc</name>.
                                            <name>getClass</name>
                                        </name>
                                        <argument_list>()</argument_list>
                                    </call>
                                    .
                                    <call>
                                        <name>getMethod</name>
                                        <argument_list>(
                                            <argument>
                                                <expr>"getXmlVersion"</expr>
                                            </argument>
                                            ,
                                            <argument>
                                                <expr>new
                                                    <name>
                                                        <name>Class</name>
                                                        <index>[]</index>
                                                    </name>
                                                    <block>{}</block>
                                                </expr>
                                            </argument>
                                            )
                                        </argument_list>
                                    </call>
                                </expr>
                                ;
                            </expr_stmt>
                            <if>if
                                <condition>(
                                    <expr>
                                        <name>getVersion</name>
                                        !=
                                        <name>null</name>
                                    </expr>
                                    )
                                </condition>
                                <then>
                                    <block>{
                                        <expr_stmt>
                                            <expr>
                                                <name>ver</name>
                                                = (<name>String</name>)
                                                <call>
                                                    <name><name>getVersion</name>.
                                                        <name>invoke</name>
                                                    </name>
                                                    <argument_list>(
                                                        <argument>
                                                            <expr>
                                                                <name>doc</name>
                                                            </expr>
                                                        </argument>
                                                        ,
                                                        <argument>
                                                            <expr>(
                                                                <name>
                                                                    <name>Object</name>
                                                                    <index>[]</index>
                                                                </name>
                                                                )
                                                                <name>null</name>
                                                            </expr>
                                                        </argument>
                                                        )
                                                    </argument_list>
                                                </call>
                                            </expr>
                                            ;
                                        </expr_stmt>
                                        }
                                    </block>
                                </then>
                            </if>
                            }
                        </block>
                        <catch>catch (
                            <param>
                                <decl>
                                    <type>
                                        <name>Exception</name>
                                    </type>
                                    <name>e</name>
                                </decl>
                            </param>
                            )
                            <block>{
                                <comment type="line">// no way to test the version...</comment>
                                <comment type="line">// ignore the exception</comment>
                                }
                            </block>
                        </catch>
                    </try>
                    <if>if
                        <condition>(
                            <expr>
                                <name>ver</name>
                                != <name>null</name> &amp;&amp;
                                <call>
                                    <name><name>ver</name>.
                                        <name>equals</name>
                                    </name>
                                    <argument_list>(
                                        <argument>
                                            <expr>"1.1"</expr>
                                        </argument>
                                        )
                                    </argument_list>
                                </call>
                            </expr>
                            )
                        </condition>
                        <then>
                            <block>{
                                <if>if
                                    <condition>(
                                        <expr>
                                            <name>xml11Serializer</name>
                                            ==
                                            <name>null</name>
                                        </expr>
                                        )
                                    </condition>
                                    <then>
                                        <block>{
                                            <expr_stmt>
                                                <expr>
                                                    <name>xml11Serializer</name>
                                                    = new
                                                    <call>
                                                        <name>XML11Serializer</name>
                                                        <argument_list>()</argument_list>
                                                    </call>
                                                </expr>
                                                ;
                                            </expr_stmt>
                                            <expr_stmt>
                                                <expr>
                                                    <call>
                                                        <name>initSerializer</name>
                                                        <argument_list>(
                                                            <argument>
                                                                <expr>
                                                                    <name>xml11Serializer</name>
                                                                </expr>
                                                            </argument>
                                                            )
                                                        </argument_list>
                                                    </call>
                                                </expr>
                                                ;
                                            </expr_stmt>
                                            }
                                        </block>
                                    </then>
                                </if>
                                <comment type="line">// copy setting from "main" serializer to XML 1.1 serializer
                                </comment>
                                <expr_stmt>
                                    <expr>
                                        <call>
                                            <name>copySettings</name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name>serializer</name>
                                                    </expr>
                                                </argument>
                                                ,
                                                <argument>
                                                    <expr>
                                                        <name>xml11Serializer</name>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </expr_stmt>
                                <expr_stmt>
                                    <expr>
                                        <name>ser</name>
                                        =
                                        <name>xml11Serializer</name>
                                    </expr>
                                    ;
                                </expr_stmt>
                                }
                            </block>
                        </then>
                        <else>else
                            <block>{
                                <expr_stmt>
                                    <expr>
                                        <name>ser</name>
                                        =
                                        <name>serializer</name>
                                    </expr>
                                    ;
                                </expr_stmt>
                                }
                            </block>
                        </else>
                    </if>

                    <decl_stmt>
                        <decl>
                            <type>
                                <name>StringWriter</name>
                            </type>
                            <name>destination</name> =
                            <init>
                                <expr>new
                                    <call>
                                        <name>StringWriter</name>
                                        <argument_list>()</argument_list>
                                    </call>
                                </expr>
                            </init>
                        </decl>
                        ;
                    </decl_stmt>
                    <try>try
                        <block>{
                            <expr_stmt>
                                <expr>
                                    <call>
                                        <name>prepareForSerialization</name>
                                        <argument_list>(
                                            <argument>
                                                <expr>
                                                    <name>ser</name>
                                                </expr>
                                            </argument>
                                            ,
                                            <argument>
                                                <expr>
                                                    <name>wnode</name>
                                                </expr>
                                            </argument>
                                            )
                                        </argument_list>
                                    </call>
                                </expr>
                                ;
                            </expr_stmt>
                            <expr_stmt>
                                <expr>
                                    <call>
                                        <name><name>ser</name>.<name>_format</name>.
                                            <name>setEncoding</name>
                                        </name>
                                        <argument_list>(
                                            <argument>
                                                <expr>"UTF-16"</expr>
                                            </argument>
                                            )
                                        </argument_list>
                                    </call>
                                </expr>
                                ;
                            </expr_stmt>
                            <expr_stmt>
                                <expr>
                                    <call>
                                        <name><name>ser</name>.
                                            <name>setOutputCharStream</name>
                                        </name>
                                        <argument_list>(
                                            <argument>
                                                <expr>
                                                    <name>destination</name>
                                                </expr>
                                            </argument>
                                            )
                                        </argument_list>
                                    </call>
                                </expr>
                                ;
                            </expr_stmt>
                            <if>if
                                <condition>(
                                    <expr>
                                        <call>
                                            <name><name>wnode</name>.
                                                <name>getNodeType</name>
                                            </name>
                                            <argument_list>()</argument_list>
                                        </call>
                                        ==
                                        <name><name>Node</name>.
                                            <name>DOCUMENT_NODE</name>
                                        </name>
                                    </expr>
                                    )
                                </condition>
                                <then>
                                    <block>{
                                        <expr_stmt>
                                            <expr>
                                                <call>
                                                    <name><name>ser</name>.
                                                        <name>serialize</name>
                                                    </name>
                                                    <argument_list>(
                                                        <argument>
                                                            <expr>(<name>Document</name>)
                                                                <name>wnode</name>
                                                            </expr>
                                                        </argument>
                                                        )
                                                    </argument_list>
                                                </call>
                                            </expr>
                                            ;
                                        </expr_stmt>
                                        }
                                    </block>
                                </then>
                                <else>else
                                    <if>if
                                        <condition>(
                                            <expr>
                                                <call>
                                                    <name><name>wnode</name>.
                                                        <name>getNodeType</name>
                                                    </name>
                                                    <argument_list>()</argument_list>
                                                </call>
                                                ==
                                                <name><name>Node</name>.
                                                    <name>DOCUMENT_FRAGMENT_NODE</name>
                                                </name>
                                            </expr>
                                            )
                                        </condition>
                                        <then>
                                            <block>{
                                                <expr_stmt>
                                                    <expr>
                                                        <call>
                                                            <name><name>ser</name>.
                                                                <name>serialize</name>
                                                            </name>
                                                            <argument_list>(
                                                                <argument>
                                                                    <expr>(<name>DocumentFragment</name>)
                                                                        <name>wnode</name>
                                                                    </expr>
                                                                </argument>
                                                                )
                                                            </argument_list>
                                                        </call>
                                                    </expr>
                                                    ;
                                                </expr_stmt>
                                                }
                                            </block>
                                        </then>
                                        <else>else
                                            <if>if
                                                <condition>(
                                                    <expr>
                                                        <call>
                                                            <name><name>wnode</name>.
                                                                <name>getNodeType</name>
                                                            </name>
                                                            <argument_list>()</argument_list>
                                                        </call>
                                                        ==
                                                        <name><name>Node</name>.
                                                            <name>ELEMENT_NODE</name>
                                                        </name>
                                                    </expr>
                                                    )
                                                </condition>
                                                <then>
                                                    <block>{
                                                        <expr_stmt>
                                                            <expr>
                                                                <call>
                                                                    <name><name>ser</name>.
                                                                        <name>serialize</name>
                                                                    </name>
                                                                    <argument_list>(
                                                                        <argument>
                                                                            <expr>(<name>Element</name>)
                                                                                <name>wnode</name>
                                                                            </expr>
                                                                        </argument>
                                                                        )
                                                                    </argument_list>
                                                                </call>
                                                            </expr>
                                                            ;
                                                        </expr_stmt>
                                                        }
                                                    </block>
                                                </then>
                                                <else>else
                                                    <block>{
                                                        <decl_stmt>
                                                            <decl>
                                                                <type>
                                                                    <name>String</name>
                                                                </type>
                                                                <name>msg</name> =
                                                                <init>
                                                                    <expr>
                                                                        <call>
                                                                            <name><name>DOMMessageFormatter</name>.
                                                                                <name>formatMessage</name>
                                                                            </name>
                                                                            <argument_list>(
                                                                                <argument>
                                                                                    <expr>
                                                                                        <name><name>
                                                                                            DOMMessageFormatter</name>.
                                                                                            <name>SERIALIZER_DOMAIN
                                                                                            </name>
                                                                                        </name>
                                                                                    </expr>
                                                                                </argument>
                                                                                ,
                                                                                <argument>
                                                                                    <expr>"unable-to-serialize-node"
                                                                                    </expr>
                                                                                </argument>
                                                                                ,
                                                                                <argument>
                                                                                    <expr>
                                                                                        <name>null</name>
                                                                                    </expr>
                                                                                </argument>
                                                                                )
                                                                            </argument_list>
                                                                        </call>
                                                                    </expr>
                                                                </init>
                                                            </decl>
                                                            ;
                                                        </decl_stmt>
                                                        <if>if
                                                            <condition>(
                                                                <expr>
                                                                    <name><name>ser</name>.
                                                                        <name>fDOMErrorHandler</name>
                                                                    </name>
                                                                    !=
                                                                    <name>null</name>
                                                                </expr>
                                                                )
                                                            </condition>
                                                            <then>
                                                                <block>{
                                                                    <decl_stmt>
                                                                        <decl>
                                                                            <type>
                                                                                <name>DOMErrorImpl</name>
                                                                            </type>
                                                                            <name>error</name> =
                                                                            <init>
                                                                                <expr>new
                                                                                    <call>
                                                                                        <name>DOMErrorImpl</name>
                                                                                        <argument_list>()
                                                                                        </argument_list>
                                                                                    </call>
                                                                                </expr>
                                                                            </init>
                                                                        </decl>
                                                                        ;
                                                                    </decl_stmt>
                                                                    <expr_stmt>
                                                                        <expr>
                                                                            <name><name>error</name>.
                                                                                <name>fType</name>
                                                                            </name>
                                                                            = "unable-to-serialize-node"
                                                                        </expr>
                                                                        ;
                                                                    </expr_stmt>
                                                                    <expr_stmt>
                                                                        <expr>
                                                                            <name><name>error</name>.
                                                                                <name>fMessage</name>
                                                                            </name>
                                                                            =
                                                                            <name>msg</name>
                                                                        </expr>
                                                                        ;
                                                                    </expr_stmt>
                                                                    <expr_stmt>
                                                                        <expr>
                                                                            <name><name>error</name>.
                                                                                <name>fSeverity</name>
                                                                            </name>
                                                                            =
                                                                            <name><name>DOMError</name>.
                                                                                <name>SEVERITY_FATAL_ERROR</name>
                                                                            </name>
                                                                        </expr>
                                                                        ;
                                                                    </expr_stmt>
                                                                    <expr_stmt>
                                                                        <expr>
                                                                            <call>
                                                                                <name><name>ser</name>.<name>
                                                                                    fDOMErrorHandler</name>.
                                                                                    <name>handleError</name>
                                                                                </name>
                                                                                <argument_list>(
                                                                                    <argument>
                                                                                        <expr>
                                                                                            <name>error</name>
                                                                                        </expr>
                                                                                    </argument>
                                                                                    )
                                                                                </argument_list>
                                                                            </call>
                                                                        </expr>
                                                                        ;
                                                                    </expr_stmt>
                                                                    }
                                                                </block>
                                                            </then>
                                                        </if>
                                                        <throw>throw
                                                            <expr>new
                                                                <call>
                                                                    <name>LSException</name>
                                                                    <argument_list>(
                                                                        <argument>
                                                                            <expr>
                                                                                <name><name>LSException</name>.
                                                                                    <name>SERIALIZE_ERR</name>
                                                                                </name>
                                                                            </expr>
                                                                        </argument>
                                                                        ,
                                                                        <argument>
                                                                            <expr>
                                                                                <name>msg</name>
                                                                            </expr>
                                                                        </argument>
                                                                        )
                                                                    </argument_list>
                                                                </call>
                                                            </expr>
                                                            ;
                                                        </throw>
                                                        }
                                                    </block>
                                                </else>
                                            </if>
                                        </else>
                                    </if>
                                </else>
                            </if>
                            }
                        </block>
                        <catch>catch (
                            <param>
                                <decl>
                                    <type>
                                        <name>LSException</name>
                                    </type>
                                    <name>lse</name>
                                </decl>
                            </param>
                            )
                            <block>{
                                <comment type="line">// Rethrow LSException.</comment>
                                <throw>throw
                                    <expr>
                                        <name>lse</name>
                                    </expr>
                                    ;
                                </throw>
                                }
                            </block>
                        </catch>
                        <catch>catch (
                            <param>
                                <decl>
                                    <type>
                                        <name>RuntimeException</name>
                                    </type>
                                    <name>e</name>
                                </decl>
                            </param>
                            )
                            <block>{
                                <if>if
                                    <condition>(
                                        <expr>
                                            <name>e</name>
                                            ==
                                            <name><name>DOMNormalizer</name>.
                                                <name>abort</name>
                                            </name>
                                        </expr>
                                        )
                                    </condition>
                                    <then>
                                        <block>{
                                            <comment type="line">// stopped at user request</comment>
                                            <return>return
                                                <expr>
                                                    <name>null</name>
                                                </expr>
                                                ;
                                            </return>
                                            }
                                        </block>
                                    </then>
                                </if>
                                <throw>throw
                                    <expr>new
                                        <call>
                                            <name>LSException</name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>LSException</name>.
                                                            <name>SERIALIZE_ERR</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                ,
                                                <argument>
                                                    <expr>
                                                        <call>
                                                            <name><name>e</name>.
                                                                <name>toString</name>
                                                            </name>
                                                            <argument_list>()</argument_list>
                                                        </call>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </throw>
                                }
                            </block>
                        </catch>
                        <catch>catch (
                            <param>
                                <decl>
                                    <type>
                                        <name>IOException</name>
                                    </type>
                                    <name>ioe</name>
                                </decl>
                            </param>
                            )
                            <block>{
                                <comment type="line">// REVISIT: A generic IOException doesn't provide enough
                                    information
                                </comment>
                                <comment type="line">// to determine that the serialized document is too large to fit
                                </comment>
                                <comment type="line">// into a string. This could have thrown for some other reason. --
                                    mrglavas
                                </comment>
                                <decl_stmt>
                                    <decl>
                                        <type>
                                            <name>String</name>
                                        </type>
                                        <name>msg</name> =
                                        <init>
                                            <expr>
                                                <call>
                                                    <name><name>DOMMessageFormatter</name>.
                                                        <name>formatMessage</name>
                                                    </name>
                                                    <argument_list>(
                                                        <argument>
                                                            <expr>
                                                                <name><name>DOMMessageFormatter</name>.
                                                                    <name>DOM_DOMAIN</name>
                                                                </name>
                                                            </expr>
                                                        </argument>
                                                        ,
                                                        <argument>
                                                            <expr>"STRING_TOO_LONG"</expr>
                                                        </argument>
                                                        ,
                                                        <argument>
                                                            <expr>new
                                                                <name>
                                                                    <name>Object</name>
                                                                    <index>[]</index>
                                                                </name>
                                                                <block>{
                                                                    <expr>
                                                                        <call>
                                                                            <name><name>ioe</name>.
                                                                                <name>getMessage</name>
                                                                            </name>
                                                                            <argument_list>()</argument_list>
                                                                        </call>
                                                                    </expr>
                                                                    }
                                                                </block>
                                                            </expr>
                                                        </argument>
                                                        )
                                                    </argument_list>
                                                </call>
                                            </expr>
                                        </init>
                                    </decl>
                                    ;
                                </decl_stmt>
                                <throw>throw
                                    <expr>new
                                        <call>
                                            <name>DOMException</name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>DOMException</name>.
                                                            <name>DOMSTRING_SIZE_ERR</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                ,
                                                <argument>
                                                    <expr>
                                                        <name>msg</name>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </throw>
                                }
                            </block>
                        </catch>
                    </try>
                    <return>return
                        <expr>
                            <call>
                                <name><name>destination</name>.
                                    <name>toString</name>
                                </name>
                                <argument_list>()</argument_list>
                            </call>
                        </expr>
                        ;
                    </return>
                    }
                </block>
            </function>

            <comment type="javadoc">/**
                * DOM L3 EXPERIMENTAL:
                * The end-of-line sequence of characters to be used in the XML being
                * written out. The only permitted values are these:
                * &lt;dl&gt;
                * &lt;dt&gt;&lt;code&gt;null&lt;/code&gt;&lt;/dt&gt;
                * &lt;dd&gt;
                * Use a default end-of-line sequence. DOM implementations should choose
                * the default to match the usual convention for text files in the
                * environment being used. Implementations must choose a default
                * sequence that matches one of those allowed by 2.11 "End-of-Line
                * Handling". &lt;/dd&gt;
                * &lt;dt&gt;CR&lt;/dt&gt;
                * &lt;dd&gt;The carriage-return character (#xD).&lt;/dd&gt;
                * &lt;dt&gt;CR-LF&lt;/dt&gt;
                * &lt;dd&gt; The
                * carriage-return and line-feed characters (#xD #xA). &lt;/dd&gt;
                * &lt;dt&gt;LF&lt;/dt&gt;
                * &lt;dd&gt; The line-feed
                * character (#xA). &lt;/dd&gt;
                * &lt;/dl&gt;
                * &lt;br&gt;The default value for this attribute is &lt;code&gt;null&lt;/code&gt;.
                */
            </comment>
            <function>
                <type>
                    <specifier>public</specifier>
                    <name>void</name>
                </type>
                <name>setNewLine</name>
                <parameter_list>(
                    <param>
                        <decl>
                            <type>
                                <name>String</name>
                            </type>
                            <name>newLine</name>
                        </decl>
                    </param>
                    )
                </parameter_list>
                <block>{
                    <expr_stmt>
                        <expr>
                            <call>
                                <name><name>serializer</name>.<name>_format</name>.
                                    <name>setLineSeparator</name>
                                </name>
                                <argument_list>(
                                    <argument>
                                        <expr>
                                            <name>newLine</name>
                                        </expr>
                                    </argument>
                                    )
                                </argument_list>
                            </call>
                        </expr>
                        ;
                    </expr_stmt>
                    }
                </block>
            </function>


            <comment type="javadoc">/**
                * DOM L3 EXPERIMENTAL:
                * The end-of-line sequence of characters to be used in the XML being
                * written out. The only permitted values are these:
                * &lt;dl&gt;
                * &lt;dt&gt;&lt;code&gt;null&lt;/code&gt;&lt;/dt&gt;
                * &lt;dd&gt;
                * Use a default end-of-line sequence. DOM implementations should choose
                * the default to match the usual convention for text files in the
                * environment being used. Implementations must choose a default
                * sequence that matches one of those allowed by 2.11 "End-of-Line
                * Handling". &lt;/dd&gt;
                * &lt;dt&gt;CR&lt;/dt&gt;
                * &lt;dd&gt;The carriage-return character (#xD).&lt;/dd&gt;
                * &lt;dt&gt;CR-LF&lt;/dt&gt;
                * &lt;dd&gt; The
                * carriage-return and line-feed characters (#xD #xA). &lt;/dd&gt;
                * &lt;dt&gt;LF&lt;/dt&gt;
                * &lt;dd&gt; The line-feed
                * character (#xA). &lt;/dd&gt;
                * &lt;/dl&gt;
                * &lt;br&gt;The default value for this attribute is &lt;code&gt;null&lt;/code&gt;.
                */
            </comment>
            <function>
                <type>
                    <specifier>public</specifier>
                    <name>String</name>
                </type>
                <name>getNewLine</name>
                <parameter_list>()</parameter_list>
                <block>{
                    <return>return
                        <expr>
                            <call>
                                <name><name>serializer</name>.<name>_format</name>.
                                    <name>getLineSeparator</name>
                                </name>
                                <argument_list>()</argument_list>
                            </call>
                        </expr>
                        ;
                    </return>
                    }
                </block>
            </function>


            <comment type="javadoc">/**
                * When the application provides a filter, the serializer will call out
                * to the filter before serializing each Node. Attribute nodes are never
                * passed to the filter. The filter implementation can choose to remove
                * the node from the stream or to terminate the serialization early.
                */
            </comment>
            <function>
                <type>
                    <specifier>public</specifier>
                    <name>LSSerializerFilter</name>
                </type>
                <name>getFilter</name>
                <parameter_list>()</parameter_list>
                <block>{
                    <return>return
                        <expr>
                            <name><name>serializer</name>.
                                <name>fDOMFilter</name>
                            </name>
                        </expr>
                        ;
                    </return>
                    }
                </block>
            </function>
            <comment type="javadoc">/**
                * When the application provides a filter, the serializer will call out
                * to the filter before serializing each Node. Attribute nodes are never
                * passed to the filter. The filter implementation can choose to remove
                * the node from the stream or to terminate the serialization early.
                */
            </comment>
            <function>
                <type>
                    <specifier>public</specifier>
                    <name>void</name>
                </type>
                <name>setFilter</name>
                <parameter_list>(
                    <param>
                        <decl>
                            <type>
                                <name>LSSerializerFilter</name>
                            </type>
                            <name>filter</name>
                        </decl>
                    </param>
                    )
                </parameter_list>
                <block>{
                    <expr_stmt>
                        <expr>
                            <name><name>serializer</name>.
                                <name>fDOMFilter</name>
                            </name>
                            =
                            <name>filter</name>
                        </expr>
                        ;
                    </expr_stmt>
                    }
                </block>
            </function>

            <comment type="line">// this initializes a newly-created serializer</comment>
            <function>
                <type>
                    <specifier>private</specifier>
                    <name>void</name>
                </type>
                <name>initSerializer</name>
                <parameter_list>(
                    <param>
                        <decl>
                            <type>
                                <name>XMLSerializer</name>
                            </type>
                            <name>ser</name>
                        </decl>
                    </param>
                    )
                </parameter_list>
                <block>{
                    <expr_stmt>
                        <expr>
                            <name><name>ser</name>.
                                <name>fNSBinder</name>
                            </name>
                            = new
                            <call>
                                <name>NamespaceSupport</name>
                                <argument_list>()</argument_list>
                            </call>
                        </expr>
                        ;
                    </expr_stmt>
                    <expr_stmt>
                        <expr>
                            <name><name>ser</name>.
                                <name>fLocalNSBinder</name>
                            </name>
                            = new
                            <call>
                                <name>NamespaceSupport</name>
                                <argument_list>()</argument_list>
                            </call>
                        </expr>
                        ;
                    </expr_stmt>
                    <expr_stmt>
                        <expr>
                            <name><name>ser</name>.
                                <name>fSymbolTable</name>
                            </name>
                            = new
                            <call>
                                <name>SymbolTable</name>
                                <argument_list>()</argument_list>
                            </call>
                        </expr>
                        ;
                    </expr_stmt>
                    }
                </block>
            </function>

            <comment type="line">// copies all settings that could have been modified</comment>
            <comment type="line">// by calls to LSSerializer methods from one serializer to another.</comment>
            <comment type="line">// IMPORTANT: if new methods are implemented or more settings of</comment>
            <comment type="line">// the serializer are made alterable, this must be</comment>
            <comment type="line">// reflected in this method!</comment>
            <function>
                <type>
                    <specifier>private</specifier>
                    <name>void</name>
                </type>
                <name>copySettings</name>
                <parameter_list>(
                    <param>
                        <decl>
                            <type>
                                <name>XMLSerializer</name>
                            </type>
                            <name>src</name>
                        </decl>
                    </param>
                    ,
                    <param>
                        <decl>
                            <type>
                                <name>XMLSerializer</name>
                            </type>
                            <name>dest</name>
                        </decl>
                    </param>
                    )
                </parameter_list>
                <block>{
                    <expr_stmt>
                        <expr>
                            <name><name>dest</name>.
                                <name>fDOMErrorHandler</name>
                            </name>
                            =
                            <name>fErrorHandler</name>
                        </expr>
                        ;
                    </expr_stmt>
                    <expr_stmt>
                        <expr>
                            <call>
                                <name><name>dest</name>.<name>_format</name>.
                                    <name>setEncoding</name>
                                </name>
                                <argument_list>(
                                    <argument>
                                        <expr>
                                            <call>
                                                <name><name>src</name>.<name>_format</name>.
                                                    <name>getEncoding</name>
                                                </name>
                                                <argument_list>()</argument_list>
                                            </call>
                                        </expr>
                                    </argument>
                                    )
                                </argument_list>
                            </call>
                        </expr>
                        ;
                    </expr_stmt>
                    <expr_stmt>
                        <expr>
                            <call>
                                <name><name>dest</name>.<name>_format</name>.
                                    <name>setLineSeparator</name>
                                </name>
                                <argument_list>(
                                    <argument>
                                        <expr>
                                            <call>
                                                <name><name>src</name>.<name>_format</name>.
                                                    <name>getLineSeparator</name>
                                                </name>
                                                <argument_list>()</argument_list>
                                            </call>
                                        </expr>
                                    </argument>
                                    )
                                </argument_list>
                            </call>
                        </expr>
                        ;
                    </expr_stmt>
                    <expr_stmt>
                        <expr>
                            <name><name>dest</name>.
                                <name>fDOMFilter</name>
                            </name>
                            =
                            <name><name>src</name>.
                                <name>fDOMFilter</name>
                            </name>
                        </expr>
                        ;
                    </expr_stmt>
                    }
                </block>
            </function>
            <comment type="line">//copysettings</comment>

            <comment type="javadoc">/**
                * Serialize the specified node as described above in the general
                * description of the &lt;code&gt;LSSerializer&lt;/code&gt; interface. The output
                * is written to the supplied &lt;code&gt;LSOutput&lt;/code&gt;.
                * &lt;br&gt; When writing to a &lt;code&gt;LSOutput&lt;/code&gt;, the encoding is found by
                * looking at the encoding information that is reachable through the
                * &lt;code&gt;LSOutput&lt;/code&gt; and the item to be written (or its owner
                * document) in this order:
                * &lt;ol&gt;
                * &lt;li&gt; &lt;code&gt;LSOutput.encoding&lt;/code&gt;,
                * &lt;/li&gt;
                * &lt;li&gt;
                * &lt;code&gt;Document.actualEncoding&lt;/code&gt;,
                * &lt;/li&gt;
                * &lt;li&gt;
                * &lt;code&gt;Document.xmlEncoding&lt;/code&gt;.
                * &lt;/li&gt;
                * &lt;/ol&gt;
                * &lt;br&gt; If no encoding is reachable through the above properties, a
                * default encoding of "UTF-8" will be used.
                * &lt;br&gt; If the specified encoding is not supported an
                * "unsupported-encoding" error is raised.
                * &lt;br&gt; If no output is specified in the &lt;code&gt;LSOutput&lt;/code&gt;, a
                * "no-output-specified" error is raised.
                * @param node The node to serialize.
                * @param destination The destination for the serialized DOM.
                * @return Returns &lt;code&gt;true&lt;/code&gt; if &lt;code&gt;node&lt;/code&gt; was
                * successfully serialized and &lt;code&gt;false&lt;/code&gt; in case the node
                * couldn't be serialized.
                */
            </comment>
            <function>
                <type>
                    <specifier>public</specifier>
                    <name>boolean</name>
                </type>
                <name>write</name>
                <parameter_list>(
                    <param>
                        <decl>
                            <type>
                                <name>Node</name>
                            </type>
                            <name>node</name>
                        </decl>
                    </param>
                    ,
                    <param>
                        <decl>
                            <type>
                                <name>LSOutput</name>
                            </type>
                            <name>destination</name>
                        </decl>
                    </param>
                    )
                </parameter_list>
                <throws>throws
                    <argument>
                        <expr>
                            <name>LSException</name>
                        </expr>
                    </argument>
                </throws>
                <block>{

                    <if>if
                        <condition>(
                            <expr>
                                <name>node</name>
                                ==
                                <name>null</name>
                            </expr>
                            )
                        </condition>
                        <then>
                            <return>return <expr>false</expr>;
                            </return>
                        </then>
                    </if>

                    <decl_stmt>
                        <decl>
                            <type>
                                <name>Method</name>
                            </type>
                            <name>getVersion</name> =
                            <init>
                                <expr>
                                    <name>null</name>
                                </expr>
                            </init>
                        </decl>
                        ;
                    </decl_stmt>
                    <decl_stmt>
                        <decl>
                            <type>
                                <name>XMLSerializer</name>
                            </type>
                            <name>ser</name> =
                            <init>
                                <expr>
                                    <name>null</name>
                                </expr>
                            </init>
                        </decl>
                        ;
                    </decl_stmt>
                    <decl_stmt>
                        <decl>
                            <type>
                                <name>String</name>
                            </type>
                            <name>ver</name> =
                            <init>
                                <expr>
                                    <name>null</name>
                                </expr>
                            </init>
                        </decl>
                        ;
                    </decl_stmt>
                    <decl_stmt>
                        <decl>
                            <type>
                                <name>Document</name>
                            </type>
                            <name>fDocument</name> =
                            <init>
                                <expr>(
                                    <call>
                                        <name><name>node</name>.
                                            <name>getNodeType</name>
                                        </name>
                                        <argument_list>()</argument_list>
                                    </call>
                                    ==
                                    <name><name>Node</name>.
                                        <name>DOCUMENT_NODE</name>
                                    </name>
                                    )
                                    ? (<name>Document</name>)
                                    <name>node</name>
                                    :
                                    <call>
                                        <name><name>node</name>.
                                            <name>getOwnerDocument</name>
                                        </name>
                                        <argument_list>()</argument_list>
                                    </call>
                                </expr>
                            </init>
                        </decl>
                        ;
                    </decl_stmt>
                    <comment type="line">// this should run under JDK 1.1.8...</comment>
                    <try>try
                        <block>{
                            <expr_stmt>
                                <expr>
                                    <name>getVersion</name>
                                    =
                                    <call>
                                        <name><name>fDocument</name>.
                                            <name>getClass</name>
                                        </name>
                                        <argument_list>()</argument_list>
                                    </call>
                                    .
                                    <call>
                                        <name>getMethod</name>
                                        <argument_list>(
                                            <argument>
                                                <expr>"getXmlVersion"</expr>
                                            </argument>
                                            ,
                                            <argument>
                                                <expr>new
                                                    <name>
                                                        <name>Class</name>
                                                        <index>[]</index>
                                                    </name>
                                                    <block>{}</block>
                                                </expr>
                                            </argument>
                                            )
                                        </argument_list>
                                    </call>
                                </expr>
                                ;
                            </expr_stmt>
                            <if>if
                                <condition>(
                                    <expr>
                                        <name>getVersion</name>
                                        !=
                                        <name>null</name>
                                    </expr>
                                    )
                                </condition>
                                <then>
                                    <block>{
                                        <expr_stmt>
                                            <expr>
                                                <name>ver</name>
                                                = (<name>String</name>)
                                                <call>
                                                    <name><name>getVersion</name>.
                                                        <name>invoke</name>
                                                    </name>
                                                    <argument_list>(
                                                        <argument>
                                                            <expr>
                                                                <name>fDocument</name>
                                                            </expr>
                                                        </argument>
                                                        ,
                                                        <argument>
                                                            <expr>(
                                                                <name>
                                                                    <name>Object</name>
                                                                    <index>[]</index>
                                                                </name>
                                                                )
                                                                <name>null</name>
                                                            </expr>
                                                        </argument>
                                                        )
                                                    </argument_list>
                                                </call>
                                            </expr>
                                            ;
                                        </expr_stmt>
                                        }
                                    </block>
                                </then>
                            </if>
                            }
                        </block>
                        <catch>catch (
                            <param>
                                <decl>
                                    <type>
                                        <name>Exception</name>
                                    </type>
                                    <name>e</name>
                                </decl>
                            </param>
                            )
                            <block>{
                                <comment type="line">//no way to test the version...</comment>
                                <comment type="line">//ignore the exception</comment>
                                }
                            </block>
                        </catch>
                    </try>
                    <comment type="line">//determine which serializer to use:</comment>
                    <if>if
                        <condition>(
                            <expr>
                                <name>ver</name>
                                != <name>null</name> &amp;&amp;
                                <call>
                                    <name><name>ver</name>.
                                        <name>equals</name>
                                    </name>
                                    <argument_list>(
                                        <argument>
                                            <expr>"1.1"</expr>
                                        </argument>
                                        )
                                    </argument_list>
                                </call>
                            </expr>
                            )
                        </condition>
                        <then>
                            <block>{
                                <if>if
                                    <condition>(
                                        <expr>
                                            <name>xml11Serializer</name>
                                            ==
                                            <name>null</name>
                                        </expr>
                                        )
                                    </condition>
                                    <then>
                                        <block>{
                                            <expr_stmt>
                                                <expr>
                                                    <name>xml11Serializer</name>
                                                    = new
                                                    <call>
                                                        <name>XML11Serializer</name>
                                                        <argument_list>()</argument_list>
                                                    </call>
                                                </expr>
                                                ;
                                            </expr_stmt>
                                            <expr_stmt>
                                                <expr>
                                                    <call>
                                                        <name>initSerializer</name>
                                                        <argument_list>(
                                                            <argument>
                                                                <expr>
                                                                    <name>xml11Serializer</name>
                                                                </expr>
                                                            </argument>
                                                            )
                                                        </argument_list>
                                                    </call>
                                                </expr>
                                                ;
                                            </expr_stmt>
                                            }
                                        </block>
                                    </then>
                                </if>
                                <comment type="line">//copy setting from "main" serializer to XML 1.1 serializer
                                </comment>
                                <expr_stmt>
                                    <expr>
                                        <call>
                                            <name>copySettings</name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name>serializer</name>
                                                    </expr>
                                                </argument>
                                                ,
                                                <argument>
                                                    <expr>
                                                        <name>xml11Serializer</name>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </expr_stmt>
                                <expr_stmt>
                                    <expr>
                                        <name>ser</name>
                                        =
                                        <name>xml11Serializer</name>
                                    </expr>
                                    ;
                                </expr_stmt>
                                }
                            </block>
                        </then>
                        <else>else
                            <block>{
                                <expr_stmt>
                                    <expr>
                                        <name>ser</name>
                                        =
                                        <name>serializer</name>
                                    </expr>
                                    ;
                                </expr_stmt>
                                }
                            </block>
                        </else>
                    </if>

                    <decl_stmt>
                        <decl>
                            <type>
                                <name>String</name>
                            </type>
                            <name>encoding</name> =
                            <init>
                                <expr>
                                    <name>null</name>
                                </expr>
                            </init>
                        </decl>
                        ;
                    </decl_stmt>
                    <if>if
                        <condition>(
                            <expr>(<name>encoding</name> =
                                <call>
                                    <name><name>destination</name>.
                                        <name>getEncoding</name>
                                    </name>
                                    <argument_list>()</argument_list>
                                </call>
                                ) ==
                                <name>null</name>
                            </expr>
                            )
                        </condition>
                        <then>
                            <block>{
                                <try>try
                                    <block>{
                                        <decl_stmt>
                                            <decl>
                                                <type>
                                                    <name>Method</name>
                                                </type>
                                                <name>getEncoding</name> =
                                                <init>
                                                    <expr>
                                                        <call>
                                                            <name><name>fDocument</name>.
                                                                <name>getClass</name>
                                                            </name>
                                                            <argument_list>()</argument_list>
                                                        </call>
                                                        .
                                                        <call>
                                                            <name>getMethod</name>
                                                            <argument_list>(
                                                                <argument>
                                                                    <expr>"getInputEncoding"</expr>
                                                                </argument>
                                                                ,
                                                                <argument>
                                                                    <expr>new
                                                                        <name>
                                                                            <name>Class</name>
                                                                            <index>[]</index>
                                                                        </name>
                                                                        <block>{}</block>
                                                                    </expr>
                                                                </argument>
                                                                )
                                                            </argument_list>
                                                        </call>
                                                    </expr>
                                                </init>
                                            </decl>
                                            ;
                                        </decl_stmt>
                                        <if>if
                                            <condition>(
                                                <expr>
                                                    <name>getEncoding</name>
                                                    !=
                                                    <name>null</name>
                                                </expr>
                                                )
                                            </condition>
                                            <then>
                                                <block>{
                                                    <expr_stmt>
                                                        <expr>
                                                            <name>encoding</name>
                                                            = (<name>String</name>)
                                                            <call>
                                                                <name><name>getEncoding</name>.
                                                                    <name>invoke</name>
                                                                </name>
                                                                <argument_list>(
                                                                    <argument>
                                                                        <expr>
                                                                            <name>fDocument</name>
                                                                        </expr>
                                                                    </argument>
                                                                    ,
                                                                    <argument>
                                                                        <expr>(
                                                                            <name>
                                                                                <name>Object</name>
                                                                                <index>[]</index>
                                                                            </name>
                                                                            )
                                                                            <name>null</name>
                                                                        </expr>
                                                                    </argument>
                                                                    )
                                                                </argument_list>
                                                            </call>
                                                        </expr>
                                                        ;
                                                    </expr_stmt>
                                                    }
                                                </block>
                                            </then>
                                        </if>
                                        }
                                    </block>
                                    <catch>catch (
                                        <param>
                                            <decl>
                                                <type>
                                                    <name>Exception</name>
                                                </type>
                                                <name>e</name>
                                            </decl>
                                        </param>
                                        )
                                        <block>{
                                            <comment type="line">// ignore the exception</comment>
                                            }
                                        </block>
                                    </catch>
                                </try>
                                <if>if
                                    <condition>(
                                        <expr>
                                            <name>encoding</name>
                                            ==
                                            <name>null</name>
                                        </expr>
                                        )
                                    </condition>
                                    <then>
                                        <block>{
                                            <try>try
                                                <block>{
                                                    <decl_stmt>
                                                        <decl>
                                                            <type>
                                                                <name>Method</name>
                                                            </type>
                                                            <name>getEncoding</name> =
                                                            <init>
                                                                <expr>
                                                                    <call>
                                                                        <name><name>fDocument</name>.
                                                                            <name>getClass</name>
                                                                        </name>
                                                                        <argument_list>()</argument_list>
                                                                    </call>
                                                                    .
                                                                    <call>
                                                                        <name>getMethod</name>
                                                                        <argument_list>(
                                                                            <argument>
                                                                                <expr>"getXmlEncoding"</expr>
                                                                            </argument>
                                                                            ,
                                                                            <argument>
                                                                                <expr>new
                                                                                    <name>
                                                                                        <name>Class</name>
                                                                                        <index>[]</index>
                                                                                    </name>
                                                                                    <block>{}</block>
                                                                                </expr>
                                                                            </argument>
                                                                            )
                                                                        </argument_list>
                                                                    </call>
                                                                </expr>
                                                            </init>
                                                        </decl>
                                                        ;
                                                    </decl_stmt>
                                                    <if>if
                                                        <condition>(
                                                            <expr>
                                                                <name>getEncoding</name>
                                                                !=
                                                                <name>null</name>
                                                            </expr>
                                                            )
                                                        </condition>
                                                        <then>
                                                            <block>{
                                                                <expr_stmt>
                                                                    <expr>
                                                                        <name>encoding</name>
                                                                        = (<name>String</name>)
                                                                        <call>
                                                                            <name><name>getEncoding</name>.
                                                                                <name>invoke</name>
                                                                            </name>
                                                                            <argument_list>(
                                                                                <argument>
                                                                                    <expr>
                                                                                        <name>fDocument</name>
                                                                                    </expr>
                                                                                </argument>
                                                                                ,
                                                                                <argument>
                                                                                    <expr>(
                                                                                        <name>
                                                                                            <name>Object</name>
                                                                                            <index>[]</index>
                                                                                        </name>
                                                                                        )
                                                                                        <name>null</name>
                                                                                    </expr>
                                                                                </argument>
                                                                                )
                                                                            </argument_list>
                                                                        </call>
                                                                    </expr>
                                                                    ;
                                                                </expr_stmt>
                                                                }
                                                            </block>
                                                        </then>
                                                    </if>
                                                    }
                                                </block>
                                                <catch>catch (
                                                    <param>
                                                        <decl>
                                                            <type>
                                                                <name>Exception</name>
                                                            </type>
                                                            <name>e</name>
                                                        </decl>
                                                    </param>
                                                    )
                                                    <block>{
                                                        <comment type="line">// ignore the exception</comment>
                                                        }
                                                    </block>
                                                </catch>
                                            </try>
                                            <if>if
                                                <condition>(
                                                    <expr>
                                                        <name>encoding</name>
                                                        ==
                                                        <name>null</name>
                                                    </expr>
                                                    )
                                                </condition>
                                                <then>
                                                    <block>{
                                                        <expr_stmt>
                                                            <expr>
                                                                <name>encoding</name>
                                                                = "UTF-8"
                                                            </expr>
                                                            ;
                                                        </expr_stmt>
                                                        }
                                                    </block>
                                                </then>
                                            </if>
                                            }
                                        </block>
                                    </then>
                                </if>
                                }
                            </block>
                        </then>
                    </if>
                    <try>try
                        <block>{
                            <expr_stmt>
                                <expr>
                                    <call>
                                        <name>prepareForSerialization</name>
                                        <argument_list>(
                                            <argument>
                                                <expr>
                                                    <name>ser</name>
                                                </expr>
                                            </argument>
                                            ,
                                            <argument>
                                                <expr>
                                                    <name>node</name>
                                                </expr>
                                            </argument>
                                            )
                                        </argument_list>
                                    </call>
                                </expr>
                                ;
                            </expr_stmt>
                            <expr_stmt>
                                <expr>
                                    <call>
                                        <name><name>ser</name>.<name>_format</name>.
                                            <name>setEncoding</name>
                                        </name>
                                        <argument_list>(
                                            <argument>
                                                <expr>
                                                    <name>encoding</name>
                                                </expr>
                                            </argument>
                                            )
                                        </argument_list>
                                    </call>
                                </expr>
                                ;
                            </expr_stmt>
                            <decl_stmt>
                                <decl>
                                    <type>
                                        <name>OutputStream</name>
                                    </type>
                                    <name>outputStream</name> =
                                    <init>
                                        <expr>
                                            <call>
                                                <name><name>destination</name>.
                                                    <name>getByteStream</name>
                                                </name>
                                                <argument_list>()</argument_list>
                                            </call>
                                        </expr>
                                    </init>
                                </decl>
                                ;
                            </decl_stmt>
                            <decl_stmt>
                                <decl>
                                    <type>
                                        <name>Writer</name>
                                    </type>
                                    <name>writer</name> =
                                    <init>
                                        <expr>
                                            <call>
                                                <name><name>destination</name>.
                                                    <name>getCharacterStream</name>
                                                </name>
                                                <argument_list>()</argument_list>
                                            </call>
                                        </expr>
                                    </init>
                                </decl>
                                ;
                            </decl_stmt>
                            <decl_stmt>
                                <decl>
                                    <type>
                                        <name>String</name>
                                    </type>
                                    <name>uri</name> =
                                    <init>
                                        <expr>
                                            <call>
                                                <name><name>destination</name>.
                                                    <name>getSystemId</name>
                                                </name>
                                                <argument_list>()</argument_list>
                                            </call>
                                        </expr>
                                    </init>
                                </decl>
                                ;
                            </decl_stmt>
                            <if>if
                                <condition>(
                                    <expr>
                                        <name>writer</name>
                                        ==
                                        <name>null</name>
                                    </expr>
                                    )
                                </condition>
                                <then>
                                    <block>{
                                        <if>if
                                            <condition>(
                                                <expr>
                                                    <name>outputStream</name>
                                                    ==
                                                    <name>null</name>
                                                </expr>
                                                )
                                            </condition>
                                            <then>
                                                <block>{
                                                    <if>if
                                                        <condition>(
                                                            <expr>
                                                                <name>uri</name>
                                                                ==
                                                                <name>null</name>
                                                            </expr>
                                                            )
                                                        </condition>
                                                        <then>
                                                            <block>{
                                                                <decl_stmt>
                                                                    <decl>
                                                                        <type>
                                                                            <name>String</name>
                                                                        </type>
                                                                        <name>msg</name> =
                                                                        <init>
                                                                            <expr>
                                                                                <call>
                                                                                    <name><name>
                                                                                        DOMMessageFormatter</name>.
                                                                                        <name>formatMessage</name>
                                                                                    </name>
                                                                                    <argument_list>(
                                                                                        <argument>
                                                                                            <expr>
                                                                                                <name><name>
                                                                                                    DOMMessageFormatter</name>
                                                                                                    .
                                                                                                    <name>
                                                                                                        SERIALIZER_DOMAIN
                                                                                                    </name>
                                                                                                </name>
                                                                                            </expr>
                                                                                        </argument>
                                                                                        ,
                                                                                        <argument>
                                                                                            <expr>
                                                                                                "no-output-specified"
                                                                                            </expr>
                                                                                        </argument>
                                                                                        ,
                                                                                        <argument>
                                                                                            <expr>
                                                                                                <name>null</name>
                                                                                            </expr>
                                                                                        </argument>
                                                                                        )
                                                                                    </argument_list>
                                                                                </call>
                                                                            </expr>
                                                                        </init>
                                                                    </decl>
                                                                    ;
                                                                </decl_stmt>
                                                                <if>if
                                                                    <condition>(
                                                                        <expr>
                                                                            <name><name>ser</name>.
                                                                                <name>fDOMErrorHandler</name>
                                                                            </name>
                                                                            !=
                                                                            <name>null</name>
                                                                        </expr>
                                                                        )
                                                                    </condition>
                                                                    <then>
                                                                        <block>{
                                                                            <decl_stmt>
                                                                                <decl>
                                                                                    <type>
                                                                                        <name>DOMErrorImpl</name>
                                                                                    </type>
                                                                                    <name>error</name> =
                                                                                    <init>
                                                                                        <expr>new
                                                                                            <call>
                                                                                                <name>DOMErrorImpl
                                                                                                </name>
                                                                                                <argument_list>()
                                                                                                </argument_list>
                                                                                            </call>
                                                                                        </expr>
                                                                                    </init>
                                                                                </decl>
                                                                                ;
                                                                            </decl_stmt>
                                                                            <expr_stmt>
                                                                                <expr>
                                                                                    <name><name>error</name>.
                                                                                        <name>fType</name>
                                                                                    </name>
                                                                                    = "no-output-specified"
                                                                                </expr>
                                                                                ;
                                                                            </expr_stmt>
                                                                            <expr_stmt>
                                                                                <expr>
                                                                                    <name><name>error</name>.
                                                                                        <name>fMessage</name>
                                                                                    </name>
                                                                                    =
                                                                                    <name>msg</name>
                                                                                </expr>
                                                                                ;
                                                                            </expr_stmt>
                                                                            <expr_stmt>
                                                                                <expr>
                                                                                    <name><name>error</name>.
                                                                                        <name>fSeverity</name>
                                                                                    </name>
                                                                                    =
                                                                                    <name><name>DOMError</name>.
                                                                                        <name>SEVERITY_FATAL_ERROR
                                                                                        </name>
                                                                                    </name>
                                                                                </expr>
                                                                                ;
                                                                            </expr_stmt>
                                                                            <expr_stmt>
                                                                                <expr>
                                                                                    <call>
                                                                                        <name><name>ser</name>.<name>
                                                                                            fDOMErrorHandler</name>.
                                                                                            <name>handleError</name>
                                                                                        </name>
                                                                                        <argument_list>(
                                                                                            <argument>
                                                                                                <expr>
                                                                                                    <name>error</name>
                                                                                                </expr>
                                                                                            </argument>
                                                                                            )
                                                                                        </argument_list>
                                                                                    </call>
                                                                                </expr>
                                                                                ;
                                                                            </expr_stmt>
                                                                            }
                                                                        </block>
                                                                    </then>
                                                                </if>
                                                                <throw>throw
                                                                    <expr>new
                                                                        <call>
                                                                            <name>LSException</name>
                                                                            <argument_list>(
                                                                                <argument>
                                                                                    <expr>
                                                                                        <name><name>LSException</name>.
                                                                                            <name>SERIALIZE_ERR</name>
                                                                                        </name>
                                                                                    </expr>
                                                                                </argument>
                                                                                ,
                                                                                <argument>
                                                                                    <expr>
                                                                                        <name>msg</name>
                                                                                    </expr>
                                                                                </argument>
                                                                                )
                                                                            </argument_list>
                                                                        </call>
                                                                    </expr>
                                                                    ;
                                                                </throw>
                                                                }
                                                            </block>
                                                        </then>
                                                        <else>else
                                                            <block>{
                                                                <comment type="line">// URI was specified. Handle
                                                                    relative URIs.
                                                                </comment>
                                                                <decl_stmt>
                                                                    <decl>
                                                                        <type>
                                                                            <name>String</name>
                                                                        </type>
                                                                        <name>expanded</name> =
                                                                        <init>
                                                                            <expr>
                                                                                <call>
                                                                                    <name><name>XMLEntityManager</name>.
                                                                                        <name>expandSystemId</name>
                                                                                    </name>
                                                                                    <argument_list>(
                                                                                        <argument>
                                                                                            <expr>
                                                                                                <name>uri</name>
                                                                                            </expr>
                                                                                        </argument>
                                                                                        ,
                                                                                        <argument>
                                                                                            <expr>
                                                                                                <name>null</name>
                                                                                            </expr>
                                                                                        </argument>
                                                                                        ,
                                                                                        <argument>
                                                                                            <expr>true</expr>
                                                                                        </argument>
                                                                                        )
                                                                                    </argument_list>
                                                                                </call>
                                                                            </expr>
                                                                        </init>
                                                                    </decl>
                                                                    ;
                                                                </decl_stmt>
                                                                <decl_stmt>
                                                                    <decl>
                                                                        <type>
                                                                            <name>URL</name>
                                                                        </type>
                                                                        <name>url</name> =
                                                                        <init>
                                                                            <expr>new
                                                                                <call>
                                                                                    <name>URL</name>
                                                                                    <argument_list>(
                                                                                        <argument>
                                                                                            <expr>
                                                                                                <name>expanded</name>
                                                                                                != <name>null</name> ? <name>
                                                                                                expanded
                                                                                            </name> :
                                                                                                <name>uri</name>
                                                                                            </expr>
                                                                                        </argument>
                                                                                        )
                                                                                    </argument_list>
                                                                                </call>
                                                                            </expr>
                                                                        </init>
                                                                    </decl>
                                                                    ;
                                                                </decl_stmt>
                                                                <decl_stmt>
                                                                    <decl>
                                                                        <type>
                                                                            <name>OutputStream</name>
                                                                        </type>
                                                                        <name>out</name> =
                                                                        <init>
                                                                            <expr>
                                                                                <name>null</name>
                                                                            </expr>
                                                                        </init>
                                                                    </decl>
                                                                    ;
                                                                </decl_stmt>
                                                                <decl_stmt>
                                                                    <decl>
                                                                        <type>
                                                                            <name>String</name>
                                                                        </type>
                                                                        <name>protocol</name> =
                                                                        <init>
                                                                            <expr>
                                                                                <call>
                                                                                    <name><name>url</name>.
                                                                                        <name>getProtocol</name>
                                                                                    </name>
                                                                                    <argument_list>()</argument_list>
                                                                                </call>
                                                                            </expr>
                                                                        </init>
                                                                    </decl>
                                                                    ;
                                                                </decl_stmt>
                                                                <decl_stmt>
                                                                    <decl>
                                                                        <type>
                                                                            <name>String</name>
                                                                        </type>
                                                                        <name>host</name> =
                                                                        <init>
                                                                            <expr>
                                                                                <call>
                                                                                    <name><name>url</name>.
                                                                                        <name>getHost</name>
                                                                                    </name>
                                                                                    <argument_list>()</argument_list>
                                                                                </call>
                                                                            </expr>
                                                                        </init>
                                                                    </decl>
                                                                    ;
                                                                </decl_stmt>
                                                                <comment type="line">// Use FileOutputStream if this URI
                                                                    is for a local file.
                                                                </comment>
                                                                <if>if
                                                                    <condition>(
                                                                        <expr>
                                                                            <call>
                                                                                <name><name>protocol</name>.
                                                                                    <name>equals</name>
                                                                                </name>
                                                                                <argument_list>(
                                                                                    <argument>
                                                                                        <expr>"file"</expr>
                                                                                    </argument>
                                                                                    )
                                                                                </argument_list>
                                                                            </call>
                                                                            &amp;&amp; (<name>host</name> == <name>
                                                                            null
                                                                        </name> ||
                                                                            <call>
                                                                                <name><name>host</name>.
                                                                                    <name>length</name>
                                                                                </name>
                                                                                <argument_list>()</argument_list>
                                                                            </call>
                                                                            == 0 ||
                                                                            <call>
                                                                                <name><name>host</name>.
                                                                                    <name>equals</name>
                                                                                </name>
                                                                                <argument_list>(
                                                                                    <argument>
                                                                                        <expr>"localhost"</expr>
                                                                                    </argument>
                                                                                    )
                                                                                </argument_list>
                                                                            </call>
                                                                            )
                                                                        </expr>
                                                                        )
                                                                    </condition>
                                                                    <then>
                                                                        <block>{
                                                                            <expr_stmt>
                                                                                <expr>
                                                                                    <name>out</name>
                                                                                    = new
                                                                                    <call>
                                                                                        <name>FileOutputStream</name>
                                                                                        <argument_list>(
                                                                                            <argument>
                                                                                                <expr>
                                                                                                    <call>
                                                                                                        <name>
                                                                                                            getPathWithoutEscapes
                                                                                                        </name>
                                                                                                        <argument_list>(
                                                                                                            <argument>
                                                                                                                <expr>
                                                                                                                    <call>
                                                                                                                        <name>
                                                                                                                            <name>
                                                                                                                                url</name>
                                                                                                                            .
                                                                                                                            <name>
                                                                                                                                getFile
                                                                                                                            </name>
                                                                                                                        </name>
                                                                                                                        <argument_list>
                                                                                                                            ()
                                                                                                                        </argument_list>
                                                                                                                    </call>
                                                                                                                </expr>
                                                                                                            </argument>
                                                                                                            )
                                                                                                        </argument_list>
                                                                                                    </call>
                                                                                                </expr>
                                                                                            </argument>
                                                                                            )
                                                                                        </argument_list>
                                                                                    </call>
                                                                                </expr>
                                                                                ;
                                                                            </expr_stmt>
                                                                            }
                                                                        </block>
                                                                    </then>
                                                                    <comment type="line">// Try to write to some other
                                                                        kind of URI. Some protocols
                                                                    </comment>
                                                                    <comment type="line">// won't support this, though
                                                                        HTTP should work.
                                                                    </comment>
                                                                    <else>else
                                                                        <block>{
                                                                            <decl_stmt>
                                                                                <decl>
                                                                                    <type>
                                                                                        <name>URLConnection</name>
                                                                                    </type>
                                                                                    <name>urlCon</name> =
                                                                                    <init>
                                                                                        <expr>
                                                                                            <call>
                                                                                                <name><name>url</name>.
                                                                                                    <name>
                                                                                                        openConnection
                                                                                                    </name>
                                                                                                </name>
                                                                                                <argument_list>()
                                                                                                </argument_list>
                                                                                            </call>
                                                                                        </expr>
                                                                                    </init>
                                                                                </decl>
                                                                                ;
                                                                            </decl_stmt>
                                                                            <expr_stmt>
                                                                                <expr>
                                                                                    <call>
                                                                                        <name><name>urlCon</name>.
                                                                                            <name>setDoInput</name>
                                                                                        </name>
                                                                                        <argument_list>(
                                                                                            <argument>
                                                                                                <expr>false</expr>
                                                                                            </argument>
                                                                                            )
                                                                                        </argument_list>
                                                                                    </call>
                                                                                </expr>
                                                                                ;
                                                                            </expr_stmt>
                                                                            <expr_stmt>
                                                                                <expr>
                                                                                    <call>
                                                                                        <name><name>urlCon</name>.
                                                                                            <name>setDoOutput</name>
                                                                                        </name>
                                                                                        <argument_list>(
                                                                                            <argument>
                                                                                                <expr>true</expr>
                                                                                            </argument>
                                                                                            )
                                                                                        </argument_list>
                                                                                    </call>
                                                                                </expr>
                                                                                ;
                                                                            </expr_stmt>
                                                                            <expr_stmt>
                                                                                <expr>
                                                                                    <call>
                                                                                        <name><name>urlCon</name>.
                                                                                            <name>setUseCaches</name>
                                                                                        </name>
                                                                                        <argument_list>(
                                                                                            <argument>
                                                                                                <expr>false</expr>
                                                                                            </argument>
                                                                                            )
                                                                                        </argument_list>
                                                                                    </call>
                                                                                </expr>
                                                                                ;
                                                                            </expr_stmt>
                                                                            <comment type="line">// Enable tunneling.
                                                                            </comment>
                                                                            <if>if
                                                                                <condition>(
                                                                                    <expr>
                                                                                        <name>urlCon</name>
                                                                                        <name>instanceof</name>
                                                                                        <name>HttpURLConnection</name>
                                                                                    </expr>
                                                                                    )
                                                                                </condition>
                                                                                <then>
                                                                                    <block>{
                                                                                        <comment type="line">// The DOM
                                                                                            L3 LS CR says if we are
                                                                                            writing to an HTTP URI
                                                                                        </comment>
                                                                                        <comment type="line">// it is to
                                                                                            be done with an HTTP PUT.
                                                                                        </comment>
                                                                                        <decl_stmt>
                                                                                            <decl>
                                                                                                <type>
                                                                                                    <name>
                                                                                                        HttpURLConnection
                                                                                                    </name>
                                                                                                </type>
                                                                                                <name>httpCon</name> =
                                                                                                <init>
                                                                                                    <expr>(<name>
                                                                                                        HttpURLConnection</name>)
                                                                                                        <name>urlCon
                                                                                                        </name>
                                                                                                    </expr>
                                                                                                </init>
                                                                                            </decl>
                                                                                            ;
                                                                                        </decl_stmt>
                                                                                        <expr_stmt>
                                                                                            <expr>
                                                                                                <call>
                                                                                                    <name><name>
                                                                                                        httpCon</name>.
                                                                                                        <name>
                                                                                                            setRequestMethod
                                                                                                        </name>
                                                                                                    </name>
                                                                                                    <argument_list>(
                                                                                                        <argument>
                                                                                                            <expr>
                                                                                                                "PUT"
                                                                                                            </expr>
                                                                                                        </argument>
                                                                                                        )
                                                                                                    </argument_list>
                                                                                                </call>
                                                                                            </expr>
                                                                                            ;
                                                                                        </expr_stmt>
                                                                                        }
                                                                                    </block>
                                                                                </then>
                                                                            </if>
                                                                            <expr_stmt>
                                                                                <expr>
                                                                                    <name>out</name>
                                                                                    =
                                                                                    <call>
                                                                                        <name><name>urlCon</name>.
                                                                                            <name>getOutputStream</name>
                                                                                        </name>
                                                                                        <argument_list>()
                                                                                        </argument_list>
                                                                                    </call>
                                                                                </expr>
                                                                                ;
                                                                            </expr_stmt>
                                                                            }
                                                                        </block>
                                                                    </else>
                                                                </if>
                                                                <expr_stmt>
                                                                    <expr>
                                                                        <call>
                                                                            <name><name>ser</name>.
                                                                                <name>setOutputByteStream</name>
                                                                            </name>
                                                                            <argument_list>(
                                                                                <argument>
                                                                                    <expr>
                                                                                        <name>out</name>
                                                                                    </expr>
                                                                                </argument>
                                                                                )
                                                                            </argument_list>
                                                                        </call>
                                                                    </expr>
                                                                    ;
                                                                </expr_stmt>
                                                                }
                                                            </block>
                                                        </else>
                                                    </if>
                                                    }
                                                </block>
                                            </then>
                                            <else>else
                                                <block>{
                                                    <comment type="line">// byte stream was specified</comment>
                                                    <expr_stmt>
                                                        <expr>
                                                            <call>
                                                                <name><name>ser</name>.
                                                                    <name>setOutputByteStream</name>
                                                                </name>
                                                                <argument_list>(
                                                                    <argument>
                                                                        <expr>
                                                                            <name>outputStream</name>
                                                                        </expr>
                                                                    </argument>
                                                                    )
                                                                </argument_list>
                                                            </call>
                                                        </expr>
                                                        ;
                                                    </expr_stmt>
                                                    }
                                                </block>
                                            </else>
                                        </if>
                                        }
                                    </block>
                                </then>
                                <else>else
                                    <block>{
                                        <comment type="line">// character stream is specified</comment>
                                        <expr_stmt>
                                            <expr>
                                                <call>
                                                    <name><name>ser</name>.
                                                        <name>setOutputCharStream</name>
                                                    </name>
                                                    <argument_list>(
                                                        <argument>
                                                            <expr>
                                                                <name>writer</name>
                                                            </expr>
                                                        </argument>
                                                        )
                                                    </argument_list>
                                                </call>
                                            </expr>
                                            ;
                                        </expr_stmt>
                                        }
                                    </block>
                                </else>
                            </if>

                            <if>if
                                <condition>(
                                    <expr>
                                        <call>
                                            <name><name>node</name>.
                                                <name>getNodeType</name>
                                            </name>
                                            <argument_list>()</argument_list>
                                        </call>
                                        ==
                                        <name><name>Node</name>.
                                            <name>DOCUMENT_NODE</name>
                                        </name>
                                    </expr>
                                    )
                                </condition>
                                <then>
                                    <expr_stmt>
                                        <expr>
                                            <call>
                                                <name><name>ser</name>.
                                                    <name>serialize</name>
                                                </name>
                                                <argument_list>(
                                                    <argument>
                                                        <expr>(<name>Document</name>)
                                                            <name>node</name>
                                                        </expr>
                                                    </argument>
                                                    )
                                                </argument_list>
                                            </call>
                                        </expr>
                                        ;
                                    </expr_stmt>
                                </then>
                                <else>else
                                    <if>if
                                        <condition>(
                                            <expr>
                                                <call>
                                                    <name><name>node</name>.
                                                        <name>getNodeType</name>
                                                    </name>
                                                    <argument_list>()</argument_list>
                                                </call>
                                                ==
                                                <name><name>Node</name>.
                                                    <name>DOCUMENT_FRAGMENT_NODE</name>
                                                </name>
                                            </expr>
                                            )
                                        </condition>
                                        <then>
                                            <expr_stmt>
                                                <expr>
                                                    <call>
                                                        <name><name>ser</name>.
                                                            <name>serialize</name>
                                                        </name>
                                                        <argument_list>(
                                                            <argument>
                                                                <expr>(<name>DocumentFragment</name>)
                                                                    <name>node</name>
                                                                </expr>
                                                            </argument>
                                                            )
                                                        </argument_list>
                                                    </call>
                                                </expr>
                                                ;
                                            </expr_stmt>
                                        </then>
                                        <else>else
                                            <if>if
                                                <condition>(
                                                    <expr>
                                                        <call>
                                                            <name><name>node</name>.
                                                                <name>getNodeType</name>
                                                            </name>
                                                            <argument_list>()</argument_list>
                                                        </call>
                                                        ==
                                                        <name><name>Node</name>.
                                                            <name>ELEMENT_NODE</name>
                                                        </name>
                                                    </expr>
                                                    )
                                                </condition>
                                                <then>
                                                    <expr_stmt>
                                                        <expr>
                                                            <call>
                                                                <name><name>ser</name>.
                                                                    <name>serialize</name>
                                                                </name>
                                                                <argument_list>(
                                                                    <argument>
                                                                        <expr>(<name>Element</name>)
                                                                            <name>node</name>
                                                                        </expr>
                                                                    </argument>
                                                                    )
                                                                </argument_list>
                                                            </call>
                                                        </expr>
                                                        ;
                                                    </expr_stmt>
                                                </then>
                                                <else>else
                                                    <return>return <expr>false</expr>;
                                                    </return>
                                                </else>
                                            </if>
                                        </else>
                                    </if>
                                </else>
                            </if>
                            }
                        </block>
                        <catch>catch(
                            <param>
                                <decl>
                                    <type>
                                        <name>UnsupportedEncodingException</name>
                                    </type>
                                    <name>ue</name>
                                </decl>
                            </param>
                            )
                            <block>{
                                <if>if
                                    <condition>(
                                        <expr>
                                            <name><name>ser</name>.
                                                <name>fDOMErrorHandler</name>
                                            </name>
                                            !=
                                            <name>null</name>
                                        </expr>
                                        )
                                    </condition>
                                    <then>
                                        <block>{
                                            <decl_stmt>
                                                <decl>
                                                    <type>
                                                        <name>DOMErrorImpl</name>
                                                    </type>
                                                    <name>error</name> =
                                                    <init>
                                                        <expr>new
                                                            <call>
                                                                <name>DOMErrorImpl</name>
                                                                <argument_list>()</argument_list>
                                                            </call>
                                                        </expr>
                                                    </init>
                                                </decl>
                                                ;
                                            </decl_stmt>
                                            <expr_stmt>
                                                <expr>
                                                    <name><name>error</name>.
                                                        <name>fException</name>
                                                    </name>
                                                    =
                                                    <name>ue</name>
                                                </expr>
                                                ;
                                            </expr_stmt>
                                            <expr_stmt>
                                                <expr>
                                                    <name><name>error</name>.
                                                        <name>fType</name>
                                                    </name>
                                                    = "unsupported-encoding"
                                                </expr>
                                                ;
                                            </expr_stmt>
                                            <expr_stmt>
                                                <expr>
                                                    <name><name>error</name>.
                                                        <name>fMessage</name>
                                                    </name>
                                                    =
                                                    <call>
                                                        <name><name>ue</name>.
                                                            <name>getMessage</name>
                                                        </name>
                                                        <argument_list>()</argument_list>
                                                    </call>
                                                </expr>
                                                ;
                                            </expr_stmt>
                                            <expr_stmt>
                                                <expr>
                                                    <name><name>error</name>.
                                                        <name>fSeverity</name>
                                                    </name>
                                                    =
                                                    <name><name>DOMError</name>.
                                                        <name>SEVERITY_FATAL_ERROR</name>
                                                    </name>
                                                </expr>
                                                ;
                                            </expr_stmt>
                                            <expr_stmt>
                                                <expr>
                                                    <call>
                                                        <name><name>ser</name>.<name>fDOMErrorHandler</name>.
                                                            <name>handleError</name>
                                                        </name>
                                                        <argument_list>(
                                                            <argument>
                                                                <expr>
                                                                    <name>error</name>
                                                                </expr>
                                                            </argument>
                                                            )
                                                        </argument_list>
                                                    </call>
                                                </expr>
                                                ;
                                            </expr_stmt>
                                            }
                                        </block>
                                    </then>
                                </if>
                                <throw>throw
                                    <expr>new
                                        <call>
                                            <name>LSException</name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>LSException</name>.
                                                            <name>SERIALIZE_ERR</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                ,
                                                <argument>
                                                    <expr>
                                                        <call>
                                                            <name><name>DOMMessageFormatter</name>.
                                                                <name>formatMessage</name>
                                                            </name>
                                                            <argument_list>(
                                                                <argument>
                                                                    <expr>
                                                                        <name><name>DOMMessageFormatter</name>.
                                                                            <name>SERIALIZER_DOMAIN</name>
                                                                        </name>
                                                                    </expr>
                                                                </argument>
                                                                ,
                                                                <argument>
                                                                    <expr>"unsupported-encoding"</expr>
                                                                </argument>
                                                                ,
                                                                <argument>
                                                                    <expr>
                                                                        <name>null</name>
                                                                    </expr>
                                                                </argument>
                                                                )
                                                            </argument_list>
                                                        </call>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </throw>
                                <comment type="line">//return false;</comment>
                                }
                            </block>
                        </catch>
                        <catch>catch (
                            <param>
                                <decl>
                                    <type>
                                        <name>LSException</name>
                                    </type>
                                    <name>lse</name>
                                </decl>
                            </param>
                            )
                            <block>{
                                <comment type="line">// Rethrow LSException.</comment>
                                <throw>throw
                                    <expr>
                                        <name>lse</name>
                                    </expr>
                                    ;
                                </throw>
                                }
                            </block>
                        </catch>
                        <catch>catch (
                            <param>
                                <decl>
                                    <type>
                                        <name>RuntimeException</name>
                                    </type>
                                    <name>e</name>
                                </decl>
                            </param>
                            )
                            <block>{
                                <if>if
                                    <condition>(
                                        <expr>
                                            <name>e</name>
                                            ==
                                            <name><name>DOMNormalizer</name>.
                                                <name>abort</name>
                                            </name>
                                        </expr>
                                        )
                                    </condition>
                                    <then>
                                        <block>{
                                            <comment type="line">// stopped at user request</comment>
                                            <return>return <expr>false</expr>;
                                            </return>
                                            }
                                        </block>
                                    </then>
                                </if>
                                <throw>throw
                                    <expr>new
                                        <call>
                                            <name>LSException</name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>LSException</name>.
                                                            <name>SERIALIZE_ERR</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                ,
                                                <argument>
                                                    <expr>
                                                        <call>
                                                            <name><name>e</name>.
                                                                <name>toString</name>
                                                            </name>
                                                            <argument_list>()</argument_list>
                                                        </call>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </throw>
                                }
                            </block>
                        </catch>
                        <catch>catch (
                            <param>
                                <decl>
                                    <type>
                                        <name>Exception</name>
                                    </type>
                                    <name>e</name>
                                </decl>
                            </param>
                            )
                            <block>{
                                <if>if
                                    <condition>(
                                        <expr>
                                            <name><name>ser</name>.
                                                <name>fDOMErrorHandler</name>
                                            </name>
                                            !=
                                            <name>null</name>
                                        </expr>
                                        )
                                    </condition>
                                    <then>
                                        <block>{
                                            <decl_stmt>
                                                <decl>
                                                    <type>
                                                        <name>DOMErrorImpl</name>
                                                    </type>
                                                    <name>error</name> =
                                                    <init>
                                                        <expr>new
                                                            <call>
                                                                <name>DOMErrorImpl</name>
                                                                <argument_list>()</argument_list>
                                                            </call>
                                                        </expr>
                                                    </init>
                                                </decl>
                                                ;
                                            </decl_stmt>
                                            <expr_stmt>
                                                <expr>
                                                    <name><name>error</name>.
                                                        <name>fException</name>
                                                    </name>
                                                    =
                                                    <name>e</name>
                                                </expr>
                                                ;
                                            </expr_stmt>
                                            <expr_stmt>
                                                <expr>
                                                    <name><name>error</name>.
                                                        <name>fMessage</name>
                                                    </name>
                                                    =
                                                    <call>
                                                        <name><name>e</name>.
                                                            <name>getMessage</name>
                                                        </name>
                                                        <argument_list>()</argument_list>
                                                    </call>
                                                </expr>
                                                ;
                                            </expr_stmt>
                                            <expr_stmt>
                                                <expr>
                                                    <name><name>error</name>.
                                                        <name>fSeverity</name>
                                                    </name>
                                                    =
                                                    <name><name>DOMError</name>.
                                                        <name>SEVERITY_ERROR</name>
                                                    </name>
                                                </expr>
                                                ;
                                            </expr_stmt>
                                            <expr_stmt>
                                                <expr>
                                                    <call>
                                                        <name><name>ser</name>.<name>fDOMErrorHandler</name>.
                                                            <name>handleError</name>
                                                        </name>
                                                        <argument_list>(
                                                            <argument>
                                                                <expr>
                                                                    <name>error</name>
                                                                </expr>
                                                            </argument>
                                                            )
                                                        </argument_list>
                                                    </call>
                                                </expr>
                                                ;
                                            </expr_stmt>

                                            }
                                        </block>
                                    </then>
                                </if>
                                <expr_stmt>
                                    <expr>
                                        <call>
                                            <name><name>e</name>.
                                                <name>printStackTrace</name>
                                            </name>
                                            <argument_list>()</argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </expr_stmt>
                                <throw>throw
                                    <expr>new
                                        <call>
                                            <name>LSException</name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>LSException</name>.
                                                            <name>SERIALIZE_ERR</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                ,
                                                <argument>
                                                    <expr>
                                                        <call>
                                                            <name><name>e</name>.
                                                                <name>toString</name>
                                                            </name>
                                                            <argument_list>()</argument_list>
                                                        </call>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </throw>
                                }
                            </block>
                        </catch>
                    </try>
                    <return>return <expr>true</expr>;
                    </return>

                    }
                </block>
            </function>
            <comment type="line">//write</comment>

            <comment type="javadoc">/**
                * Serialize the specified node as described above in the general
                * description of the &lt;code&gt;LSSerializer&lt;/code&gt; interface. The output
                * is written to the supplied URI.
                * &lt;br&gt; When writing to a URI, the encoding is found by looking at the
                * encoding information that is reachable through the item to be written
                * (or its owner document) in this order:
                * &lt;ol&gt;
                * &lt;li&gt;
                * &lt;code&gt;Document.inputEncoding&lt;/code&gt;,
                * &lt;/li&gt;
                * &lt;li&gt;
                * &lt;code&gt;Document.xmlEncoding&lt;/code&gt;.
                * &lt;/li&gt;
                * &lt;/ol&gt;
                * &lt;br&gt; If no encoding is reachable through the above properties, a
                * default encoding of "UTF-8" will be used.
                * &lt;br&gt; If the specified encoding is not supported an
                * "unsupported-encoding" error is raised.
                * @param node The node to serialize.
                * @param URI The URI to write to.
                * @return Returns &lt;code&gt;true&lt;/code&gt; if &lt;code&gt;node&lt;/code&gt; was
                * successfully serialized and &lt;code&gt;false&lt;/code&gt; in case the node
                * couldn't be serialized.
                */
            </comment>
            <function>
                <type>
                    <specifier>public</specifier>
                    <name>boolean</name>
                </type>
                <name>writeToURI</name>
                <parameter_list>(
                    <param>
                        <decl>
                            <type>
                                <name>Node</name>
                            </type>
                            <name>node</name>
                        </decl>
                    </param>
                    ,
                    <param>
                        <decl>
                            <type>
                                <name>String</name>
                            </type>
                            <name>URI</name>
                        </decl>
                    </param>
                    )
                </parameter_list>
                <throws>throws
                    <argument>
                        <expr>
                            <name>LSException</name>
                        </expr>
                    </argument>
                </throws>
                <block>{
                    <if>if
                        <condition>(
                            <expr>
                                <name>node</name>
                                ==
                                <name>null</name>
                            </expr>
                            )
                        </condition>
                        <then>
                            <block>{
                                <return>return <expr>false</expr>;
                                </return>
                                }
                            </block>
                        </then>
                    </if>

                    <decl_stmt>
                        <decl>
                            <type>
                                <name>Method</name>
                            </type>
                            <name>getXmlVersion</name> =
                            <init>
                                <expr>
                                    <name>null</name>
                                </expr>
                            </init>
                        </decl>
                        ;
                    </decl_stmt>
                    <decl_stmt>
                        <decl>
                            <type>
                                <name>XMLSerializer</name>
                            </type>
                            <name>ser</name> =
                            <init>
                                <expr>
                                    <name>null</name>
                                </expr>
                            </init>
                        </decl>
                        ;
                    </decl_stmt>
                    <decl_stmt>
                        <decl>
                            <type>
                                <name>String</name>
                            </type>
                            <name>ver</name> =
                            <init>
                                <expr>
                                    <name>null</name>
                                </expr>
                            </init>
                        </decl>
                        ;
                    </decl_stmt>
                    <decl_stmt>
                        <decl>
                            <type>
                                <name>String</name>
                            </type>
                            <name>encoding</name> =
                            <init>
                                <expr>
                                    <name>null</name>
                                </expr>
                            </init>
                        </decl>
                        ;
                    </decl_stmt>

                    <decl_stmt>
                        <decl>
                            <type>
                                <name>Document</name>
                            </type>
                            <name>fDocument</name> =
                            <init>
                                <expr>(
                                    <call>
                                        <name><name>node</name>.
                                            <name>getNodeType</name>
                                        </name>
                                        <argument_list>()</argument_list>
                                    </call>
                                    ==
                                    <name><name>Node</name>.
                                        <name>DOCUMENT_NODE</name>
                                    </name>
                                    )
                                    ? (<name>Document</name>)
                                    <name>node</name>
                                    :
                                    <call>
                                        <name><name>node</name>.
                                            <name>getOwnerDocument</name>
                                        </name>
                                        <argument_list>()</argument_list>
                                    </call>
                                </expr>
                            </init>
                        </decl>
                        ;
                    </decl_stmt>
                    <comment type="line">// this should run under JDK 1.1.8...</comment>
                    <try>try
                        <block>{
                            <expr_stmt>
                                <expr>
                                    <name>getXmlVersion</name>
                                    =
                                    <call>
                                        <name><name>fDocument</name>.
                                            <name>getClass</name>
                                        </name>
                                        <argument_list>()</argument_list>
                                    </call>
                                    .
                                    <call>
                                        <name>getMethod</name>
                                        <argument_list>(
                                            <argument>
                                                <expr>"getXmlVersion"</expr>
                                            </argument>
                                            ,
                                            <argument>
                                                <expr>new
                                                    <name>
                                                        <name>Class</name>
                                                        <index>[]</index>
                                                    </name>
                                                    <block>{}</block>
                                                </expr>
                                            </argument>
                                            )
                                        </argument_list>
                                    </call>
                                </expr>
                                ;
                            </expr_stmt>
                            <if>if
                                <condition>(
                                    <expr>
                                        <name>getXmlVersion</name>
                                        !=
                                        <name>null</name>
                                    </expr>
                                    )
                                </condition>
                                <then>
                                    <block>{
                                        <expr_stmt>
                                            <expr>
                                                <name>ver</name>
                                                = (<name>String</name>)
                                                <call>
                                                    <name><name>getXmlVersion</name>.
                                                        <name>invoke</name>
                                                    </name>
                                                    <argument_list>(
                                                        <argument>
                                                            <expr>
                                                                <name>fDocument</name>
                                                            </expr>
                                                        </argument>
                                                        ,
                                                        <argument>
                                                            <expr>(
                                                                <name>
                                                                    <name>Object</name>
                                                                    <index>[]</index>
                                                                </name>
                                                                )
                                                                <name>null</name>
                                                            </expr>
                                                        </argument>
                                                        )
                                                    </argument_list>
                                                </call>
                                            </expr>
                                            ;
                                        </expr_stmt>
                                        }
                                    </block>
                                </then>
                            </if>
                            }
                        </block>
                        <catch>catch (
                            <param>
                                <decl>
                                    <type>
                                        <name>Exception</name>
                                    </type>
                                    <name>e</name>
                                </decl>
                            </param>
                            )
                            <block>{
                                <comment type="line">// no way to test the version...</comment>
                                <comment type="line">// ignore the exception</comment>
                                }
                            </block>
                        </catch>
                    </try>
                    <if>if
                        <condition>(
                            <expr>
                                <name>ver</name>
                                != <name>null</name> &amp;&amp;
                                <call>
                                    <name><name>ver</name>.
                                        <name>equals</name>
                                    </name>
                                    <argument_list>(
                                        <argument>
                                            <expr>"1.1"</expr>
                                        </argument>
                                        )
                                    </argument_list>
                                </call>
                            </expr>
                            )
                        </condition>
                        <then>
                            <block>{
                                <if>if
                                    <condition>(
                                        <expr>
                                            <name>xml11Serializer</name>
                                            ==
                                            <name>null</name>
                                        </expr>
                                        )
                                    </condition>
                                    <then>
                                        <block>{
                                            <expr_stmt>
                                                <expr>
                                                    <name>xml11Serializer</name>
                                                    = new
                                                    <call>
                                                        <name>XML11Serializer</name>
                                                        <argument_list>()</argument_list>
                                                    </call>
                                                </expr>
                                                ;
                                            </expr_stmt>
                                            <expr_stmt>
                                                <expr>
                                                    <call>
                                                        <name>initSerializer</name>
                                                        <argument_list>(
                                                            <argument>
                                                                <expr>
                                                                    <name>xml11Serializer</name>
                                                                </expr>
                                                            </argument>
                                                            )
                                                        </argument_list>
                                                    </call>
                                                </expr>
                                                ;
                                            </expr_stmt>
                                            }
                                        </block>
                                    </then>
                                </if>
                                <comment type="line">// copy setting from "main" serializer to XML 1.1 serializer
                                </comment>
                                <expr_stmt>
                                    <expr>
                                        <call>
                                            <name>copySettings</name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name>serializer</name>
                                                    </expr>
                                                </argument>
                                                ,
                                                <argument>
                                                    <expr>
                                                        <name>xml11Serializer</name>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </expr_stmt>
                                <expr_stmt>
                                    <expr>
                                        <name>ser</name>
                                        =
                                        <name>xml11Serializer</name>
                                    </expr>
                                    ;
                                </expr_stmt>
                                }
                            </block>
                        </then>
                        <else>else
                            <block>{
                                <expr_stmt>
                                    <expr>
                                        <name>ser</name>
                                        =
                                        <name>serializer</name>
                                    </expr>
                                    ;
                                </expr_stmt>
                                }
                            </block>
                        </else>
                    </if>

                    <try>try
                        <block>{
                            <decl_stmt>
                                <decl>
                                    <type>
                                        <name>Method</name>
                                    </type>
                                    <name>getEncoding</name> =
                                    <init>
                                        <expr>
                                            <call>
                                                <name><name>fDocument</name>.
                                                    <name>getClass</name>
                                                </name>
                                                <argument_list>()</argument_list>
                                            </call>
                                            .
                                            <call>
                                                <name>getMethod</name>
                                                <argument_list>(
                                                    <argument>
                                                        <expr>"getInputEncoding"</expr>
                                                    </argument>
                                                    ,
                                                    <argument>
                                                        <expr>new
                                                            <name>
                                                                <name>Class</name>
                                                                <index>[]</index>
                                                            </name>
                                                            <block>{}</block>
                                                        </expr>
                                                    </argument>
                                                    )
                                                </argument_list>
                                            </call>
                                        </expr>
                                    </init>
                                </decl>
                                ;
                            </decl_stmt>
                            <if>if
                                <condition>(
                                    <expr>
                                        <name>getEncoding</name>
                                        !=
                                        <name>null</name>
                                    </expr>
                                    )
                                </condition>
                                <then>
                                    <block>{
                                        <expr_stmt>
                                            <expr>
                                                <name>encoding</name>
                                                = (<name>String</name>)
                                                <call>
                                                    <name><name>getEncoding</name>.
                                                        <name>invoke</name>
                                                    </name>
                                                    <argument_list>(
                                                        <argument>
                                                            <expr>
                                                                <name>fDocument</name>
                                                            </expr>
                                                        </argument>
                                                        ,
                                                        <argument>
                                                            <expr>(
                                                                <name>
                                                                    <name>Object</name>
                                                                    <index>[]</index>
                                                                </name>
                                                                )
                                                                <name>null</name>
                                                            </expr>
                                                        </argument>
                                                        )
                                                    </argument_list>
                                                </call>
                                            </expr>
                                            ;
                                        </expr_stmt>
                                        }
                                    </block>
                                </then>
                            </if>
                            }
                        </block>
                        <catch>catch (
                            <param>
                                <decl>
                                    <type>
                                        <name>Exception</name>
                                    </type>
                                    <name>e</name>
                                </decl>
                            </param>
                            )
                            <block>{
                                <comment type="line">// ignore the exception</comment>
                                }
                            </block>
                        </catch>
                    </try>
                    <if>if
                        <condition>(
                            <expr>
                                <name>encoding</name>
                                ==
                                <name>null</name>
                            </expr>
                            )
                        </condition>
                        <then>
                            <block>{
                                <try>try
                                    <block>{
                                        <decl_stmt>
                                            <decl>
                                                <type>
                                                    <name>Method</name>
                                                </type>
                                                <name>getEncoding</name> =
                                                <init>
                                                    <expr>
                                                        <call>
                                                            <name><name>fDocument</name>.
                                                                <name>getClass</name>
                                                            </name>
                                                            <argument_list>()</argument_list>
                                                        </call>
                                                        .
                                                        <call>
                                                            <name>getMethod</name>
                                                            <argument_list>(
                                                                <argument>
                                                                    <expr>"getXmlEncoding"</expr>
                                                                </argument>
                                                                ,
                                                                <argument>
                                                                    <expr>new
                                                                        <name>
                                                                            <name>Class</name>
                                                                            <index>[]</index>
                                                                        </name>
                                                                        <block>{}</block>
                                                                    </expr>
                                                                </argument>
                                                                )
                                                            </argument_list>
                                                        </call>
                                                    </expr>
                                                </init>
                                            </decl>
                                            ;
                                        </decl_stmt>
                                        <if>if
                                            <condition>(
                                                <expr>
                                                    <name>getEncoding</name>
                                                    !=
                                                    <name>null</name>
                                                </expr>
                                                )
                                            </condition>
                                            <then>
                                                <block>{
                                                    <expr_stmt>
                                                        <expr>
                                                            <name>encoding</name>
                                                            = (<name>String</name>)
                                                            <call>
                                                                <name><name>getEncoding</name>.
                                                                    <name>invoke</name>
                                                                </name>
                                                                <argument_list>(
                                                                    <argument>
                                                                        <expr>
                                                                            <name>fDocument</name>
                                                                        </expr>
                                                                    </argument>
                                                                    ,
                                                                    <argument>
                                                                        <expr>(
                                                                            <name>
                                                                                <name>Object</name>
                                                                                <index>[]</index>
                                                                            </name>
                                                                            )
                                                                            <name>null</name>
                                                                        </expr>
                                                                    </argument>
                                                                    )
                                                                </argument_list>
                                                            </call>
                                                        </expr>
                                                        ;
                                                    </expr_stmt>
                                                    }
                                                </block>
                                            </then>
                                        </if>
                                        }
                                    </block>
                                    <catch>catch (
                                        <param>
                                            <decl>
                                                <type>
                                                    <name>Exception</name>
                                                </type>
                                                <name>e</name>
                                            </decl>
                                        </param>
                                        )
                                        <block>{
                                            <comment type="line">// ignore the exception</comment>
                                            }
                                        </block>
                                    </catch>
                                </try>
                                <if>if
                                    <condition>(
                                        <expr>
                                            <name>encoding</name>
                                            ==
                                            <name>null</name>
                                        </expr>
                                        )
                                    </condition>
                                    <then>
                                        <block>{
                                            <expr_stmt>
                                                <expr>
                                                    <name>encoding</name>
                                                    = "UTF-8"
                                                </expr>
                                                ;
                                            </expr_stmt>
                                            }
                                        </block>
                                    </then>
                                </if>
                                }
                            </block>
                        </then>
                    </if>

                    <try>try
                        <block>{
                            <expr_stmt>
                                <expr>
                                    <call>
                                        <name>prepareForSerialization</name>
                                        <argument_list>(
                                            <argument>
                                                <expr>
                                                    <name>ser</name>
                                                </expr>
                                            </argument>
                                            ,
                                            <argument>
                                                <expr>
                                                    <name>node</name>
                                                </expr>
                                            </argument>
                                            )
                                        </argument_list>
                                    </call>
                                </expr>
                                ;
                            </expr_stmt>
                            <expr_stmt>
                                <expr>
                                    <call>
                                        <name><name>ser</name>.<name>_format</name>.
                                            <name>setEncoding</name>
                                        </name>
                                        <argument_list>(
                                            <argument>
                                                <expr>
                                                    <name>encoding</name>
                                                </expr>
                                            </argument>
                                            )
                                        </argument_list>
                                    </call>
                                </expr>
                                ;
                            </expr_stmt>

                            <comment type="line">// URI was specified. Handle relative URIs.</comment>
                            <decl_stmt>
                                <decl>
                                    <type>
                                        <name>String</name>
                                    </type>
                                    <name>expanded</name> =
                                    <init>
                                        <expr>
                                            <call>
                                                <name><name>XMLEntityManager</name>.
                                                    <name>expandSystemId</name>
                                                </name>
                                                <argument_list>(
                                                    <argument>
                                                        <expr>
                                                            <name>URI</name>
                                                        </expr>
                                                    </argument>
                                                    ,
                                                    <argument>
                                                        <expr>
                                                            <name>null</name>
                                                        </expr>
                                                    </argument>
                                                    ,
                                                    <argument>
                                                        <expr>true</expr>
                                                    </argument>
                                                    )
                                                </argument_list>
                                            </call>
                                        </expr>
                                    </init>
                                </decl>
                                ;
                            </decl_stmt>
                            <decl_stmt>
                                <decl>
                                    <type>
                                        <name>URL</name>
                                    </type>
                                    <name>url</name> =
                                    <init>
                                        <expr>new
                                            <call>
                                                <name>URL</name>
                                                <argument_list>(
                                                    <argument>
                                                        <expr>
                                                            <name>expanded</name>
                                                            != <name>null</name> ? <name>expanded</name> :
                                                            <name>URI</name>
                                                        </expr>
                                                    </argument>
                                                    )
                                                </argument_list>
                                            </call>
                                        </expr>
                                    </init>
                                </decl>
                                ;
                            </decl_stmt>
                            <decl_stmt>
                                <decl>
                                    <type>
                                        <name>OutputStream</name>
                                    </type>
                                    <name>out</name> =
                                    <init>
                                        <expr>
                                            <name>null</name>
                                        </expr>
                                    </init>
                                </decl>
                                ;
                            </decl_stmt>
                            <decl_stmt>
                                <decl>
                                    <type>
                                        <name>String</name>
                                    </type>
                                    <name>protocol</name> =
                                    <init>
                                        <expr>
                                            <call>
                                                <name><name>url</name>.
                                                    <name>getProtocol</name>
                                                </name>
                                                <argument_list>()</argument_list>
                                            </call>
                                        </expr>
                                    </init>
                                </decl>
                                ;
                            </decl_stmt>
                            <decl_stmt>
                                <decl>
                                    <type>
                                        <name>String</name>
                                    </type>
                                    <name>host</name> =
                                    <init>
                                        <expr>
                                            <call>
                                                <name><name>url</name>.
                                                    <name>getHost</name>
                                                </name>
                                                <argument_list>()</argument_list>
                                            </call>
                                        </expr>
                                    </init>
                                </decl>
                                ;
                            </decl_stmt>
                            <comment type="line">// Use FileOutputStream if this URI is for a local file.</comment>
                            <if>if
                                <condition>(
                                    <expr>
                                        <call>
                                            <name><name>protocol</name>.
                                                <name>equals</name>
                                            </name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>"file"</expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                        &amp;&amp; (<name>host</name> == <name>null</name> ||
                                        <call>
                                            <name><name>host</name>.
                                                <name>length</name>
                                            </name>
                                            <argument_list>()</argument_list>
                                        </call>
                                        == 0 ||
                                        <call>
                                            <name><name>host</name>.
                                                <name>equals</name>
                                            </name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>"localhost"</expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                        )
                                    </expr>
                                    )
                                </condition>
                                <then>
                                    <block>{
                                        <expr_stmt>
                                            <expr>
                                                <name>out</name>
                                                = new
                                                <call>
                                                    <name>FileOutputStream</name>
                                                    <argument_list>(
                                                        <argument>
                                                            <expr>
                                                                <call>
                                                                    <name>getPathWithoutEscapes</name>
                                                                    <argument_list>(
                                                                        <argument>
                                                                            <expr>
                                                                                <call>
                                                                                    <name><name>url</name>.
                                                                                        <name>getFile</name>
                                                                                    </name>
                                                                                    <argument_list>()</argument_list>
                                                                                </call>
                                                                            </expr>
                                                                        </argument>
                                                                        )
                                                                    </argument_list>
                                                                </call>
                                                            </expr>
                                                        </argument>
                                                        )
                                                    </argument_list>
                                                </call>
                                            </expr>
                                            ;
                                        </expr_stmt>
                                        }
                                    </block>
                                </then>
                                <comment type="line">// Try to write to some other kind of URI. Some protocols</comment>
                                <comment type="line">// won't support this, though HTTP should work.</comment>
                                <else>else
                                    <block>{
                                        <decl_stmt>
                                            <decl>
                                                <type>
                                                    <name>URLConnection</name>
                                                </type>
                                                <name>urlCon</name> =
                                                <init>
                                                    <expr>
                                                        <call>
                                                            <name><name>url</name>.
                                                                <name>openConnection</name>
                                                            </name>
                                                            <argument_list>()</argument_list>
                                                        </call>
                                                    </expr>
                                                </init>
                                            </decl>
                                            ;
                                        </decl_stmt>
                                        <expr_stmt>
                                            <expr>
                                                <call>
                                                    <name><name>urlCon</name>.
                                                        <name>setDoInput</name>
                                                    </name>
                                                    <argument_list>(
                                                        <argument>
                                                            <expr>false</expr>
                                                        </argument>
                                                        )
                                                    </argument_list>
                                                </call>
                                            </expr>
                                            ;
                                        </expr_stmt>
                                        <expr_stmt>
                                            <expr>
                                                <call>
                                                    <name><name>urlCon</name>.
                                                        <name>setDoOutput</name>
                                                    </name>
                                                    <argument_list>(
                                                        <argument>
                                                            <expr>true</expr>
                                                        </argument>
                                                        )
                                                    </argument_list>
                                                </call>
                                            </expr>
                                            ;
                                        </expr_stmt>
                                        <expr_stmt>
                                            <expr>
                                                <call>
                                                    <name><name>urlCon</name>.
                                                        <name>setUseCaches</name>
                                                    </name>
                                                    <argument_list>(
                                                        <argument>
                                                            <expr>false</expr>
                                                        </argument>
                                                        )
                                                    </argument_list>
                                                </call>
                                            </expr>
                                            ;
                                        </expr_stmt>
                                        <comment type="line">// Enable tunneling.</comment>
                                        <if>if
                                            <condition>(
                                                <expr>
                                                    <name>urlCon</name>
                                                    <name>instanceof</name>
                                                    <name>HttpURLConnection</name>
                                                </expr>
                                                )
                                            </condition>
                                            <then>
                                                <block>{
                                                    <comment type="line">// The DOM L3 LS CR says if we are writing to
                                                        an HTTP URI
                                                    </comment>
                                                    <comment type="line">// it is to be done with an HTTP PUT.</comment>
                                                    <decl_stmt>
                                                        <decl>
                                                            <type>
                                                                <name>HttpURLConnection</name>
                                                            </type>
                                                            <name>httpCon</name> =
                                                            <init>
                                                                <expr>(<name>HttpURLConnection</name>)
                                                                    <name>urlCon</name>
                                                                </expr>
                                                            </init>
                                                        </decl>
                                                        ;
                                                    </decl_stmt>
                                                    <expr_stmt>
                                                        <expr>
                                                            <call>
                                                                <name><name>httpCon</name>.
                                                                    <name>setRequestMethod</name>
                                                                </name>
                                                                <argument_list>(
                                                                    <argument>
                                                                        <expr>"PUT"</expr>
                                                                    </argument>
                                                                    )
                                                                </argument_list>
                                                            </call>
                                                        </expr>
                                                        ;
                                                    </expr_stmt>
                                                    }
                                                </block>
                                            </then>
                                        </if>
                                        <expr_stmt>
                                            <expr>
                                                <name>out</name>
                                                =
                                                <call>
                                                    <name><name>urlCon</name>.
                                                        <name>getOutputStream</name>
                                                    </name>
                                                    <argument_list>()</argument_list>
                                                </call>
                                            </expr>
                                            ;
                                        </expr_stmt>
                                        }
                                    </block>
                                </else>
                            </if>
                            <expr_stmt>
                                <expr>
                                    <call>
                                        <name><name>ser</name>.
                                            <name>setOutputByteStream</name>
                                        </name>
                                        <argument_list>(
                                            <argument>
                                                <expr>
                                                    <name>out</name>
                                                </expr>
                                            </argument>
                                            )
                                        </argument_list>
                                    </call>
                                </expr>
                                ;
                            </expr_stmt>

                            <if>if
                                <condition>(
                                    <expr>
                                        <call>
                                            <name><name>node</name>.
                                                <name>getNodeType</name>
                                            </name>
                                            <argument_list>()</argument_list>
                                        </call>
                                        ==
                                        <name><name>Node</name>.
                                            <name>DOCUMENT_NODE</name>
                                        </name>
                                    </expr>
                                    )
                                </condition>
                                <then>
                                    <expr_stmt>
                                        <expr>
                                            <call>
                                                <name><name>ser</name>.
                                                    <name>serialize</name>
                                                </name>
                                                <argument_list>(
                                                    <argument>
                                                        <expr>(<name>Document</name>)
                                                            <name>node</name>
                                                        </expr>
                                                    </argument>
                                                    )
                                                </argument_list>
                                            </call>
                                        </expr>
                                        ;
                                    </expr_stmt>
                                </then>
                                <else>else
                                    <if>if
                                        <condition>(
                                            <expr>
                                                <call>
                                                    <name><name>node</name>.
                                                        <name>getNodeType</name>
                                                    </name>
                                                    <argument_list>()</argument_list>
                                                </call>
                                                ==
                                                <name><name>Node</name>.
                                                    <name>DOCUMENT_FRAGMENT_NODE</name>
                                                </name>
                                            </expr>
                                            )
                                        </condition>
                                        <then>
                                            <expr_stmt>
                                                <expr>
                                                    <call>
                                                        <name><name>ser</name>.
                                                            <name>serialize</name>
                                                        </name>
                                                        <argument_list>(
                                                            <argument>
                                                                <expr>(<name>DocumentFragment</name>)
                                                                    <name>node</name>
                                                                </expr>
                                                            </argument>
                                                            )
                                                        </argument_list>
                                                    </call>
                                                </expr>
                                                ;
                                            </expr_stmt>
                                        </then>
                                        <else>else
                                            <if>if
                                                <condition>(
                                                    <expr>
                                                        <call>
                                                            <name><name>node</name>.
                                                                <name>getNodeType</name>
                                                            </name>
                                                            <argument_list>()</argument_list>
                                                        </call>
                                                        ==
                                                        <name><name>Node</name>.
                                                            <name>ELEMENT_NODE</name>
                                                        </name>
                                                    </expr>
                                                    )
                                                </condition>
                                                <then>
                                                    <expr_stmt>
                                                        <expr>
                                                            <call>
                                                                <name><name>ser</name>.
                                                                    <name>serialize</name>
                                                                </name>
                                                                <argument_list>(
                                                                    <argument>
                                                                        <expr>(<name>Element</name>)
                                                                            <name>node</name>
                                                                        </expr>
                                                                    </argument>
                                                                    )
                                                                </argument_list>
                                                            </call>
                                                        </expr>
                                                        ;
                                                    </expr_stmt>
                                                </then>
                                                <else>else
                                                    <return>return <expr>false</expr>;
                                                    </return>
                                                </else>
                                            </if>
                                        </else>
                                    </if>
                                </else>
                            </if>
                            }
                        </block>
                        <catch>catch (
                            <param>
                                <decl>
                                    <type>
                                        <name>LSException</name>
                                    </type>
                                    <name>lse</name>
                                </decl>
                            </param>
                            )
                            <block>{
                                <comment type="line">// Rethrow LSException.</comment>
                                <throw>throw
                                    <expr>
                                        <name>lse</name>
                                    </expr>
                                    ;
                                </throw>
                                }
                            </block>
                        </catch>
                        <catch>catch (
                            <param>
                                <decl>
                                    <type>
                                        <name>RuntimeException</name>
                                    </type>
                                    <name>e</name>
                                </decl>
                            </param>
                            )
                            <block>{
                                <if>if
                                    <condition>(
                                        <expr>
                                            <name>e</name>
                                            ==
                                            <name><name>DOMNormalizer</name>.
                                                <name>abort</name>
                                            </name>
                                        </expr>
                                        )
                                    </condition>
                                    <then>
                                        <block>{
                                            <comment type="line">// stopped at user request</comment>
                                            <return>return <expr>false</expr>;
                                            </return>
                                            }
                                        </block>
                                    </then>
                                </if>
                                <throw>throw
                                    <expr>new
                                        <call>
                                            <name>LSException</name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>LSException</name>.
                                                            <name>SERIALIZE_ERR</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                ,
                                                <argument>
                                                    <expr>
                                                        <call>
                                                            <name><name>e</name>.
                                                                <name>toString</name>
                                                            </name>
                                                            <argument_list>()</argument_list>
                                                        </call>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </throw>
                                }
                            </block>
                        </catch>
                        <catch>catch (
                            <param>
                                <decl>
                                    <type>
                                        <name>Exception</name>
                                    </type>
                                    <name>e</name>
                                </decl>
                            </param>
                            )
                            <block>{
                                <if>if
                                    <condition>(
                                        <expr>
                                            <name><name>ser</name>.
                                                <name>fDOMErrorHandler</name>
                                            </name>
                                            !=
                                            <name>null</name>
                                        </expr>
                                        )
                                    </condition>
                                    <then>
                                        <block>{
                                            <decl_stmt>
                                                <decl>
                                                    <type>
                                                        <name>DOMErrorImpl</name>
                                                    </type>
                                                    <name>error</name> =
                                                    <init>
                                                        <expr>new
                                                            <call>
                                                                <name>DOMErrorImpl</name>
                                                                <argument_list>()</argument_list>
                                                            </call>
                                                        </expr>
                                                    </init>
                                                </decl>
                                                ;
                                            </decl_stmt>
                                            <expr_stmt>
                                                <expr>
                                                    <name><name>error</name>.
                                                        <name>fException</name>
                                                    </name>
                                                    =
                                                    <name>e</name>
                                                </expr>
                                                ;
                                            </expr_stmt>
                                            <expr_stmt>
                                                <expr>
                                                    <name><name>error</name>.
                                                        <name>fMessage</name>
                                                    </name>
                                                    =
                                                    <call>
                                                        <name><name>e</name>.
                                                            <name>getMessage</name>
                                                        </name>
                                                        <argument_list>()</argument_list>
                                                    </call>
                                                </expr>
                                                ;
                                            </expr_stmt>
                                            <expr_stmt>
                                                <expr>
                                                    <name><name>error</name>.
                                                        <name>fSeverity</name>
                                                    </name>
                                                    =
                                                    <name><name>DOMError</name>.
                                                        <name>SEVERITY_ERROR</name>
                                                    </name>
                                                </expr>
                                                ;
                                            </expr_stmt>
                                            <expr_stmt>
                                                <expr>
                                                    <call>
                                                        <name><name>ser</name>.<name>fDOMErrorHandler</name>.
                                                            <name>handleError</name>
                                                        </name>
                                                        <argument_list>(
                                                            <argument>
                                                                <expr>
                                                                    <name>error</name>
                                                                </expr>
                                                            </argument>
                                                            )
                                                        </argument_list>
                                                    </call>
                                                </expr>
                                                ;
                                            </expr_stmt>
                                            }
                                        </block>
                                    </then>
                                </if>
                                <throw>throw
                                    <expr>new
                                        <call>
                                            <name>LSException</name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <name><name>LSException</name>.
                                                            <name>SERIALIZE_ERR</name>
                                                        </name>
                                                    </expr>
                                                </argument>
                                                ,
                                                <argument>
                                                    <expr>
                                                        <call>
                                                            <name><name>e</name>.
                                                                <name>toString</name>
                                                            </name>
                                                            <argument_list>()</argument_list>
                                                        </call>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </throw>
                                }
                            </block>
                        </catch>
                    </try>
                    <return>return <expr>true</expr>;
                    </return>
                    }
                </block>
            </function>
            <comment type="line">//writeURI</comment>


            <comment type="line">//</comment>
            <comment type="line">// Private methods</comment>
            <comment type="line">//</comment>

            <function>
                <type>
                    <specifier>private</specifier>
                    <name>void</name>
                </type>
                <name>prepareForSerialization</name>
                <parameter_list>(
                    <param>
                        <decl>
                            <type>
                                <name>XMLSerializer</name>
                            </type>
                            <name>ser</name>
                        </decl>
                    </param>
                    ,
                    <param>
                        <decl>
                            <type>
                                <name>Node</name>
                            </type>
                            <name>node</name>
                        </decl>
                    </param>
                    )
                </parameter_list>
                <block>{
                    <expr_stmt>
                        <expr>
                            <call>
                                <name><name>ser</name>.
                                    <name>reset</name>
                                </name>
                                <argument_list>()</argument_list>
                            </call>
                        </expr>
                        ;
                    </expr_stmt>
                    <expr_stmt>
                        <expr>
                            <name><name>ser</name>.
                                <name>features</name>
                            </name>
                            =
                            <name>features</name>
                        </expr>
                        ;
                    </expr_stmt>
                    <expr_stmt>
                        <expr>
                            <name><name>ser</name>.
                                <name>fDOMErrorHandler</name>
                            </name>
                            =
                            <name>fErrorHandler</name>
                        </expr>
                        ;
                    </expr_stmt>
                    <expr_stmt>
                        <expr>
                            <name><name>ser</name>.
                                <name>fNamespaces</name>
                            </name>
                            = (<name>features</name> &amp; <name>NAMESPACES</name>) != 0
                        </expr>
                        ;
                    </expr_stmt>
                    <expr_stmt>
                        <expr>
                            <name><name>ser</name>.
                                <name>fNamespacePrefixes</name>
                            </name>
                            = (<name>features</name> &amp; <name>NSDECL</name>) != 0
                        </expr>
                        ;
                    </expr_stmt>
                    <expr_stmt>
                        <expr>
                            <call>
                                <name><name>ser</name>.<name>_format</name>.
                                    <name>setOmitComments</name>
                                </name>
                                <argument_list>(
                                    <argument>
                                        <expr>(<name>features</name> &amp; <name>COMMENTS</name>)==0
                                        </expr>
                                    </argument>
                                    )
                                </argument_list>
                            </call>
                        </expr>
                        ;
                    </expr_stmt>
                    <expr_stmt>
                        <expr>
                            <call>
                                <name><name>ser</name>.<name>_format</name>.
                                    <name>setOmitXMLDeclaration</name>
                                </name>
                                <argument_list>(
                                    <argument>
                                        <expr>(<name>features</name> &amp; <name>XMLDECL</name>) == 0
                                        </expr>
                                    </argument>
                                    )
                                </argument_list>
                            </call>
                        </expr>
                        ;
                    </expr_stmt>

                    <if>if
                        <condition>(
                            <expr>(<name>features</name> &amp; <name>WELLFORMED</name>) != 0
                            </expr>
                            )
                        </condition>
                        <then>
                            <block>{
                                <comment type="line">// REVISIT: this is inefficient implementation of well-formness.
                                    Instead, we should check
                                </comment>
                                <comment type="line">// well-formness as we serialize the tree</comment>
                                <decl_stmt>
                                    <decl>
                                        <type>
                                            <name>Node</name>
                                        </type>
                                        <name>next</name>,
                                        <name>root</name>
                                    </decl>
                                    ;
                                </decl_stmt>
                                <expr_stmt>
                                    <expr>
                                        <name>root</name>
                                        =
                                        <name>node</name>
                                    </expr>
                                    ;
                                </expr_stmt>
                                <decl_stmt>
                                    <decl>
                                        <type>
                                            <name>Method</name>
                                        </type>
                                        <name>versionChanged</name>
                                    </decl>
                                    ;
                                </decl_stmt>
                                <decl_stmt>
                                    <decl>
                                        <type>
                                            <name>boolean</name>
                                        </type>
                                        <name>verifyNames</name> =
                                        <init>
                                            <expr>true</expr>
                                        </init>
                                    </decl>
                                    ;
                                </decl_stmt>
                                <decl_stmt>
                                    <decl>
                                        <type>
                                            <name>Document</name>
                                        </type>
                                        <name>document</name> =
                                        <init>
                                            <expr>(
                                                <call>
                                                    <name><name>node</name>.
                                                        <name>getNodeType</name>
                                                    </name>
                                                    <argument_list>()</argument_list>
                                                </call>
                                                ==
                                                <name><name>Node</name>.
                                                    <name>DOCUMENT_NODE</name>
                                                </name>
                                                )
                                                ? (<name>Document</name>)
                                                <name>node</name>
                                                :
                                                <call>
                                                    <name><name>node</name>.
                                                        <name>getOwnerDocument</name>
                                                    </name>
                                                    <argument_list>()</argument_list>
                                                </call>
                                            </expr>
                                        </init>
                                    </decl>
                                    ;
                                </decl_stmt>
                                <try>try
                                    <block>{
                                        <expr_stmt>
                                            <expr>
                                                <name>versionChanged</name>
                                                =
                                                <call>
                                                    <name><name>document</name>.
                                                        <name>getClass</name>
                                                    </name>
                                                    <argument_list>()</argument_list>
                                                </call>
                                                .
                                                <call>
                                                    <name>getMethod</name>
                                                    <argument_list>(
                                                        <argument>
                                                            <expr>"isXMLVersionChanged()"</expr>
                                                        </argument>
                                                        ,
                                                        <argument>
                                                            <expr>new
                                                                <name>
                                                                    <name>Class</name>
                                                                    <index>[]</index>
                                                                </name>
                                                                <block>{}</block>
                                                            </expr>
                                                        </argument>
                                                        )
                                                    </argument_list>
                                                </call>
                                            </expr>
                                            ;
                                        </expr_stmt>
                                        <if>if
                                            <condition>(
                                                <expr>
                                                    <name>versionChanged</name>
                                                    !=
                                                    <name>null</name>
                                                </expr>
                                                )
                                            </condition>
                                            <then>
                                                <block>{
                                                    <expr_stmt>
                                                        <expr>
                                                            <name>verifyNames</name>
                                                            = ((<name>Boolean</name>)
                                                            <call>
                                                                <name><name>versionChanged</name>.
                                                                    <name>invoke</name>
                                                                </name>
                                                                <argument_list>(
                                                                    <argument>
                                                                        <expr>
                                                                            <name>document</name>
                                                                        </expr>
                                                                    </argument>
                                                                    ,
                                                                    <argument>
                                                                        <expr>(
                                                                            <name>
                                                                                <name>Object</name>
                                                                                <index>[]</index>
                                                                            </name>
                                                                            )
                                                                            <name>null</name>
                                                                        </expr>
                                                                    </argument>
                                                                    )
                                                                </argument_list>
                                                            </call>
                                                            ).
                                                            <call>
                                                                <name>booleanValue</name>
                                                                <argument_list>()</argument_list>
                                                            </call>
                                                        </expr>
                                                        ;
                                                    </expr_stmt>
                                                    }
                                                </block>
                                            </then>
                                        </if>
                                        }
                                    </block>
                                    <catch>catch (
                                        <param>
                                            <decl>
                                                <type>
                                                    <name>Exception</name>
                                                </type>
                                                <name>e</name>
                                            </decl>
                                        </param>
                                        )
                                        <block>{
                                            <comment type="line">//no way to test the version...</comment>
                                            <comment type="line">//ignore the exception</comment>
                                            }
                                        </block>
                                    </catch>
                                </try>
                                <if>if
                                    <condition>(
                                        <expr>
                                            <call>
                                                <name><name>node</name>.
                                                    <name>getFirstChild</name>
                                                </name>
                                                <argument_list>()</argument_list>
                                            </call>
                                            !=
                                            <name>null</name>
                                        </expr>
                                        )
                                    </condition>
                                    <then>
                                        <block>{
                                            <while>while
                                                <condition>(
                                                    <expr>
                                                        <name>node</name>
                                                        !=
                                                        <name>null</name>
                                                    </expr>
                                                    )
                                                </condition>
                                                <block>{
                                                    <expr_stmt>
                                                        <expr>
                                                            <call>
                                                                <name>verify</name>
                                                                <argument_list>(
                                                                    <argument>
                                                                        <expr>
                                                                            <name>node</name>
                                                                        </expr>
                                                                    </argument>
                                                                    ,
                                                                    <argument>
                                                                        <expr>
                                                                            <name>verifyNames</name>
                                                                        </expr>
                                                                    </argument>
                                                                    ,
                                                                    <argument>
                                                                        <expr>false</expr>
                                                                    </argument>
                                                                    )
                                                                </argument_list>
                                                            </call>
                                                        </expr>
                                                        ;
                                                    </expr_stmt>
                                                    <comment type="line">// Move down to first child</comment>
                                                    <expr_stmt>
                                                        <expr>
                                                            <name>next</name>
                                                            =
                                                            <call>
                                                                <name><name>node</name>.
                                                                    <name>getFirstChild</name>
                                                                </name>
                                                                <argument_list>()</argument_list>
                                                            </call>
                                                        </expr>
                                                        ;
                                                    </expr_stmt>
                                                    <comment type="line">// No child nodes, so walk tree</comment>
                                                    <while>while
                                                        <condition>(
                                                            <expr>
                                                                <name>next</name>
                                                                ==
                                                                <name>null</name>
                                                            </expr>
                                                            )
                                                        </condition>
                                                        <block>{
                                                            <comment type="line">// Move to sibling if possible.
                                                            </comment>
                                                            <expr_stmt>
                                                                <expr>
                                                                    <name>next</name>
                                                                    =
                                                                    <call>
                                                                        <name><name>node</name>.
                                                                            <name>getNextSibling</name>
                                                                        </name>
                                                                        <argument_list>()</argument_list>
                                                                    </call>
                                                                </expr>
                                                                ;
                                                            </expr_stmt>
                                                            <if>if
                                                                <condition>(
                                                                    <expr>
                                                                        <name>next</name>
                                                                        ==
                                                                        <name>null</name>
                                                                    </expr>
                                                                    )
                                                                </condition>
                                                                <then>
                                                                    <block>{
                                                                        <expr_stmt>
                                                                            <expr>
                                                                                <name>node</name>
                                                                                =
                                                                                <call>
                                                                                    <name><name>node</name>.
                                                                                        <name>getParentNode</name>
                                                                                    </name>
                                                                                    <argument_list>()</argument_list>
                                                                                </call>
                                                                            </expr>
                                                                            ;
                                                                        </expr_stmt>
                                                                        <if>if
                                                                            <condition>(
                                                                                <expr>
                                                                                    <name>root</name>
                                                                                    ==
                                                                                    <name>node</name>
                                                                                </expr>
                                                                                )
                                                                            </condition>
                                                                            <then>
                                                                                <block>{
                                                                                    <expr_stmt>
                                                                                        <expr>
                                                                                            <name>next</name>
                                                                                            =
                                                                                            <name>null</name>
                                                                                        </expr>
                                                                                        ;
                                                                                    </expr_stmt>
                                                                                    <break>break;</break>
                                                                                    }
                                                                                </block>
                                                                            </then>
                                                                        </if>
                                                                        <expr_stmt>
                                                                            <expr>
                                                                                <name>next</name>
                                                                                =
                                                                                <call>
                                                                                    <name><name>node</name>.
                                                                                        <name>getNextSibling</name>
                                                                                    </name>
                                                                                    <argument_list>()</argument_list>
                                                                                </call>
                                                                            </expr>
                                                                            ;
                                                                        </expr_stmt>
                                                                        }
                                                                    </block>
                                                                </then>
                                                            </if>
                                                            }
                                                        </block>
                                                    </while>
                                                    <expr_stmt>
                                                        <expr>
                                                            <name>node</name>
                                                            =
                                                            <name>next</name>
                                                        </expr>
                                                        ;
                                                    </expr_stmt>
                                                    }
                                                </block>
                                            </while>
                                            }
                                        </block>
                                    </then>
                                    <else>else
                                        <block>{
                                            <expr_stmt>
                                                <expr>
                                                    <call>
                                                        <name>verify</name>
                                                        <argument_list>(
                                                            <argument>
                                                                <expr>
                                                                    <name>node</name>
                                                                </expr>
                                                            </argument>
                                                            ,
                                                            <argument>
                                                                <expr>
                                                                    <name>verifyNames</name>
                                                                </expr>
                                                            </argument>
                                                            ,
                                                            <argument>
                                                                <expr>false</expr>
                                                            </argument>
                                                            )
                                                        </argument_list>
                                                    </call>
                                                </expr>
                                                ;
                                            </expr_stmt>
                                            }
                                        </block>
                                    </else>
                                </if>
                                }
                            </block>
                        </then>
                    </if>
                    }
                </block>
            </function>


            <function>
                <type>
                    <specifier>private</specifier>
                    <name>void</name>
                </type>
                <name>verify</name>
                <parameter_list>(
                    <param>
                        <decl>
                            <type>
                                <name>Node</name>
                            </type>
                            <name>node</name>
                        </decl>
                    </param>
                    ,
                    <param>
                        <decl>
                            <type>
                                <name>boolean</name>
                            </type>
                            <name>verifyNames</name>
                        </decl>
                    </param>
                    ,
                    <param>
                        <decl>
                            <type>
                                <name>boolean</name>
                            </type>
                            <name>xml11Version</name>
                        </decl>
                    </param>
                    )
                </parameter_list>
                <block>{

                    <decl_stmt>
                        <decl>
                            <type>
                                <name>int</name>
                            </type>
                            <name>type</name> =
                            <init>
                                <expr>
                                    <call>
                                        <name><name>node</name>.
                                            <name>getNodeType</name>
                                        </name>
                                        <argument_list>()</argument_list>
                                    </call>
                                </expr>
                            </init>
                        </decl>
                        ;
                    </decl_stmt>
                    <expr_stmt>
                        <expr>
                            <name><name>fLocator</name>.
                                <name>fRelatedNode</name>
                            </name>
                            =
                            <name>node</name>
                        </expr>
                        ;
                    </expr_stmt>
                    <decl_stmt>
                        <decl>
                            <type>
                                <name>boolean</name>
                            </type>
                            <name>wellformed</name>
                        </decl>
                        ;
                    </decl_stmt>
                    <switch>switch
                        <condition>(
                            <expr>
                                <name>type</name>
                            </expr>
                            )
                        </condition>
                        <block>{
                            <case>case
                                <expr>
                                    <name><name>Node</name>.
                                        <name>DOCUMENT_NODE</name>
                                    </name>
                                </expr>
                                :
                                <block>{
                                    <break>break;</break>
                                    }
                                </block>
                            </case>
                            <case>case
                                <expr>
                                    <name><name>Node</name>.
                                        <name>DOCUMENT_TYPE_NODE</name>
                                    </name>
                                </expr>
                                :
                                <block>{
                                    <break>break;</break>
                                    }
                                </block>
                            </case>
                            <case>case
                                <expr>
                                    <name><name>Node</name>.
                                        <name>ELEMENT_NODE</name>
                                    </name>
                                </expr>
                                :
                                <block>{
                                    <if>if
                                        <condition>(
                                            <expr>
                                                <name>verifyNames</name>
                                            </expr>
                                            )
                                        </condition>
                                        <then>
                                            <block>{
                                                <if>if
                                                    <condition>(
                                                        <expr>(<name>features</name> &amp; <name>NAMESPACES</name>) != 0
                                                        </expr>
                                                        )
                                                    </condition>
                                                    <then>
                                                        <block>{
                                                            <expr_stmt>
                                                                <expr>
                                                                    <name>wellformed</name>
                                                                    =
                                                                    <call>
                                                                        <name><name>CoreDocumentImpl</name>.
                                                                            <name>isValidQName</name>
                                                                        </name>
                                                                        <argument_list>(
                                                                            <argument>
                                                                                <expr>
                                                                                    <call>
                                                                                        <name><name>node</name>.
                                                                                            <name>getPrefix</name>
                                                                                        </name>
                                                                                        <argument_list>()
                                                                                        </argument_list>
                                                                                    </call>
                                                                                </expr>
                                                                            </argument>
                                                                            ,
                                                                            <argument>
                                                                                <expr>
                                                                                    <call>
                                                                                        <name><name>node</name>.
                                                                                            <name>getLocalName</name>
                                                                                        </name>
                                                                                        <argument_list>()
                                                                                        </argument_list>
                                                                                    </call>
                                                                                </expr>
                                                                            </argument>
                                                                            ,
                                                                            <argument>
                                                                                <expr>
                                                                                    <name>xml11Version</name>
                                                                                </expr>
                                                                            </argument>
                                                                            )
                                                                        </argument_list>
                                                                    </call>
                                                                </expr>
                                                                ;
                                                            </expr_stmt>
                                                            }
                                                        </block>
                                                    </then>
                                                    <else>else
                                                        <block>{
                                                            <expr_stmt>
                                                                <expr>
                                                                    <name>wellformed</name>
                                                                    =
                                                                    <call>
                                                                        <name><name>CoreDocumentImpl</name>.
                                                                            <name>isXMLName</name>
                                                                        </name>
                                                                        <argument_list>(
                                                                            <argument>
                                                                                <expr>
                                                                                    <call>
                                                                                        <name><name>node</name>.
                                                                                            <name>getNodeName</name>
                                                                                        </name>
                                                                                        <argument_list>()
                                                                                        </argument_list>
                                                                                    </call>
                                                                                </expr>
                                                                            </argument>
                                                                            ,
                                                                            <argument>
                                                                                <expr>
                                                                                    <name>xml11Version</name>
                                                                                </expr>
                                                                            </argument>
                                                                            )
                                                                        </argument_list>
                                                                    </call>
                                                                </expr>
                                                                ;
                                                            </expr_stmt>
                                                            }
                                                        </block>
                                                    </else>
                                                </if>
                                                <if>if
                                                    <condition>(
                                                        <expr>!
                                                            <name>wellformed</name>
                                                        </expr>
                                                        )
                                                    </condition>
                                                    <then>
                                                        <block>{
                                                            <if>if
                                                                <condition>(
                                                                    <expr>!
                                                                        <name>wellformed</name>
                                                                    </expr>
                                                                    )
                                                                </condition>
                                                                <then>
                                                                    <block>{
                                                                        <if>if
                                                                            <condition>(
                                                                                <expr>
                                                                                    <name>fErrorHandler</name>
                                                                                    !=
                                                                                    <name>null</name>
                                                                                </expr>
                                                                                )
                                                                            </condition>
                                                                            <then>
                                                                                <block>{
                                                                                    <decl_stmt>
                                                                                        <decl>
                                                                                            <type>
                                                                                                <name>String</name>
                                                                                            </type>
                                                                                            <name>msg</name> =
                                                                                            <init>
                                                                                                <expr>
                                                                                                    <call>
                                                                                                        <name><name>
                                                                                                            DOMMessageFormatter</name>
                                                                                                            .
                                                                                                            <name>
                                                                                                                formatMessage
                                                                                                            </name>
                                                                                                        </name>
                                                                                                        <argument_list>(
                                                                                                            <argument>
                                                                                                                <expr>
                                                                                                                    <name>
                                                                                                                        <name>
                                                                                                                            DOMMessageFormatter</name>
                                                                                                                        .
                                                                                                                        <name>
                                                                                                                            DOM_DOMAIN
                                                                                                                        </name>
                                                                                                                    </name>
                                                                                                                </expr>
                                                                                                            </argument>
                                                                                                            ,
                                                                                                            <argument>
                                                                                                                <expr>
                                                                                                                    "wf-invalid-character-in-node-name"
                                                                                                                </expr>
                                                                                                            </argument>
                                                                                                            ,
                                                                                                            <argument>
                                                                                                                <expr>
                                                                                                                    new
                                                                                                                    <name>
                                                                                                                        <name>
                                                                                                                            Object
                                                                                                                        </name>
                                                                                                                        <index>
                                                                                                                            []
                                                                                                                        </index>
                                                                                                                    </name>
                                                                                                                    <block>
                                                                                                                        {<expr>
                                                                                                                        "Element"</expr>,
                                                                                                                        <expr>
                                                                                                                            <call>
                                                                                                                                <name>
                                                                                                                                    <name>
                                                                                                                                        node</name>
                                                                                                                                    .
                                                                                                                                    <name>
                                                                                                                                        getNodeName
                                                                                                                                    </name>
                                                                                                                                </name>
                                                                                                                                <argument_list>
                                                                                                                                    ()
                                                                                                                                </argument_list>
                                                                                                                            </call>
                                                                                                                        </expr>
                                                                                                                        }
                                                                                                                    </block>
                                                                                                                </expr>
                                                                                                            </argument>
                                                                                                            )
                                                                                                        </argument_list>
                                                                                                    </call>
                                                                                                </expr>
                                                                                            </init>
                                                                                        </decl>
                                                                                        ;
                                                                                    </decl_stmt>
                                                                                    <expr_stmt>
                                                                                        <expr>
                                                                                            <call>
                                                                                                <name><name>
                                                                                                    DOMNormalizer</name>
                                                                                                    .
                                                                                                    <name>
                                                                                                        reportDOMError
                                                                                                    </name>
                                                                                                </name>
                                                                                                <argument_list>(
                                                                                                    <argument>
                                                                                                        <expr>
                                                                                                            <name>
                                                                                                                fErrorHandler
                                                                                                            </name>
                                                                                                        </expr>
                                                                                                    </argument>
                                                                                                    ,
                                                                                                    <argument>
                                                                                                        <expr>
                                                                                                            <name>
                                                                                                                fError
                                                                                                            </name>
                                                                                                        </expr>
                                                                                                    </argument>
                                                                                                    ,
                                                                                                    <argument>
                                                                                                        <expr>
                                                                                                            <name>
                                                                                                                fLocator
                                                                                                            </name>
                                                                                                        </expr>
                                                                                                    </argument>
                                                                                                    ,
                                                                                                    <argument>
                                                                                                        <expr>
                                                                                                            <name>msg
                                                                                                            </name>
                                                                                                        </expr>
                                                                                                    </argument>
                                                                                                    ,
                                                                                                    <argument>
                                                                                                        <expr>
                                                                                                            <name><name>
                                                                                                                DOMError</name>
                                                                                                                .
                                                                                                                <name>
                                                                                                                    SEVERITY_FATAL_ERROR
                                                                                                                </name>
                                                                                                            </name>
                                                                                                        </expr>
                                                                                                    </argument>
                                                                                                    ,
                                                                                                    <argument>
                                                                                                        <expr>
                                                                                                            "wf-invalid-character-in-node-name"
                                                                                                        </expr>
                                                                                                    </argument>
                                                                                                    )
                                                                                                </argument_list>
                                                                                            </call>
                                                                                        </expr>
                                                                                        ;
                                                                                    </expr_stmt>
                                                                                    }
                                                                                </block>
                                                                            </then>
                                                                        </if>

                                                                        }
                                                                    </block>
                                                                </then>
                                                            </if>
                                                            }
                                                        </block>
                                                    </then>
                                                </if>
                                                }
                                            </block>
                                        </then>
                                    </if>

                                    <decl_stmt>
                                        <decl>
                                            <type>
                                                <name>NamedNodeMap</name>
                                            </type>
                                            <name>attributes</name> =
                                            <init>
                                                <expr>(
                                                    <call>
                                                        <name><name>node</name>.
                                                            <name>hasAttributes</name>
                                                        </name>
                                                        <argument_list>()</argument_list>
                                                    </call>
                                                    ) ?
                                                    <call>
                                                        <name><name>node</name>.
                                                            <name>getAttributes</name>
                                                        </name>
                                                        <argument_list>()</argument_list>
                                                    </call>
                                                    :
                                                    <name>null</name>
                                                </expr>
                                            </init>
                                        </decl>
                                        ;
                                    </decl_stmt>
                                    <if>if
                                        <condition>(
                                            <expr>
                                                <name>attributes</name>
                                                !=
                                                <name>null</name>
                                            </expr>
                                            )
                                        </condition>
                                        <then>
                                            <block>{
                                                <for>for (
                                                    <init>
                                                        <decl>
                                                            <type>
                                                                <name>int</name>
                                                            </type>
                                                            <name>i</name> =
                                                            <init>
                                                                <expr>0</expr>
                                                            </init>
                                                        </decl>
                                                        ;
                                                    </init>
                                                    <condition>
                                                        <expr>
                                                            <name>i</name>
                                                            &lt;
                                                            <call>
                                                                <name><name>attributes</name>.
                                                                    <name>getLength</name>
                                                                </name>
                                                                <argument_list>()</argument_list>
                                                            </call>
                                                        </expr>
                                                        ;
                                                    </condition>
                                                    <incr>
                                                        <expr>++
                                                            <name>i</name>
                                                        </expr>
                                                    </incr>
                                                    )
                                                    <block>{
                                                        <decl_stmt>
                                                            <decl>
                                                                <type>
                                                                    <name>Attr</name>
                                                                </type>
                                                                <name>attr</name> =
                                                                <init>
                                                                    <expr>(<name>Attr</name>)
                                                                        <call>
                                                                            <name><name>attributes</name>.
                                                                                <name>item</name>
                                                                            </name>
                                                                            <argument_list>(
                                                                                <argument>
                                                                                    <expr>
                                                                                        <name>i</name>
                                                                                    </expr>
                                                                                </argument>
                                                                                )
                                                                            </argument_list>
                                                                        </call>
                                                                    </expr>
                                                                </init>
                                                            </decl>
                                                            ;
                                                        </decl_stmt>
                                                        <expr_stmt>
                                                            <expr>
                                                                <name><name>fLocator</name>.
                                                                    <name>fRelatedNode</name>
                                                                </name>
                                                                =
                                                                <name>attr</name>
                                                            </expr>
                                                            ;
                                                        </expr_stmt>
                                                        <expr_stmt>
                                                            <expr>
                                                                <call>
                                                                    <name><name>DOMNormalizer</name>.
                                                                        <name>isAttrValueWF</name>
                                                                    </name>
                                                                    <argument_list>(
                                                                        <argument>
                                                                            <expr>
                                                                                <name>fErrorHandler</name>
                                                                            </expr>
                                                                        </argument>
                                                                        ,
                                                                        <argument>
                                                                            <expr>
                                                                                <name>fError</name>
                                                                            </expr>
                                                                        </argument>
                                                                        ,
                                                                        <argument>
                                                                            <expr>
                                                                                <name>fLocator</name>
                                                                            </expr>
                                                                        </argument>
                                                                        ,
                                                                        <argument>
                                                                            <expr>
                                                                                <name>attributes</name>
                                                                            </expr>
                                                                        </argument>
                                                                        ,
                                                                        <argument>
                                                                            <expr>
                                                                                <name>attr</name>
                                                                            </expr>
                                                                        </argument>
                                                                        ,
                                                                        <argument>
                                                                            <expr>
                                                                                <call>
                                                                                    <name><name>attr</name>.
                                                                                        <name>getValue</name>
                                                                                    </name>
                                                                                    <argument_list>()</argument_list>
                                                                                </call>
                                                                            </expr>
                                                                        </argument>
                                                                        ,
                                                                        <argument>
                                                                            <expr>
                                                                                <name>xml11Version</name>
                                                                            </expr>
                                                                        </argument>
                                                                        )
                                                                    </argument_list>
                                                                </call>
                                                            </expr>
                                                            ;
                                                        </expr_stmt>
                                                        <if>if
                                                            <condition>(
                                                                <expr>
                                                                    <name>verifyNames</name>
                                                                </expr>
                                                                )
                                                            </condition>
                                                            <then>
                                                                <block>{
                                                                    <expr_stmt>
                                                                        <expr>
                                                                            <name>wellformed</name>
                                                                            =
                                                                            <call>
                                                                                <name><name>CoreDocumentImpl</name>.
                                                                                    <name>isXMLName</name>
                                                                                </name>
                                                                                <argument_list>(
                                                                                    <argument>
                                                                                        <expr>
                                                                                            <call>
                                                                                                <name><name>attr</name>.
                                                                                                    <name>getNodeName
                                                                                                    </name>
                                                                                                </name>
                                                                                                <argument_list>()
                                                                                                </argument_list>
                                                                                            </call>
                                                                                        </expr>
                                                                                    </argument>
                                                                                    ,
                                                                                    <argument>
                                                                                        <expr>
                                                                                            <name>xml11Version</name>
                                                                                        </expr>
                                                                                    </argument>
                                                                                    )
                                                                                </argument_list>
                                                                            </call>
                                                                        </expr>
                                                                        ;
                                                                    </expr_stmt>
                                                                    <if>if
                                                                        <condition>(
                                                                            <expr>!
                                                                                <name>wellformed</name>
                                                                            </expr>
                                                                            )
                                                                        </condition>
                                                                        <then>
                                                                            <block>{
                                                                                <decl_stmt>
                                                                                    <decl>
                                                                                        <type>
                                                                                            <name>String</name>
                                                                                        </type>
                                                                                        <name>msg</name> =
                                                                                        <init>
                                                                                            <expr>
                                                                                                <call>
                                                                                                    <name><name>
                                                                                                        DOMMessageFormatter</name>
                                                                                                        .
                                                                                                        <name>
                                                                                                            formatMessage
                                                                                                        </name>
                                                                                                    </name>
                                                                                                    <argument_list>(
                                                                                                        <argument>
                                                                                                            <expr>
                                                                                                                <name>
                                                                                                                    <name>
                                                                                                                        DOMMessageFormatter</name>
                                                                                                                    .
                                                                                                                    <name>
                                                                                                                        DOM_DOMAIN
                                                                                                                    </name>
                                                                                                                </name>
                                                                                                            </expr>
                                                                                                        </argument>
                                                                                                        ,
                                                                                                        <argument>
                                                                                                            <expr>
                                                                                                                "wf-invalid-character-in-node-name"
                                                                                                            </expr>
                                                                                                        </argument>
                                                                                                        ,
                                                                                                        <argument>
                                                                                                            <expr>new
                                                                                                                <name>
                                                                                                                    <name>
                                                                                                                        Object
                                                                                                                    </name>
                                                                                                                    <index>
                                                                                                                        []
                                                                                                                    </index>
                                                                                                                </name>
                                                                                                                <block>{ <expr>
                                                                                                                    "Attr"</expr>,
                                                                                                                    <expr>
                                                                                                                        <call>
                                                                                                                            <name>
                                                                                                                                <name>
                                                                                                                                    node</name>
                                                                                                                                .
                                                                                                                                <name>
                                                                                                                                    getNodeName
                                                                                                                                </name>
                                                                                                                            </name>
                                                                                                                            <argument_list>
                                                                                                                                ()
                                                                                                                            </argument_list>
                                                                                                                        </call>
                                                                                                                    </expr>
                                                                                                                    }
                                                                                                                </block>
                                                                                                            </expr>
                                                                                                        </argument>
                                                                                                        )
                                                                                                    </argument_list>
                                                                                                </call>
                                                                                            </expr>
                                                                                        </init>
                                                                                    </decl>
                                                                                    ;
                                                                                </decl_stmt>
                                                                                <expr_stmt>
                                                                                    <expr>
                                                                                        <call>
                                                                                            <name><name>
                                                                                                DOMNormalizer</name>.
                                                                                                <name>reportDOMError
                                                                                                </name>
                                                                                            </name>
                                                                                            <argument_list>(
                                                                                                <argument>
                                                                                                    <expr>
                                                                                                        <name>
                                                                                                            fErrorHandler
                                                                                                        </name>
                                                                                                    </expr>
                                                                                                </argument>
                                                                                                ,
                                                                                                <argument>
                                                                                                    <expr>
                                                                                                        <name>fError
                                                                                                        </name>
                                                                                                    </expr>
                                                                                                </argument>
                                                                                                ,
                                                                                                <argument>
                                                                                                    <expr>
                                                                                                        <name>fLocator
                                                                                                        </name>
                                                                                                    </expr>
                                                                                                </argument>
                                                                                                ,
                                                                                                <argument>
                                                                                                    <expr>
                                                                                                        <name>msg</name>
                                                                                                    </expr>
                                                                                                </argument>
                                                                                                ,
                                                                                                <argument>
                                                                                                    <expr>
                                                                                                        <name><name>
                                                                                                            DOMError</name>
                                                                                                            .
                                                                                                            <name>
                                                                                                                SEVERITY_FATAL_ERROR
                                                                                                            </name>
                                                                                                        </name>
                                                                                                    </expr>
                                                                                                </argument>
                                                                                                ,
                                                                                                <argument>
                                                                                                    <expr>
                                                                                                        "wf-invalid-character-in-node-name"
                                                                                                    </expr>
                                                                                                </argument>
                                                                                                )
                                                                                            </argument_list>
                                                                                        </call>
                                                                                    </expr>
                                                                                    ;
                                                                                </expr_stmt>
                                                                                }
                                                                            </block>
                                                                        </then>
                                                                    </if>
                                                                    }
                                                                </block>
                                                            </then>
                                                        </if>
                                                        }
                                                    </block>
                                                </for>

                                                }
                                            </block>
                                        </then>
                                    </if>

                                    <break>break;</break>
                                    }
                                </block>

                            </case>
                            <case>case
                                <expr>
                                    <name><name>Node</name>.
                                        <name>COMMENT_NODE</name>
                                    </name>
                                </expr>
                                :
                                <block>{
                                    <comment type="line">// only verify well-formness if comments included in the tree
                                    </comment>
                                    <if>if
                                        <condition>(
                                            <expr>(<name>features</name> &amp; <name>COMMENTS</name>) != 0
                                            </expr>
                                            )
                                        </condition>
                                        <then>
                                            <expr_stmt>
                                                <expr>
                                                    <call>
                                                        <name><name>DOMNormalizer</name>.
                                                            <name>isCommentWF</name>
                                                        </name>
                                                        <argument_list>(
                                                            <argument>
                                                                <expr>
                                                                    <name>fErrorHandler</name>
                                                                </expr>
                                                            </argument>
                                                            ,
                                                            <argument>
                                                                <expr>
                                                                    <name>fError</name>
                                                                </expr>
                                                            </argument>
                                                            ,
                                                            <argument>
                                                                <expr>
                                                                    <name>fLocator</name>
                                                                </expr>
                                                            </argument>
                                                            ,
                                                            <argument>
                                                                <expr>((<name>Comment</name>)<name>node</name>).
                                                                    <call>
                                                                        <name>getData</name>
                                                                        <argument_list>()</argument_list>
                                                                    </call>
                                                                </expr>
                                                            </argument>
                                                            ,
                                                            <argument>
                                                                <expr>
                                                                    <name>xml11Version</name>
                                                                </expr>
                                                            </argument>
                                                            )
                                                        </argument_list>
                                                    </call>
                                                </expr>
                                                ;
                                            </expr_stmt>
                                        </then>
                                    </if>
                                    <break>break;</break>
                                    }
                                </block>
                            </case>
                            <case>case
                                <expr>
                                    <name><name>Node</name>.
                                        <name>ENTITY_REFERENCE_NODE</name>
                                    </name>
                                </expr>
                                :
                                <block>{
                                    <comment type="line">// only if entity is preserved in the tree</comment>
                                    <if>if
                                        <condition>(
                                            <expr>
                                                <name>verifyNames</name>
                                                &amp;&amp; (<name>features</name> &amp; <name>ENTITIES</name>) != 0
                                            </expr>
                                            )
                                        </condition>
                                        <then>
                                            <block>{
                                                <expr_stmt>
                                                    <expr>
                                                        <call>
                                                            <name><name>CoreDocumentImpl</name>.
                                                                <name>isXMLName</name>
                                                            </name>
                                                            <argument_list>(
                                                                <argument>
                                                                    <expr>
                                                                        <call>
                                                                            <name><name>node</name>.
                                                                                <name>getNodeName</name>
                                                                            </name>
                                                                            <argument_list>()</argument_list>
                                                                        </call>
                                                                    </expr>
                                                                </argument>
                                                                ,
                                                                <argument>
                                                                    <expr>
                                                                        <name>xml11Version</name>
                                                                    </expr>
                                                                </argument>
                                                                )
                                                            </argument_list>
                                                        </call>
                                                    </expr>
                                                    ;
                                                </expr_stmt>
                                                }
                                            </block>
                                        </then>
                                    </if>
                                    <break>break;</break>

                                    }
                                </block>
                            </case>
                            <case>case
                                <expr>
                                    <name><name>Node</name>.
                                        <name>CDATA_SECTION_NODE</name>
                                    </name>
                                </expr>
                                :
                                <block>{
                                    <comment type="line">// verify content</comment>
                                    <expr_stmt>
                                        <expr>
                                            <call>
                                                <name><name>DOMNormalizer</name>.
                                                    <name>isXMLCharWF</name>
                                                </name>
                                                <argument_list>(
                                                    <argument>
                                                        <expr>
                                                            <name>fErrorHandler</name>
                                                        </expr>
                                                    </argument>
                                                    ,
                                                    <argument>
                                                        <expr>
                                                            <name>fError</name>
                                                        </expr>
                                                    </argument>
                                                    ,
                                                    <argument>
                                                        <expr>
                                                            <name>fLocator</name>
                                                        </expr>
                                                    </argument>
                                                    ,
                                                    <argument>
                                                        <expr>
                                                            <call>
                                                                <name><name>node</name>.
                                                                    <name>getNodeValue</name>
                                                                </name>
                                                                <argument_list>()</argument_list>
                                                            </call>
                                                        </expr>
                                                    </argument>
                                                    ,
                                                    <argument>
                                                        <expr>
                                                            <name>xml11Version</name>
                                                        </expr>
                                                    </argument>
                                                    )
                                                </argument_list>
                                            </call>
                                        </expr>
                                        ;
                                    </expr_stmt>
                                    <comment type="line">// the ]]&gt; string will be checked during serialization
                                    </comment>
                                    <break>break;</break>
                                    }
                                </block>
                            </case>
                            <case>case
                                <expr>
                                    <name><name>Node</name>.
                                        <name>TEXT_NODE</name>
                                    </name>
                                </expr>
                                :
                                <block>{
                                    <expr_stmt>
                                        <expr>
                                            <call>
                                                <name><name>DOMNormalizer</name>.
                                                    <name>isXMLCharWF</name>
                                                </name>
                                                <argument_list>(
                                                    <argument>
                                                        <expr>
                                                            <name>fErrorHandler</name>
                                                        </expr>
                                                    </argument>
                                                    ,
                                                    <argument>
                                                        <expr>
                                                            <name>fError</name>
                                                        </expr>
                                                    </argument>
                                                    ,
                                                    <argument>
                                                        <expr>
                                                            <name>fLocator</name>
                                                        </expr>
                                                    </argument>
                                                    ,
                                                    <argument>
                                                        <expr>
                                                            <call>
                                                                <name><name>node</name>.
                                                                    <name>getNodeValue</name>
                                                                </name>
                                                                <argument_list>()</argument_list>
                                                            </call>
                                                        </expr>
                                                    </argument>
                                                    ,
                                                    <argument>
                                                        <expr>
                                                            <name>xml11Version</name>
                                                        </expr>
                                                    </argument>
                                                    )
                                                </argument_list>
                                            </call>
                                        </expr>
                                        ;
                                    </expr_stmt>
                                    <break>break;</break>
                                    }
                                </block>
                            </case>
                            <case>case
                                <expr>
                                    <name><name>Node</name>.
                                        <name>PROCESSING_INSTRUCTION_NODE</name>
                                    </name>
                                </expr>
                                :
                                <block>{
                                    <decl_stmt>
                                        <decl>
                                            <type>
                                                <name>ProcessingInstruction</name>
                                            </type>
                                            <name>pinode</name> =
                                            <init>
                                                <expr>(<name>ProcessingInstruction</name>)
                                                    <name>node</name>
                                                </expr>
                                            </init>
                                        </decl>
                                        ;
                                    </decl_stmt>
                                    <decl_stmt>
                                        <decl>
                                            <type>
                                                <name>String</name>
                                            </type>
                                            <name>target</name> =
                                            <init>
                                                <expr>
                                                    <call>
                                                        <name><name>pinode</name>.
                                                            <name>getTarget</name>
                                                        </name>
                                                        <argument_list>()</argument_list>
                                                    </call>
                                                </expr>
                                            </init>
                                        </decl>
                                        ;
                                    </decl_stmt>
                                    <if>if
                                        <condition>(
                                            <expr>
                                                <name>verifyNames</name>
                                            </expr>
                                            )
                                        </condition>
                                        <then>
                                            <block>{
                                                <if>if
                                                    <condition>(
                                                        <expr>
                                                            <name>xml11Version</name>
                                                        </expr>
                                                        )
                                                    </condition>
                                                    <then>
                                                        <block>{
                                                            <expr_stmt>
                                                                <expr>
                                                                    <name>wellformed</name>
                                                                    =
                                                                    <call>
                                                                        <name><name>XML11Char</name>.
                                                                            <name>isXML11ValidName</name>
                                                                        </name>
                                                                        <argument_list>(
                                                                            <argument>
                                                                                <expr>
                                                                                    <name>target</name>
                                                                                </expr>
                                                                            </argument>
                                                                            )
                                                                        </argument_list>
                                                                    </call>
                                                                </expr>
                                                                ;
                                                            </expr_stmt>
                                                            }
                                                        </block>
                                                    </then>
                                                    <else>else
                                                        <block>{
                                                            <expr_stmt>
                                                                <expr>
                                                                    <name>wellformed</name>
                                                                    =
                                                                    <call>
                                                                        <name><name>XMLChar</name>.
                                                                            <name>isValidName</name>
                                                                        </name>
                                                                        <argument_list>(
                                                                            <argument>
                                                                                <expr>
                                                                                    <name>target</name>
                                                                                </expr>
                                                                            </argument>
                                                                            )
                                                                        </argument_list>
                                                                    </call>
                                                                </expr>
                                                                ;
                                                            </expr_stmt>
                                                            }
                                                        </block>
                                                    </else>
                                                </if>

                                                <if>if
                                                    <condition>(
                                                        <expr>!
                                                            <name>wellformed</name>
                                                        </expr>
                                                        )
                                                    </condition>
                                                    <then>
                                                        <block>{
                                                            <decl_stmt>
                                                                <decl>
                                                                    <type>
                                                                        <name>String</name>
                                                                    </type>
                                                                    <name>msg</name> =
                                                                    <init>
                                                                        <expr>
                                                                            <call>
                                                                                <name><name>DOMMessageFormatter</name>.
                                                                                    <name>formatMessage</name>
                                                                                </name>
                                                                                <argument_list>(
                                                                                    <argument>
                                                                                        <expr>
                                                                                            <name><name>
                                                                                                DOMMessageFormatter</name>
                                                                                                .
                                                                                                <name>DOM_DOMAIN</name>
                                                                                            </name>
                                                                                        </expr>
                                                                                    </argument>
                                                                                    ,
                                                                                    <argument>
                                                                                        <expr>
                                                                                            "wf-invalid-character-in-node-name"
                                                                                        </expr>
                                                                                    </argument>
                                                                                    ,
                                                                                    <argument>
                                                                                        <expr>new
                                                                                            <name>
                                                                                                <name>Object</name>
                                                                                                <index>[]</index>
                                                                                            </name>
                                                                                            <block>{ <expr>
                                                                                                "Element"</expr>,
                                                                                                <expr>
                                                                                                    <call>
                                                                                                        <name><name>
                                                                                                            node</name>.
                                                                                                            <name>
                                                                                                                getNodeName
                                                                                                            </name>
                                                                                                        </name>
                                                                                                        <argument_list>
                                                                                                            ()
                                                                                                        </argument_list>
                                                                                                    </call>
                                                                                                </expr>
                                                                                                }
                                                                                            </block>
                                                                                        </expr>
                                                                                    </argument>
                                                                                    )
                                                                                </argument_list>
                                                                            </call>
                                                                        </expr>
                                                                    </init>
                                                                </decl>
                                                                ;
                                                            </decl_stmt>
                                                            <expr_stmt>
                                                                <expr>
                                                                    <call>
                                                                        <name><name>DOMNormalizer</name>.
                                                                            <name>reportDOMError</name>
                                                                        </name>
                                                                        <argument_list>(
                                                                            <argument>
                                                                                <expr>
                                                                                    <name>fErrorHandler</name>
                                                                                </expr>
                                                                            </argument>
                                                                            ,
                                                                            <argument>
                                                                                <expr>
                                                                                    <name>fError</name>
                                                                                </expr>
                                                                            </argument>
                                                                            ,
                                                                            <argument>
                                                                                <expr>
                                                                                    <name>fLocator</name>
                                                                                </expr>
                                                                            </argument>
                                                                            ,
                                                                            <argument>
                                                                                <expr>
                                                                                    <name>msg</name>
                                                                                </expr>
                                                                            </argument>
                                                                            ,
                                                                            <argument>
                                                                                <expr>
                                                                                    <name><name>DOMError</name>.
                                                                                        <name>SEVERITY_FATAL_ERROR
                                                                                        </name>
                                                                                    </name>
                                                                                </expr>
                                                                            </argument>
                                                                            ,
                                                                            <argument>
                                                                                <expr>
                                                                                    "wf-invalid-character-in-node-name"
                                                                                </expr>
                                                                            </argument>
                                                                            )
                                                                        </argument_list>
                                                                    </call>
                                                                </expr>
                                                                ;
                                                            </expr_stmt>
                                                            }
                                                        </block>
                                                    </then>
                                                </if>
                                                }
                                            </block>
                                        </then>
                                    </if>
                                    <expr_stmt>
                                        <expr>
                                            <call>
                                                <name><name>DOMNormalizer</name>.
                                                    <name>isXMLCharWF</name>
                                                </name>
                                                <argument_list>(
                                                    <argument>
                                                        <expr>
                                                            <name>fErrorHandler</name>
                                                        </expr>
                                                    </argument>
                                                    ,
                                                    <argument>
                                                        <expr>
                                                            <name>fError</name>
                                                        </expr>
                                                    </argument>
                                                    ,
                                                    <argument>
                                                        <expr>
                                                            <name>fLocator</name>
                                                        </expr>
                                                    </argument>
                                                    ,
                                                    <argument>
                                                        <expr>
                                                            <call>
                                                                <name><name>pinode</name>.
                                                                    <name>getData</name>
                                                                </name>
                                                                <argument_list>()</argument_list>
                                                            </call>
                                                        </expr>
                                                    </argument>
                                                    ,
                                                    <argument>
                                                        <expr>
                                                            <name>xml11Version</name>
                                                        </expr>
                                                    </argument>
                                                    )
                                                </argument_list>
                                            </call>
                                        </expr>
                                        ;
                                    </expr_stmt>
                                    <break>break;</break>
                                    }
                                </block>
                            </case>
                            }
                        </block>
                    </switch>

                    }
                </block>
            </function>

            <function>
                <type>
                    <specifier>private</specifier>
                    <name>String</name>
                </type>
                <name>getPathWithoutEscapes</name>
                <parameter_list>(
                    <param>
                        <decl>
                            <type>
                                <name>String</name>
                            </type>
                            <name>origPath</name>
                        </decl>
                    </param>
                    )
                </parameter_list>
                <block>{
                    <if>if
                        <condition>(
                            <expr>
                                <name>origPath</name>
                                != <name>null</name> &amp;&amp;
                                <call>
                                    <name><name>origPath</name>.
                                        <name>length</name>
                                    </name>
                                    <argument_list>()</argument_list>
                                </call>
                                != 0 &amp;&amp;
                                <call>
                                    <name><name>origPath</name>.
                                        <name>indexOf</name>
                                    </name>
                                    <argument_list>(
                                        <argument>
                                            <expr>'%'</expr>
                                        </argument>
                                        )
                                    </argument_list>
                                </call>
                                != -1
                            </expr>
                            )
                        </condition>
                        <then>
                            <block>{
                                <comment type="line">// Locate the escape characters</comment>
                                <decl_stmt>
                                    <decl>
                                        <type>
                                            <name>StringTokenizer</name>
                                        </type>
                                        <name>tokenizer</name> =
                                        <init>
                                            <expr>new
                                                <call>
                                                    <name>StringTokenizer</name>
                                                    <argument_list>(
                                                        <argument>
                                                            <expr>
                                                                <name>origPath</name>
                                                            </expr>
                                                        </argument>
                                                        ,
                                                        <argument>
                                                            <expr>"%"</expr>
                                                        </argument>
                                                        )
                                                    </argument_list>
                                                </call>
                                            </expr>
                                        </init>
                                    </decl>
                                    ;
                                </decl_stmt>
                                <decl_stmt>
                                    <decl>
                                        <type>
                                            <name>StringBuffer</name>
                                        </type>
                                        <name>result</name> =
                                        <init>
                                            <expr>new
                                                <call>
                                                    <name>StringBuffer</name>
                                                    <argument_list>(
                                                        <argument>
                                                            <expr>
                                                                <call>
                                                                    <name><name>origPath</name>.
                                                                        <name>length</name>
                                                                    </name>
                                                                    <argument_list>()</argument_list>
                                                                </call>
                                                            </expr>
                                                        </argument>
                                                        )
                                                    </argument_list>
                                                </call>
                                            </expr>
                                        </init>
                                    </decl>
                                    ;
                                </decl_stmt>
                                <decl_stmt>
                                    <decl>
                                        <type>
                                            <name>int</name>
                                        </type>
                                        <name>size</name> =
                                        <init>
                                            <expr>
                                                <call>
                                                    <name><name>tokenizer</name>.
                                                        <name>countTokens</name>
                                                    </name>
                                                    <argument_list>()</argument_list>
                                                </call>
                                            </expr>
                                        </init>
                                    </decl>
                                    ;
                                </decl_stmt>
                                <expr_stmt>
                                    <expr>
                                        <call>
                                            <name><name>result</name>.
                                                <name>append</name>
                                            </name>
                                            <argument_list>(
                                                <argument>
                                                    <expr>
                                                        <call>
                                                            <name><name>tokenizer</name>.
                                                                <name>nextToken</name>
                                                            </name>
                                                            <argument_list>()</argument_list>
                                                        </call>
                                                    </expr>
                                                </argument>
                                                )
                                            </argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </expr_stmt>
                                <for>for(
                                    <init>
                                        <decl>
                                            <type>
                                                <name>int</name>
                                            </type>
                                            <name>i</name> =
                                            <init>
                                                <expr>1</expr>
                                            </init>
                                        </decl>
                                        ;
                                    </init>
                                    <condition>
                                        <expr>
                                            <name>i</name>
                                            &lt;
                                            <name>size</name>
                                        </expr>
                                        ;
                                    </condition>
                                    <incr>
                                        <expr>++
                                            <name>i</name>
                                        </expr>
                                    </incr>
                                    )
                                    <block>{
                                        <decl_stmt>
                                            <decl>
                                                <type>
                                                    <name>String</name>
                                                </type>
                                                <name>token</name> =
                                                <init>
                                                    <expr>
                                                        <call>
                                                            <name><name>tokenizer</name>.
                                                                <name>nextToken</name>
                                                            </name>
                                                            <argument_list>()</argument_list>
                                                        </call>
                                                    </expr>
                                                </init>
                                            </decl>
                                            ;
                                        </decl_stmt>
                                        <comment type="line">// Decode the 2 digit hexadecimal number following % in
                                            '%nn'
                                        </comment>
                                        <expr_stmt>
                                            <expr>
                                                <call>
                                                    <name><name>result</name>.
                                                        <name>append</name>
                                                    </name>
                                                    <argument_list>(
                                                        <argument>
                                                            <expr>(<name>char</name>)
                                                                <call>
                                                                    <name><name>Integer</name>.
                                                                        <name>valueOf</name>
                                                                    </name>
                                                                    <argument_list>(
                                                                        <argument>
                                                                            <expr>
                                                                                <call>
                                                                                    <name><name>token</name>.
                                                                                        <name>substring</name>
                                                                                    </name>
                                                                                    <argument_list>(
                                                                                        <argument>
                                                                                            <expr>0</expr>
                                                                                        </argument>
                                                                                        ,
                                                                                        <argument>
                                                                                            <expr>2</expr>
                                                                                        </argument>
                                                                                        )
                                                                                    </argument_list>
                                                                                </call>
                                                                            </expr>
                                                                        </argument>
                                                                        ,
                                                                        <argument>
                                                                            <expr>16</expr>
                                                                        </argument>
                                                                        )
                                                                    </argument_list>
                                                                </call>
                                                                .
                                                                <call>
                                                                    <name>intValue</name>
                                                                    <argument_list>()</argument_list>
                                                                </call>
                                                            </expr>
                                                        </argument>
                                                        )
                                                    </argument_list>
                                                </call>
                                            </expr>
                                            ;
                                        </expr_stmt>
                                        <expr_stmt>
                                            <expr>
                                                <call>
                                                    <name><name>result</name>.
                                                        <name>append</name>
                                                    </name>
                                                    <argument_list>(
                                                        <argument>
                                                            <expr>
                                                                <call>
                                                                    <name><name>token</name>.
                                                                        <name>substring</name>
                                                                    </name>
                                                                    <argument_list>(
                                                                        <argument>
                                                                            <expr>2</expr>
                                                                        </argument>
                                                                        )
                                                                    </argument_list>
                                                                </call>
                                                            </expr>
                                                        </argument>
                                                        )
                                                    </argument_list>
                                                </call>
                                            </expr>
                                            ;
                                        </expr_stmt>
                                        }
                                    </block>
                                </for>
                                <return>return
                                    <expr>
                                        <call>
                                            <name><name>result</name>.
                                                <name>toString</name>
                                            </name>
                                            <argument_list>()</argument_list>
                                        </call>
                                    </expr>
                                    ;
                                </return>
                                }
                            </block>
                        </then>
                    </if>
                    <return>return
                        <expr>
                            <name>origPath</name>
                        </expr>
                        ;
                    </return>
                    }
                </block>
            </function>

            }
        </block>
    </class>
    <comment type="line">//DOMSerializerImpl</comment>


</unit>
